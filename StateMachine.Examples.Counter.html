<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>StateMachine.Examples.Counter</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-utxo/tree/master/StateMachine/Examples/Counter.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="StateMachine.Examples.Counter.html" class="Module">StateMachine.Examples.Counter</a> <a id="38" class="Keyword">where</a>

<a id="45" class="Keyword">open</a> <a id="50" class="Keyword">import</a> <a id="57" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="70" class="Keyword">using</a> <a id="76" class="Symbol">(</a><a id="77" href="Data.Integer.Base.html#2198" class="Datatype Operator">_&lt;_</a><a id="80" class="Symbol">;</a><a id="81" href="Data.Integer.Base.html#2358" class="Function Operator">_≥_</a><a id="84" class="Symbol">;</a><a id="85" href="Data.Integer.Base.html#2033" class="Datatype Operator">_≤_</a><a id="88" class="Symbol">;</a><a id="89" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a><a id="90" class="Symbol">;</a><a id="91" href="Agda.Builtin.Int.html#246" class="InductiveConstructor">+_</a><a id="93" class="Symbol">;</a><a id="94" href="Data.Integer.Base.html#2148" class="InductiveConstructor">+≤+</a><a id="97" class="Symbol">)</a>
<a id="99" class="Keyword">open</a> <a id="104" class="Keyword">import</a> <a id="111" href="Data.Integer.Properties.html" class="Module">Data.Integer.Properties</a> <a id="135" class="Keyword">using</a> <a id="141" class="Symbol">()</a>
<a id="144" class="Keyword">open</a> <a id="149" class="Keyword">import</a> <a id="156" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>
<a id="176" class="Keyword">open</a> <a id="181" class="Keyword">import</a> <a id="188" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="197" class="Keyword">using</a> <a id="203" class="Symbol">(</a><a id="204" href="Data.Nat.Base.html#1567" class="InductiveConstructor">z≤n</a><a id="207" class="Symbol">;</a><a id="208" href="Data.Nat.Base.html#1609" class="InductiveConstructor">s≤s</a><a id="211" class="Symbol">;</a><a id="212" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a><a id="215" class="Symbol">)</a>
<a id="217" class="Keyword">open</a> <a id="222" class="Keyword">import</a> <a id="229" href="Data.Maybe.html" class="Module">Data.Maybe</a>
<a id="240" class="Keyword">open</a> <a id="245" class="Keyword">import</a> <a id="252" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="290" class="Keyword">renaming</a> <a id="299" class="Symbol">(</a><a id="300" href="Relation.Binary.PropositionalEquality.html#2365" class="InductiveConstructor Operator">[_]</a> <a id="304" class="Symbol">to</a> <a id="307" class="InductiveConstructor Operator">remember</a><a id="315" class="Symbol">)</a>
<a id="317" class="Keyword">open</a> <a id="322" class="Keyword">import</a> <a id="329" href="Data.List.html" class="Module">Data.List</a>
<a id="339" class="Keyword">open</a> <a id="344" class="Keyword">import</a> <a id="351" href="Data.Product.html" class="Module">Data.Product</a>
<a id="364" class="Keyword">open</a> <a id="369" class="Keyword">import</a> <a id="376" href="Function.html" class="Module">Function</a>
<a id="385" class="Keyword">open</a> <a id="390" class="Keyword">import</a> <a id="397" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="407" class="Keyword">using</a> <a id="413" class="Symbol">(</a><a id="414" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a><a id="418" class="Symbol">;</a><a id="419" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a><a id="424" class="Symbol">;</a><a id="425" href="Data.Bool.Base.html#1460" class="Function">T</a><a id="426" class="Symbol">)</a>
<a id="428" class="Keyword">open</a> <a id="433" class="Keyword">import</a> <a id="440" href="Data.Bool.Properties.html" class="Module">Data.Bool.Properties</a> <a id="461" class="Keyword">using</a> <a id="467" class="Symbol">()</a> <a id="470" class="Keyword">renaming</a> <a id="479" class="Symbol">(</a><a id="480" href="Data.Bool.Properties.html#1135" class="Function Operator">_≟_</a> <a id="484" class="Symbol">to</a> <a id="487" class="Function Operator">_≟B_</a><a id="491" class="Symbol">)</a>
<a id="493" class="Keyword">open</a> <a id="498" class="Keyword">import</a> <a id="505" href="Data.Sum.html" class="Module">Data.Sum</a>

<a id="515" class="Keyword">open</a> <a id="520" class="Keyword">import</a> <a id="527" href="Prelude.Default.html" class="Module">Prelude.Default</a>
<a id="543" class="Keyword">open</a> <a id="548" class="Keyword">import</a> <a id="555" href="UTxO.Value.html" class="Module">UTxO.Value</a>
<a id="566" class="Keyword">open</a> <a id="571" class="Keyword">import</a> <a id="578" href="UTxO.Types.html" class="Module">UTxO.Types</a>
<a id="589" class="Keyword">open</a> <a id="594" class="Keyword">import</a> <a id="601" href="UTxO.TxUtilities.html" class="Module">UTxO.TxUtilities</a>
<a id="618" class="Keyword">open</a> <a id="623" class="Keyword">import</a> <a id="630" href="UTxO.Validity.html" class="Module">UTxO.Validity</a>
<a id="644" class="Keyword">open</a> <a id="649" class="Keyword">import</a> <a id="656" href="StateMachine.Base.html" class="Module">StateMachine.Base</a>

<a id="675" class="Keyword">data</a> <a id="State"></a><a id="680" href="StateMachine.Examples.Counter.html#680" class="Datatype">State</a> <a id="686" class="Symbol">:</a> <a id="688" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="692" class="Keyword">where</a>
  <a id="State.counter"></a><a id="700" href="StateMachine.Examples.Counter.html#700" class="InductiveConstructor">counter</a> <a id="708" class="Symbol">:</a> <a id="710" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a> <a id="712" class="Symbol">→</a> <a id="714" href="StateMachine.Examples.Counter.html#680" class="Datatype">State</a>

<a id="721" class="Keyword">data</a> <a id="Input"></a><a id="726" href="StateMachine.Examples.Counter.html#726" class="Datatype">Input</a> <a id="732" class="Symbol">:</a> <a id="734" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="738" class="Keyword">where</a>
  <a id="Input.inc"></a><a id="746" href="StateMachine.Examples.Counter.html#746" class="InductiveConstructor">inc</a> <a id="750" class="Symbol">:</a> <a id="752" href="StateMachine.Examples.Counter.html#726" class="Datatype">Input</a>

<a id="759" class="Keyword">instance</a>
  <a id="IsData-CS"></a><a id="770" href="StateMachine.Examples.Counter.html#770" class="Function">IsData-CS</a> <a id="780" class="Symbol">:</a> <a id="782" href="UTxO.Types.html#1155" class="Record">IsData</a> <a id="789" href="StateMachine.Examples.Counter.html#680" class="Datatype">State</a>
  <a id="797" href="UTxO.Types.html#1196" class="Field">toData</a>   <a id="806" class="Symbol">⦃</a> <a id="808" href="StateMachine.Examples.Counter.html#770" class="Function">IsData-CS</a> <a id="818" class="Symbol">⦄</a> <a id="820" class="Symbol">(</a><a id="821" href="StateMachine.Examples.Counter.html#700" class="InductiveConstructor">counter</a> <a id="829" href="StateMachine.Examples.Counter.html#829" class="Bound">i</a><a id="830" class="Symbol">)</a> <a id="832" class="Symbol">=</a> <a id="834" href="UTxO.Types.html#925" class="InductiveConstructor">I</a> <a id="836" href="StateMachine.Examples.Counter.html#829" class="Bound">i</a>
  <a id="840" href="UTxO.Types.html#1220" class="Field">fromData</a> <a id="849" class="Symbol">⦃</a> <a id="851" href="StateMachine.Examples.Counter.html#770" class="Function">IsData-CS</a> <a id="861" class="Symbol">⦄</a> <a id="863" class="Symbol">(</a><a id="864" href="UTxO.Types.html#925" class="InductiveConstructor">I</a> <a id="866" href="StateMachine.Examples.Counter.html#866" class="Bound">i</a><a id="867" class="Symbol">)</a> <a id="869" class="Symbol">=</a> <a id="871" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="876" class="Symbol">(</a><a id="877" href="StateMachine.Examples.Counter.html#700" class="InductiveConstructor">counter</a> <a id="885" href="StateMachine.Examples.Counter.html#866" class="Bound">i</a><a id="886" class="Symbol">)</a>
  <a id="890" href="UTxO.Types.html#1220" class="CatchallClause Field">fromData</a><a id="898" class="CatchallClause"> </a><a id="899" class="CatchallClause Symbol">⦃</a><a id="900" class="CatchallClause"> </a><a id="901" href="StateMachine.Examples.Counter.html#770" class="CatchallClause Function">IsData-CS</a><a id="910" class="CatchallClause"> </a><a id="911" class="CatchallClause Symbol">⦄</a><a id="912" class="CatchallClause"> </a><a id="913" class="CatchallClause Symbol">_</a>     <a id="919" class="Symbol">=</a> <a id="921" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>
  <a id="931" href="UTxO.Types.html#1250" class="Field">from∘to</a>  <a id="940" class="Symbol">⦃</a> <a id="942" href="StateMachine.Examples.Counter.html#770" class="Function">IsData-CS</a> <a id="952" class="Symbol">⦄</a> <a id="954" class="Symbol">(</a><a id="955" href="StateMachine.Examples.Counter.html#700" class="InductiveConstructor">counter</a> <a id="963" href="StateMachine.Examples.Counter.html#963" class="Bound">i</a><a id="964" class="Symbol">)</a> <a id="966" class="Symbol">=</a> <a id="968" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
  <a id="975" href="UTxO.Types.html#1300" class="Field">from-inj</a> <a id="984" class="Symbol">⦃</a> <a id="986" href="StateMachine.Examples.Counter.html#770" class="Function">IsData-CS</a> <a id="996" class="Symbol">⦄</a> <a id="998" class="Symbol">(</a><a id="999" href="UTxO.Types.html#925" class="InductiveConstructor">I</a> <a id="1001" href="StateMachine.Examples.Counter.html#1001" class="Bound">i</a><a id="1002" class="Symbol">)</a> <a id="1004" class="Symbol">(</a><a id="1005" href="StateMachine.Examples.Counter.html#700" class="InductiveConstructor">counter</a> <a id="1013" class="DottedPattern Symbol">.</a><a id="1014" href="StateMachine.Examples.Counter.html#1001" class="DottedPattern Bound">i</a><a id="1015" class="Symbol">)</a> <a id="1017" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="1022" class="Symbol">=</a> <a id="1024" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

  <a id="IsData-CI"></a><a id="1032" href="StateMachine.Examples.Counter.html#1032" class="Function">IsData-CI</a> <a id="1042" class="Symbol">:</a> <a id="1044" href="UTxO.Types.html#1155" class="Record">IsData</a> <a id="1051" href="StateMachine.Examples.Counter.html#726" class="Datatype">Input</a>
  <a id="1059" href="UTxO.Types.html#1196" class="Field">toData</a>   <a id="1068" class="Symbol">⦃</a> <a id="1070" href="StateMachine.Examples.Counter.html#1032" class="Function">IsData-CI</a> <a id="1080" class="Symbol">⦄</a> <a id="1082" href="StateMachine.Examples.Counter.html#746" class="InductiveConstructor">inc</a> <a id="1086" class="Symbol">=</a> <a id="1088" href="UTxO.Types.html#968" class="InductiveConstructor">LIST</a> <a id="1093" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>
  <a id="1098" href="UTxO.Types.html#1220" class="Field">fromData</a> <a id="1107" class="Symbol">⦃</a> <a id="1109" href="StateMachine.Examples.Counter.html#1032" class="Function">IsData-CI</a> <a id="1119" class="Symbol">⦄</a> <a id="1121" class="Symbol">(</a><a id="1122" href="UTxO.Types.html#968" class="InductiveConstructor">LIST</a> <a id="1127" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="1129" class="Symbol">)</a> <a id="1131" class="Symbol">=</a> <a id="1133" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="1138" href="StateMachine.Examples.Counter.html#746" class="InductiveConstructor">inc</a>
  <a id="1144" href="UTxO.Types.html#1220" class="CatchallClause Field">fromData</a><a id="1152" class="CatchallClause"> </a><a id="1153" class="CatchallClause Symbol">⦃</a><a id="1154" class="CatchallClause"> </a><a id="1155" href="StateMachine.Examples.Counter.html#1032" class="CatchallClause Function">IsData-CI</a><a id="1164" class="CatchallClause"> </a><a id="1165" class="CatchallClause Symbol">⦄</a><a id="1166" class="CatchallClause"> </a><a id="1167" class="CatchallClause Symbol">_</a>         <a id="1177" class="Symbol">=</a> <a id="1179" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>
  <a id="1189" href="UTxO.Types.html#1250" class="Field">from∘to</a>  <a id="1198" class="Symbol">⦃</a> <a id="1200" href="StateMachine.Examples.Counter.html#1032" class="Function">IsData-CI</a> <a id="1210" class="Symbol">⦄</a> <a id="1212" href="StateMachine.Examples.Counter.html#746" class="InductiveConstructor">inc</a> <a id="1216" class="Symbol">=</a> <a id="1218" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
  <a id="1225" href="UTxO.Types.html#1300" class="Field">from-inj</a> <a id="1234" class="Symbol">⦃</a> <a id="1236" href="StateMachine.Examples.Counter.html#1032" class="Function">IsData-CI</a> <a id="1246" class="Symbol">⦄</a> <a id="1248" class="Symbol">(</a><a id="1249" href="UTxO.Types.html#968" class="InductiveConstructor">LIST</a> <a id="1254" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="1256" class="Symbol">)</a> <a id="1258" href="StateMachine.Examples.Counter.html#746" class="InductiveConstructor">inc</a> <a id="1262" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="1267" class="Symbol">=</a> <a id="1269" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="CounterSM"></a><a id="1275" href="StateMachine.Examples.Counter.html#1275" class="Function">CounterSM</a> <a id="1285" class="Symbol">:</a> <a id="1287" href="StateMachine.Base.html#1973" class="Record">StateMachine</a> <a id="1300" href="StateMachine.Examples.Counter.html#680" class="Datatype">State</a> <a id="1306" href="StateMachine.Examples.Counter.html#726" class="Datatype">Input</a>
<a id="1312" href="StateMachine.Base.html#2080" class="Field">isInitial</a> <a id="1322" href="StateMachine.Examples.Counter.html#1275" class="Function">CounterSM</a> <a id="1332" class="Symbol">(</a><a id="1333" href="StateMachine.Examples.Counter.html#700" class="InductiveConstructor">counter</a> <a id="1341" class="Symbol">(</a><a id="1342" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="1344" class="Number">0</a><a id="1345" class="Symbol">)</a> <a id="1347" class="Symbol">)</a> <a id="1349" class="Symbol">=</a> <a id="1351" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a>
<a id="1356" href="StateMachine.Base.html#2080" class="CatchallClause Field">isInitial</a><a id="1365" class="CatchallClause"> </a><a id="1366" href="StateMachine.Examples.Counter.html#1275" class="CatchallClause Function">CounterSM</a><a id="1375" class="CatchallClause"> </a><a id="1376" class="CatchallClause Symbol">(</a><a id="1377" href="StateMachine.Examples.Counter.html#700" class="CatchallClause InductiveConstructor">counter</a><a id="1384" class="CatchallClause"> </a><a id="1385" class="CatchallClause Symbol">_</a><a id="1386" class="CatchallClause">     </a><a id="1391" class="CatchallClause Symbol">)</a> <a id="1393" class="Symbol">=</a> <a id="1395" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a>
<a id="1401" class="Comment">-- isFinal   CounterSM (counter (+ 10)) = false</a>
<a id="1449" class="Comment">-- isFinal   CounterSM _ = false</a>
<a id="1482" href="StateMachine.Base.html#2105" class="Field">step</a>      <a id="1492" href="StateMachine.Examples.Counter.html#1275" class="Function">CounterSM</a> <a id="1502" class="Symbol">(</a><a id="1503" href="StateMachine.Examples.Counter.html#700" class="InductiveConstructor">counter</a> <a id="1511" href="StateMachine.Examples.Counter.html#1511" class="Bound">i</a><a id="1512" class="Symbol">)</a> <a id="1514" href="StateMachine.Examples.Counter.html#746" class="InductiveConstructor">inc</a> <a id="1518" class="Symbol">=</a>
  <a id="1522" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="1527" class="Symbol">(</a><a id="1528" href="StateMachine.Examples.Counter.html#700" class="InductiveConstructor">counter</a> <a id="1536" class="Symbol">(</a><a id="1537" href="Data.Integer.Base.html#5082" class="Function">Data.Integer.suc</a> <a id="1554" href="StateMachine.Examples.Counter.html#1511" class="Bound">i</a><a id="1555" class="Symbol">)</a> <a id="1557" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1559" href="Prelude.Default.html#356" class="Field">def</a> <a id="1563" href="StateMachine.Base.html#1331" class="Function">Default-TxConstraints</a><a id="1584" class="Symbol">)</a>
<a id="1586" href="StateMachine.Base.html#2155" class="Field">origin</a>    <a id="1596" href="StateMachine.Examples.Counter.html#1275" class="Function">CounterSM</a> <a id="1606" class="Symbol">=</a> <a id="1608" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>

<a id="1617" class="Keyword">open</a> <a id="1622" class="Keyword">import</a> <a id="1629" href="StateMachine.Properties.html" class="Module">StateMachine.Properties</a> <a id="1653" class="Symbol">{</a><a id="1654" class="Argument">sm</a> <a id="1657" class="Symbol">=</a> <a id="1659" href="StateMachine.Examples.Counter.html#1275" class="Function">CounterSM</a><a id="1668" class="Symbol">}</a>
<a id="1670" class="Keyword">open</a> <a id="1675" class="Keyword">import</a> <a id="1682" href="StateMachine.Inductive.html" class="Module">StateMachine.Inductive</a> <a id="1705" class="Symbol">{</a><a id="1706" class="Argument">sm</a> <a id="1709" class="Symbol">=</a> <a id="1711" href="StateMachine.Examples.Counter.html#1275" class="Function">CounterSM</a><a id="1720" class="Symbol">}</a>
<a id="1722" class="Keyword">open</a> <a id="1727" class="Keyword">import</a> <a id="1734" href="Bisimulation.Base.html" class="Module">Bisimulation.Base</a> <a id="1752" class="Symbol">{</a><a id="1753" class="Argument">sm</a> <a id="1756" class="Symbol">=</a> <a id="1758" href="StateMachine.Examples.Counter.html#1275" class="Function">CounterSM</a><a id="1767" class="Symbol">}</a>

<a id="1770" class="Comment">-- An invariant/safety property: all reachable states are non-negative</a>
<a id="1841" class="Comment">-- ============================</a>

<a id="Valid"></a><a id="1874" href="StateMachine.Examples.Counter.html#1874" class="Function">Valid</a> <a id="1880" class="Symbol">:</a> <a id="1882" href="StateMachine.Examples.Counter.html#680" class="Datatype">State</a> <a id="1888" class="Symbol">→</a> <a id="1890" href="Agda.Primitive.html#320" class="Primitive">Set</a>
<a id="1894" href="StateMachine.Examples.Counter.html#1874" class="Function">Valid</a> <a id="1900" href="StateMachine.Examples.Counter.html#1900" class="Bound">s</a><a id="1901" class="Symbol">@(</a><a id="1903" href="StateMachine.Examples.Counter.html#700" class="InductiveConstructor">counter</a> <a id="1911" href="StateMachine.Examples.Counter.html#1911" class="Bound">i</a><a id="1912" class="Symbol">)</a>     <a id="1918" class="Symbol">=</a>
  <a id="1922" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="1924" class="Symbol">(</a><a id="1925" href="StateMachine.Base.html#2080" class="Field">isInitial</a> <a id="1935" href="StateMachine.Examples.Counter.html#1275" class="Function">CounterSM</a> <a id="1945" href="StateMachine.Examples.Counter.html#1900" class="Bound">s</a><a id="1946" class="Symbol">)</a> <a id="1948" href="Data.Sum.Base.html#743" class="Datatype Operator">⊎</a> <a id="1950" href="StateMachine.Examples.Counter.html#1911" class="Bound">i</a> <a id="1952" href="Data.Integer.Base.html#2358" class="Function Operator">≥</a> <a id="1954" class="Symbol">(</a><a id="1955" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="1957" class="Number">0</a><a id="1958" class="Symbol">)</a> <a id="1960" class="Comment">-- ⊎ T (isFinal CounterSM s)</a>


<a id="1991" class="Comment">-- step preserves validity</a>
<a id="lemma-step"></a><a id="2018" href="StateMachine.Examples.Counter.html#2018" class="Function">lemma-step</a> <a id="2029" class="Symbol">:</a> <a id="2031" class="Symbol">∀{</a><a id="2033" href="StateMachine.Examples.Counter.html#2033" class="Bound">s</a> <a id="2035" href="StateMachine.Examples.Counter.html#2035" class="Bound">s&#39;</a> <a id="2038" class="Symbol">:</a> <a id="2040" href="StateMachine.Examples.Counter.html#680" class="Datatype">State</a><a id="2045" class="Symbol">}</a> <a id="2047" class="Symbol">→</a> <a id="2049" href="StateMachine.Examples.Counter.html#2033" class="Bound">s</a> <a id="2051" href="StateMachine.Inductive.Core.html#490" class="Function Operator">↝</a> <a id="2053" href="StateMachine.Examples.Counter.html#2035" class="Bound">s&#39;</a> <a id="2056" class="Symbol">→</a> <a id="2058" href="StateMachine.Examples.Counter.html#1874" class="Function">Valid</a> <a id="2064" href="StateMachine.Examples.Counter.html#2033" class="Bound">s</a> <a id="2066" class="Symbol">→</a> <a id="2068" href="StateMachine.Examples.Counter.html#1874" class="Function">Valid</a> <a id="2074" href="StateMachine.Examples.Counter.html#2035" class="Bound">s&#39;</a>
<a id="2077" href="StateMachine.Examples.Counter.html#2018" class="Function">lemma-step</a> <a id="2088" class="Symbol">{</a><a id="2089" href="StateMachine.Examples.Counter.html#700" class="InductiveConstructor">counter</a> <a id="2097" class="Symbol">(</a><a id="2098" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="2100" class="Number">0</a><a id="2101" class="Symbol">)}</a>       <a id="2110" class="Symbol">(</a><a id="2111" href="StateMachine.Examples.Counter.html#746" class="InductiveConstructor">inc</a> <a id="2115" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2117" class="Symbol">_</a> <a id="2119" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2121" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="2125" class="Symbol">)</a> <a id="2127" class="Symbol">(</a><a id="2128" href="Data.Sum.Base.html#793" class="InductiveConstructor">inj₁</a> <a id="2133" href="StateMachine.Examples.Counter.html#2133" class="Bound">p</a><a id="2134" class="Symbol">)</a> <a id="2136" class="Symbol">=</a> <a id="2138" href="Data.Sum.Base.html#818" class="InductiveConstructor">inj₂</a> <a id="2143" class="Symbol">(</a><a id="2144" href="Data.Integer.Base.html#2148" class="InductiveConstructor">+≤+</a> <a id="2148" href="Data.Nat.Base.html#1567" class="InductiveConstructor">z≤n</a><a id="2151" class="Symbol">)</a>
<a id="2153" href="StateMachine.Examples.Counter.html#2018" class="Function">lemma-step</a> <a id="2164" class="Symbol">{</a><a id="2165" href="StateMachine.Examples.Counter.html#700" class="InductiveConstructor">counter</a> <a id="2173" class="Symbol">(</a><a id="2174" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="2176" class="Symbol">(</a><a id="2177" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="2181" href="StateMachine.Examples.Counter.html#2181" class="Bound">n</a><a id="2182" class="Symbol">))}</a> <a id="2186" class="Symbol">(</a><a id="2187" href="StateMachine.Examples.Counter.html#746" class="InductiveConstructor">inc</a> <a id="2191" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2193" class="Symbol">_</a> <a id="2195" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2197" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="2201" class="Symbol">)</a> <a id="2203" class="Symbol">(</a><a id="2204" href="Data.Sum.Base.html#793" class="InductiveConstructor">inj₁</a> <a id="2209" class="Symbol">())</a>
<a id="2213" href="StateMachine.Examples.Counter.html#2018" class="Function">lemma-step</a> <a id="2224" class="Symbol">{</a><a id="2225" href="StateMachine.Examples.Counter.html#700" class="InductiveConstructor">counter</a> <a id="2233" class="Symbol">(</a><a id="2234" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+_</a> <a id="2237" href="StateMachine.Examples.Counter.html#2237" class="Bound">n</a><a id="2238" class="Symbol">)}</a>      <a id="2246" class="Symbol">(</a><a id="2247" href="StateMachine.Examples.Counter.html#746" class="InductiveConstructor">inc</a> <a id="2251" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2253" class="Symbol">_</a> <a id="2255" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2257" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="2261" class="Symbol">)</a> <a id="2263" class="Symbol">(</a><a id="2264" href="Data.Sum.Base.html#818" class="InductiveConstructor">inj₂</a> <a id="2269" href="StateMachine.Examples.Counter.html#2269" class="Bound">p</a><a id="2270" class="Symbol">)</a> <a id="2272" class="Symbol">=</a> <a id="2274" href="Data.Sum.Base.html#818" class="InductiveConstructor">inj₂</a> <a id="2279" class="Symbol">(</a><a id="2280" href="Data.Integer.Base.html#2148" class="InductiveConstructor">+≤+</a> <a id="2284" href="Data.Nat.Base.html#1567" class="InductiveConstructor">z≤n</a><a id="2287" class="Symbol">)</a>

<a id="2290" class="Comment">-- for a slightly different representation of step</a>
<a id="lemma-step&#39;"></a><a id="2341" href="StateMachine.Examples.Counter.html#2341" class="Function">lemma-step&#39;</a> <a id="2353" class="Symbol">:</a> <a id="2355" class="Symbol">∀{</a><a id="2357" href="StateMachine.Examples.Counter.html#2357" class="Bound">s</a> <a id="2359" href="StateMachine.Examples.Counter.html#2359" class="Bound">s&#39;</a><a id="2361" class="Symbol">}</a> <a id="2363" class="Symbol">→</a> <a id="2365" href="StateMachine.Examples.Counter.html#2357" class="Bound">s</a> <a id="2367" href="StateMachine.Inductive.Core.html#490" class="Function Operator">↝</a> <a id="2369" href="StateMachine.Examples.Counter.html#2359" class="Bound">s&#39;</a> <a id="2372" class="Symbol">→</a> <a id="2374" href="StateMachine.Examples.Counter.html#1874" class="Function">Valid</a> <a id="2380" href="StateMachine.Examples.Counter.html#2357" class="Bound">s</a> <a id="2382" class="Symbol">→</a> <a id="2384" href="StateMachine.Examples.Counter.html#1874" class="Function">Valid</a> <a id="2390" href="StateMachine.Examples.Counter.html#2359" class="Bound">s&#39;</a>
<a id="2393" href="StateMachine.Examples.Counter.html#2341" class="Function">lemma-step&#39;</a> <a id="2405" class="Symbol">{</a><a id="2406" href="StateMachine.Examples.Counter.html#700" class="InductiveConstructor">counter</a> <a id="2414" class="Symbol">(</a><a id="2415" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="2417" class="Number">0</a><a id="2418" class="Symbol">)}</a>       <a id="2427" class="Symbol">(</a><a id="2428" href="StateMachine.Examples.Counter.html#746" class="InductiveConstructor">inc</a> <a id="2432" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2434" class="Symbol">_</a> <a id="2436" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2438" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="2442" class="Symbol">)</a> <a id="2444" class="Symbol">(</a><a id="2445" href="Data.Sum.Base.html#793" class="InductiveConstructor">inj₁</a> <a id="2450" href="StateMachine.Examples.Counter.html#2450" class="Bound">p</a><a id="2451" class="Symbol">)</a> <a id="2453" class="Symbol">=</a> <a id="2455" href="Data.Sum.Base.html#818" class="InductiveConstructor">inj₂</a> <a id="2460" class="Symbol">(</a><a id="2461" href="Data.Integer.Base.html#2148" class="InductiveConstructor">+≤+</a> <a id="2465" href="Data.Nat.Base.html#1567" class="InductiveConstructor">z≤n</a><a id="2468" class="Symbol">)</a>
<a id="2470" href="StateMachine.Examples.Counter.html#2341" class="Function">lemma-step&#39;</a> <a id="2482" class="Symbol">{</a><a id="2483" href="StateMachine.Examples.Counter.html#700" class="InductiveConstructor">counter</a> <a id="2491" class="Symbol">(</a><a id="2492" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="2494" class="Symbol">(</a><a id="2495" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="2499" href="StateMachine.Examples.Counter.html#2499" class="Bound">n</a><a id="2500" class="Symbol">))}</a> <a id="2504" class="Symbol">(</a><a id="2505" href="StateMachine.Examples.Counter.html#746" class="InductiveConstructor">inc</a> <a id="2509" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2511" class="Symbol">_</a> <a id="2513" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2515" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="2519" class="Symbol">)</a> <a id="2521" class="Symbol">(</a><a id="2522" href="Data.Sum.Base.html#793" class="InductiveConstructor">inj₁</a> <a id="2527" class="Symbol">())</a>
<a id="2531" href="StateMachine.Examples.Counter.html#2341" class="Function">lemma-step&#39;</a> <a id="2543" class="Symbol">{</a><a id="2544" href="StateMachine.Examples.Counter.html#700" class="InductiveConstructor">counter</a> <a id="2552" class="Symbol">(</a><a id="2553" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+_</a> <a id="2556" href="StateMachine.Examples.Counter.html#2556" class="Bound">n</a><a id="2557" class="Symbol">)}</a>      <a id="2565" class="Symbol">(</a><a id="2566" href="StateMachine.Examples.Counter.html#746" class="InductiveConstructor">inc</a> <a id="2570" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2572" class="Symbol">_</a> <a id="2574" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2576" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="2580" class="Symbol">)</a> <a id="2582" class="Symbol">(</a><a id="2583" href="Data.Sum.Base.html#818" class="InductiveConstructor">inj₂</a> <a id="2588" href="StateMachine.Examples.Counter.html#2588" class="Bound">p</a><a id="2589" class="Symbol">)</a> <a id="2591" class="Symbol">=</a> <a id="2593" href="Data.Sum.Base.html#818" class="InductiveConstructor">inj₂</a> <a id="2598" class="Symbol">(</a><a id="2599" href="Data.Integer.Base.html#2148" class="InductiveConstructor">+≤+</a> <a id="2603" href="Data.Nat.Base.html#1567" class="InductiveConstructor">z≤n</a><a id="2606" class="Symbol">)</a>


<a id="2610" class="Comment">-- initial state is valid</a>
<a id="lemma-initial"></a><a id="2636" href="StateMachine.Examples.Counter.html#2636" class="Function">lemma-initial</a> <a id="2650" class="Symbol">:</a> <a id="2652" class="Symbol">∀{</a><a id="2654" href="StateMachine.Examples.Counter.html#2654" class="Bound">s</a><a id="2655" class="Symbol">}</a> <a id="2657" class="Symbol">→</a> <a id="2659" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="2661" class="Symbol">(</a><a id="2662" href="StateMachine.Base.html#2080" class="Field">isInitial</a> <a id="2672" href="StateMachine.Examples.Counter.html#1275" class="Function">CounterSM</a> <a id="2682" href="StateMachine.Examples.Counter.html#2654" class="Bound">s</a><a id="2683" class="Symbol">)</a> <a id="2685" class="Symbol">→</a> <a id="2687" href="StateMachine.Examples.Counter.html#1874" class="Function">Valid</a> <a id="2693" href="StateMachine.Examples.Counter.html#2654" class="Bound">s</a>
<a id="2695" href="StateMachine.Examples.Counter.html#2636" class="Function">lemma-initial</a> <a id="2709" class="Symbol">{</a><a id="2710" href="StateMachine.Examples.Counter.html#700" class="InductiveConstructor">counter</a> <a id="2718" class="Symbol">(</a><a id="2719" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="2721" class="Number">0</a><a id="2722" class="Symbol">)}</a> <a id="2725" class="Symbol">_</a> <a id="2727" class="Symbol">=</a> <a id="2729" href="Data.Sum.Base.html#793" class="InductiveConstructor">inj₁</a> <a id="2734" class="Symbol">_</a>

<a id="2737" class="Comment">-- Validity for all states in any rooted run</a>
<a id="all-valid"></a><a id="2782" href="StateMachine.Examples.Counter.html#2782" class="Function">all-valid</a> <a id="2792" class="Symbol">:</a> <a id="2794" class="Symbol">∀{</a><a id="2796" href="StateMachine.Examples.Counter.html#2796" class="Bound">s</a> <a id="2798" href="StateMachine.Examples.Counter.html#2798" class="Bound">s&#39;</a><a id="2800" class="Symbol">}(</a><a id="2802" href="StateMachine.Examples.Counter.html#2802" class="Bound">xs</a> <a id="2805" class="Symbol">:</a> <a id="2807" href="StateMachine.Examples.Counter.html#2796" class="Bound">s</a> <a id="2809" href="StateMachine.Inductive.Core.html#593" class="Datatype Operator">↝⋆</a> <a id="2812" href="StateMachine.Examples.Counter.html#2798" class="Bound">s&#39;</a><a id="2814" class="Symbol">)</a> <a id="2816" class="Symbol">→</a> <a id="2818" href="StateMachine.Inductive.Combinators.html#395" class="Datatype">AllS</a> <a id="2823" href="StateMachine.Examples.Counter.html#1874" class="Function">Valid</a> <a id="2829" href="StateMachine.Examples.Counter.html#2802" class="Bound">xs</a>
<a id="2832" href="StateMachine.Examples.Counter.html#2782" class="Function">all-valid</a> <a id="2842" href="StateMachine.Examples.Counter.html#2842" class="Bound">xs</a> <a id="2845" class="Symbol">=</a> <a id="2847" href="StateMachine.Inductive.Combinators.html#732" class="Function">all-lem</a> <a id="2855" href="StateMachine.Examples.Counter.html#1874" class="Function">Valid</a> <a id="2861" href="StateMachine.Examples.Counter.html#2636" class="Function">lemma-initial</a> <a id="2875" href="StateMachine.Examples.Counter.html#2018" class="Function">lemma-step</a> <a id="2886" href="StateMachine.Examples.Counter.html#2842" class="Bound">xs</a>

<a id="2890" class="Keyword">open</a> <a id="2895" href="StateMachine.Base.html#2219" class="Module">CEM</a> <a id="2899" class="Symbol">{</a><a id="2900" class="Argument">sm</a> <a id="2903" class="Symbol">=</a> <a id="2905" href="StateMachine.Examples.Counter.html#1275" class="Function">CounterSM</a><a id="2914" class="Symbol">}</a>
<a id="2916" class="Keyword">open</a> <a id="2921" class="Keyword">import</a> <a id="2928" href="StateMachine.Properties.Ledger.html" class="Module">StateMachine.Properties.Ledger</a> <a id="2959" class="Symbol">{</a><a id="2960" class="Argument">sm</a> <a id="2963" class="Symbol">=</a> <a id="2965" href="StateMachine.Examples.Counter.html#1275" class="Function">CounterSM</a><a id="2974" class="Symbol">}</a>

<a id="2977" class="Comment">-- Validity holds for all on chain traces</a>
<a id="all-valid-ledger"></a><a id="3019" href="StateMachine.Examples.Counter.html#3019" class="Function">all-valid-ledger</a> <a id="3036" class="Symbol">:</a> <a id="3038" class="Symbol">∀{</a><a id="3040" href="StateMachine.Examples.Counter.html#3040" class="Bound">l</a> <a id="3042" href="StateMachine.Examples.Counter.html#3042" class="Bound">l&#39;</a><a id="3044" class="Symbol">}{</a><a id="3046" href="StateMachine.Examples.Counter.html#3046" class="Bound">vl</a> <a id="3049" class="Symbol">:</a> <a id="3051" href="UTxO.Validity.html#2261" class="Datatype">ValidLedger</a> <a id="3063" href="StateMachine.Examples.Counter.html#3040" class="Bound">l</a><a id="3064" class="Symbol">}{</a><a id="3066" href="StateMachine.Examples.Counter.html#3066" class="Bound">vl&#39;</a> <a id="3070" class="Symbol">:</a> <a id="3072" href="UTxO.Validity.html#2261" class="Datatype">ValidLedger</a> <a id="3084" href="StateMachine.Examples.Counter.html#3042" class="Bound">l&#39;</a><a id="3086" class="Symbol">}{</a><a id="3088" href="StateMachine.Examples.Counter.html#3088" class="Bound">s</a> <a id="3090" href="StateMachine.Examples.Counter.html#3090" class="Bound">s&#39;</a><a id="3092" class="Symbol">}</a>
  <a id="3096" class="Symbol">→</a> <a id="3098" class="Symbol">(</a><a id="3099" href="StateMachine.Examples.Counter.html#3099" class="Bound">xs</a> <a id="3102" class="Symbol">:</a> <a id="3104" href="StateMachine.Properties.Ledger.html#1345" class="Datatype">X</a> <a id="3106" href="StateMachine.Examples.Counter.html#3046" class="Bound">vl</a> <a id="3109" href="StateMachine.Examples.Counter.html#3088" class="Bound">s</a> <a id="3111" href="StateMachine.Examples.Counter.html#3066" class="Bound">vl&#39;</a> <a id="3115" href="StateMachine.Examples.Counter.html#3090" class="Bound">s&#39;</a><a id="3117" class="Symbol">)</a> <a id="3119" class="Symbol">→</a> <a id="3121" href="StateMachine.Inductive.Combinators.html#395" class="Datatype">AllS</a> <a id="3126" href="StateMachine.Examples.Counter.html#1874" class="Function">Valid</a> <a id="3132" class="Symbol">(</a><a id="3133" href="StateMachine.Properties.Ledger.html#1816" class="Function">forget</a> <a id="3140" href="StateMachine.Examples.Counter.html#3099" class="Bound">xs</a><a id="3142" class="Symbol">)</a>
<a id="3144" href="StateMachine.Examples.Counter.html#3019" class="Function">all-valid-ledger</a> <a id="3161" href="StateMachine.Examples.Counter.html#3161" class="Bound">xs</a> <a id="3164" class="Symbol">=</a> <a id="3166" href="StateMachine.Examples.Counter.html#2782" class="Function">all-valid</a> <a id="3176" class="Symbol">(</a><a id="3177" href="StateMachine.Properties.Ledger.html#1816" class="Function">forget</a> <a id="3184" href="StateMachine.Examples.Counter.html#3161" class="Bound">xs</a><a id="3186" class="Symbol">)</a>

<a id="3189" class="Comment">-- Validity holds on chain in a different sense</a>
<a id="lemma"></a><a id="3237" href="StateMachine.Examples.Counter.html#3237" class="Function">lemma</a> <a id="3243" class="Symbol">:</a> <a id="3245" class="Symbol">∀{</a><a id="3247" href="StateMachine.Examples.Counter.html#3247" class="Bound">tx</a> <a id="3250" href="StateMachine.Examples.Counter.html#3250" class="Bound">l</a><a id="3251" class="Symbol">}</a>
  <a id="3255" class="Symbol">→</a> <a id="3257" class="Symbol">∀{</a><a id="3259" href="StateMachine.Examples.Counter.html#3259" class="Bound">vtx</a> <a id="3263" class="Symbol">:</a> <a id="3265" href="UTxO.Validity.html#1336" class="Record">IsValidTx</a> <a id="3275" href="StateMachine.Examples.Counter.html#3247" class="Bound">tx</a> <a id="3278" href="StateMachine.Examples.Counter.html#3250" class="Bound">l</a><a id="3279" class="Symbol">}{</a><a id="3281" href="StateMachine.Examples.Counter.html#3281" class="Bound">vl</a> <a id="3284" class="Symbol">:</a> <a id="3286" href="UTxO.Validity.html#2261" class="Datatype">ValidLedger</a> <a id="3298" href="StateMachine.Examples.Counter.html#3250" class="Bound">l</a><a id="3299" class="Symbol">}{</a><a id="3301" href="StateMachine.Examples.Counter.html#3301" class="Bound">vl′</a><a id="3304" class="Symbol">}</a>
  <a id="3308" class="Symbol">→</a> <a id="3310" href="StateMachine.Examples.Counter.html#3281" class="Bound">vl</a> <a id="3313" href="Bisimulation.Base.html#695" class="Function Operator">—→[</a> <a id="3317" href="StateMachine.Examples.Counter.html#3247" class="Bound">tx</a> <a id="3320" href="Bisimulation.Base.html#695" class="Function Operator">∶-</a> <a id="3323" href="StateMachine.Examples.Counter.html#3259" class="Bound">vtx</a> <a id="3327" href="Bisimulation.Base.html#695" class="Function Operator">]</a> <a id="3329" href="StateMachine.Examples.Counter.html#3301" class="Bound">vl′</a>
  <a id="3335" class="Symbol">→</a> <a id="3337" class="Symbol">∀</a> <a id="3339" href="StateMachine.Examples.Counter.html#3339" class="Bound">s</a> <a id="3341" class="Symbol">→</a> <a id="3343" href="StateMachine.Examples.Counter.html#3281" class="Bound">vl</a> <a id="3346" href="Bisimulation.Base.html#835" class="Function Operator">~</a> <a id="3348" href="StateMachine.Examples.Counter.html#3339" class="Bound">s</a>
  <a id="3352" class="Symbol">→</a> <a id="3354" href="StateMachine.Examples.Counter.html#1874" class="Function">Valid</a> <a id="3360" href="StateMachine.Examples.Counter.html#3339" class="Bound">s</a>
  <a id="3364" class="Symbol">→</a> <a id="3366" class="Symbol">(</a><a id="3367" href="Agda.Builtin.Sigma.html#148" class="Record">Σ</a> <a id="3369" href="StateMachine.Examples.Counter.html#680" class="Datatype">State</a> <a id="3375" class="Symbol">λ</a> <a id="3377" href="StateMachine.Examples.Counter.html#3377" class="Bound">s′</a> <a id="3380" class="Symbol">→</a> <a id="3382" href="StateMachine.Examples.Counter.html#1874" class="Function">Valid</a> <a id="3388" href="StateMachine.Examples.Counter.html#3377" class="Bound">s′</a> <a id="3391" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="3393" class="Symbol">(</a><a id="3394" href="StateMachine.Examples.Counter.html#3301" class="Bound">vl′</a> <a id="3398" href="Bisimulation.Base.html#835" class="Function Operator">~</a> <a id="3400" href="StateMachine.Examples.Counter.html#3377" class="Bound">s′</a><a id="3402" class="Symbol">))</a> <a id="3405" href="Data.Sum.Base.html#743" class="Datatype Operator">⊎</a> <a id="3407" href="StateMachine.Examples.Counter.html#3301" class="Bound">vl′</a> <a id="3411" href="Bisimulation.Base.html#835" class="Function Operator">~</a> <a id="3413" href="StateMachine.Examples.Counter.html#3339" class="Bound">s</a>
<a id="3415" href="StateMachine.Examples.Counter.html#3237" class="Function">lemma</a> <a id="3421" class="Symbol">=</a> <a id="3423" href="StateMachine.Properties.Ledger.html#741" class="Function">lemmaP</a> <a id="3430" href="StateMachine.Examples.Counter.html#1874" class="Function">Valid</a> <a id="3436" href="StateMachine.Examples.Counter.html#2018" class="Function">lemma-step</a>

<a id="3448" class="Comment">-- Liveness</a>
<a id="3460" class="Comment">-- ========</a>

<a id="3473" class="Comment">-- A liveness property: all states can advance/the machine cannot get stuck</a>

<a id="liveness"></a><a id="3550" href="StateMachine.Examples.Counter.html#3550" class="Function">liveness</a> <a id="3559" class="Symbol">:</a> <a id="3561" class="Symbol">∀</a> <a id="3563" href="StateMachine.Examples.Counter.html#3563" class="Bound">s</a> <a id="3565" class="Symbol">→</a> <a id="3567" href="Agda.Builtin.Sigma.html#148" class="Record">Σ</a> <a id="3569" href="StateMachine.Examples.Counter.html#726" class="Datatype">Input</a> <a id="3575" class="Symbol">λ</a> <a id="3577" href="StateMachine.Examples.Counter.html#3577" class="Bound">i</a> <a id="3579" class="Symbol">→</a> <a id="3581" href="Agda.Builtin.Sigma.html#148" class="Record">Σ</a> <a id="3583" href="StateMachine.Base.html#1178" class="Record">TxConstraints</a> <a id="3597" class="Symbol">λ</a> <a id="3599" href="StateMachine.Examples.Counter.html#3599" class="Bound">tx≡</a> <a id="3603" class="Symbol">→</a> <a id="3605" href="Agda.Builtin.Sigma.html#148" class="Record">Σ</a> <a id="3607" href="StateMachine.Examples.Counter.html#680" class="Datatype">State</a> <a id="3613" class="Symbol">λ</a> <a id="3615" href="StateMachine.Examples.Counter.html#3615" class="Bound">s&#39;</a> <a id="3618" class="Symbol">→</a> <a id="3620" href="StateMachine.Examples.Counter.html#3563" class="Bound">s</a> <a id="3622" href="Bisimulation.Base.html#578" class="Function Operator">—→[</a> <a id="3626" href="StateMachine.Examples.Counter.html#3577" class="Bound">i</a> <a id="3628" href="Bisimulation.Base.html#578" class="Function Operator">]</a> <a id="3630" class="Symbol">(</a><a id="3631" href="StateMachine.Examples.Counter.html#3615" class="Bound">s&#39;</a> <a id="3634" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3636" href="StateMachine.Examples.Counter.html#3599" class="Bound">tx≡</a><a id="3639" class="Symbol">)</a>
<a id="3641" href="StateMachine.Examples.Counter.html#3550" class="Function">liveness</a> <a id="3650" class="Symbol">(</a><a id="3651" href="StateMachine.Examples.Counter.html#700" class="InductiveConstructor">counter</a> <a id="3659" href="StateMachine.Examples.Counter.html#3659" class="Bound">x</a><a id="3660" class="Symbol">)</a> <a id="3662" class="Symbol">=</a> <a id="3664" href="StateMachine.Examples.Counter.html#746" class="InductiveConstructor">inc</a> <a id="3668" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3670" class="Symbol">_</a> <a id="3672" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3674" class="Symbol">_</a> <a id="3676" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3678" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="3684" class="Keyword">open</a> <a id="3689" class="Keyword">import</a> <a id="3696" href="Bisimulation.Soundness.html" class="Module">Bisimulation.Soundness</a> <a id="3719" class="Symbol">{</a><a id="3720" class="Argument">sm</a> <a id="3723" class="Symbol">=</a> <a id="3725" href="StateMachine.Examples.Counter.html#1275" class="Function">CounterSM</a><a id="3734" class="Symbol">}</a>

<a id="livesat-lem"></a><a id="3737" href="StateMachine.Examples.Counter.html#3737" class="Function">livesat-lem</a> <a id="3749" class="Symbol">:</a> <a id="3751" class="Symbol">∀</a> <a id="3753" href="StateMachine.Examples.Counter.html#3753" class="Bound">s</a> <a id="3755" class="Symbol">→</a> <a id="3757" class="Symbol">(</a><a id="3758" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a> <a id="3764" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3766" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a> <a id="3772" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3774" href="StateMachine.Examples.Counter.html#3550" class="Function">liveness</a> <a id="3783" href="StateMachine.Examples.Counter.html#3753" class="Bound">s</a><a id="3784" class="Symbol">)</a> <a id="3786" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3788" href="Prelude.Default.html#356" class="Field">def</a>
<a id="3792" href="StateMachine.Examples.Counter.html#3737" class="Function">livesat-lem</a> <a id="3804" class="Symbol">(</a><a id="3805" href="StateMachine.Examples.Counter.html#700" class="InductiveConstructor">counter</a> <a id="3813" href="StateMachine.Examples.Counter.html#3813" class="Bound">x</a><a id="3814" class="Symbol">)</a> <a id="3816" class="Symbol">=</a> <a id="3818" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="3824" class="Comment">-- liveness holds on chain (in a particular sense)</a>

<a id="liveness-lem"></a><a id="3876" href="StateMachine.Examples.Counter.html#3876" class="Function">liveness-lem</a> <a id="3889" class="Symbol">:</a> <a id="3891" class="Symbol">∀</a> <a id="3893" class="Symbol">{</a><a id="3894" href="StateMachine.Examples.Counter.html#3894" class="Bound">l</a> <a id="3896" href="StateMachine.Examples.Counter.html#3896" class="Bound">vl</a><a id="3898" class="Symbol">}</a> <a id="3900" href="StateMachine.Examples.Counter.html#3900" class="Bound">s</a> <a id="3902" class="Symbol">→</a> <a id="3904" href="StateMachine.Examples.Counter.html#3896" class="Bound">vl</a> <a id="3907" href="Bisimulation.Base.html#835" class="Function Operator">~</a> <a id="3909" href="StateMachine.Examples.Counter.html#3900" class="Bound">s</a> <a id="3911" class="Symbol">→</a>
  <a id="3915" href="Agda.Builtin.Sigma.html#148" class="Record">Σ</a> <a id="3917" href="UTxO.Types.html#7568" class="Record">Tx</a> <a id="3920" class="Symbol">λ</a> <a id="3922" href="StateMachine.Examples.Counter.html#3922" class="Bound">tx</a> <a id="3925" class="Symbol">→</a> <a id="3927" href="Agda.Builtin.Sigma.html#148" class="Record">Σ</a> <a id="3929" class="Symbol">(</a><a id="3930" href="UTxO.Validity.html#1336" class="Record">IsValidTx</a> <a id="3940" href="StateMachine.Examples.Counter.html#3922" class="Bound">tx</a> <a id="3943" href="StateMachine.Examples.Counter.html#3894" class="Bound">l</a><a id="3944" class="Symbol">)</a> <a id="3946" class="Symbol">λ</a> <a id="3948" href="StateMachine.Examples.Counter.html#3948" class="Bound">vtx</a> <a id="3952" class="Symbol">→</a> <a id="3954" href="Agda.Builtin.Sigma.html#148" class="Record">Σ</a> <a id="3956" class="Symbol">(</a><a id="3957" href="UTxO.Validity.html#2261" class="Datatype">ValidLedger</a> <a id="3969" class="Symbol">(</a><a id="3970" href="StateMachine.Examples.Counter.html#3922" class="Bound">tx</a> <a id="3973" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3975" href="StateMachine.Examples.Counter.html#3894" class="Bound">l</a><a id="3976" class="Symbol">))</a> <a id="3979" class="Symbol">λ</a> <a id="3981" href="StateMachine.Examples.Counter.html#3981" class="Bound">vl&#39;</a> <a id="3985" class="Symbol">→</a> <a id="3987" href="StateMachine.Examples.Counter.html#3896" class="Bound">vl</a> <a id="3990" href="Bisimulation.Base.html#695" class="Function Operator">—→[</a> <a id="3994" href="StateMachine.Examples.Counter.html#3922" class="Bound">tx</a> <a id="3997" href="Bisimulation.Base.html#695" class="Function Operator">∶-</a> <a id="4000" href="StateMachine.Examples.Counter.html#3948" class="Bound">vtx</a> <a id="4004" href="Bisimulation.Base.html#695" class="Function Operator">]</a> <a id="4006" href="StateMachine.Examples.Counter.html#3981" class="Bound">vl&#39;</a>
<a id="4010" href="StateMachine.Examples.Counter.html#3876" class="Function">liveness-lem</a> <a id="4023" class="Symbol">{</a><a id="4024" href="StateMachine.Examples.Counter.html#4024" class="Bound">l</a><a id="4025" class="Symbol">}{</a><a id="4027" href="StateMachine.Examples.Counter.html#4027" class="Bound">vl</a><a id="4029" class="Symbol">}</a> <a id="4031" href="StateMachine.Examples.Counter.html#4031" class="Bound">s</a><a id="4032" class="Symbol">@(</a><a id="4034" href="StateMachine.Examples.Counter.html#700" class="InductiveConstructor">counter</a> <a id="4042" href="StateMachine.Examples.Counter.html#4042" class="Bound">x</a><a id="4043" class="Symbol">)</a> <a id="4045" href="StateMachine.Examples.Counter.html#4045" class="Bound">b</a> <a id="4047" class="Symbol">=</a>
 <a id="4050" class="Keyword">let</a>
   <a id="4057" href="StateMachine.Examples.Counter.html#4057" class="Bound">i</a> <a id="4059" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4061" href="StateMachine.Examples.Counter.html#4061" class="Bound">tx≡</a> <a id="4065" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4067" href="StateMachine.Examples.Counter.html#4067" class="Bound">s&#39;</a> <a id="4070" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4072" href="StateMachine.Examples.Counter.html#4072" class="Bound">p</a> <a id="4074" class="Symbol">=</a> <a id="4076" href="StateMachine.Examples.Counter.html#3550" class="Function">liveness</a> <a id="4085" href="StateMachine.Examples.Counter.html#4031" class="Bound">s</a>
   <a id="4090" href="StateMachine.Examples.Counter.html#4090" class="Bound">tx</a> <a id="4093" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4095" href="StateMachine.Examples.Counter.html#4095" class="Bound">vtx</a> <a id="4099" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4101" href="StateMachine.Examples.Counter.html#4101" class="Bound">vl&#39;</a> <a id="4105" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4107" href="StateMachine.Examples.Counter.html#4107" class="Bound">p</a> <a id="4109" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4111" href="StateMachine.Examples.Counter.html#4111" class="Bound">b&#39;</a> <a id="4114" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4116" href="StateMachine.Examples.Counter.html#4116" class="Bound">X</a> <a id="4118" class="Symbol">=</a> <a id="4120" href="Bisimulation.Soundness.html#756" class="Function">soundness</a> <a id="4130" class="Symbol">{</a><a id="4131" class="Argument">s</a> <a id="4133" class="Symbol">=</a> <a id="4135" href="StateMachine.Examples.Counter.html#4031" class="Bound">s</a><a id="4136" class="Symbol">}</a> <a id="4138" href="StateMachine.Examples.Counter.html#4072" class="Bound">p</a> <a id="4140" href="StateMachine.Examples.Counter.html#4045" class="Bound">b</a> <a id="4142" class="Symbol">(</a><a id="4143" href="StateMachine.Properties.Ledger.html#555" class="Function">lemmaSat</a> <a id="4152" class="Symbol">{</a><a id="4153" href="StateMachine.Examples.Counter.html#4031" class="Bound">s</a><a id="4154" class="Symbol">}{</a><a id="4156" href="StateMachine.Examples.Counter.html#4024" class="Bound">l</a><a id="4157" class="Symbol">}{</a><a id="4159" href="StateMachine.Examples.Counter.html#4027" class="Bound">vl</a><a id="4161" class="Symbol">}</a> <a id="4163" href="StateMachine.Examples.Counter.html#4045" class="Bound">b</a><a id="4164" class="Symbol">)</a>
  <a id="4168" class="Keyword">in</a>
    <a id="4175" href="StateMachine.Examples.Counter.html#4090" class="Bound">tx</a> <a id="4178" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4180" href="StateMachine.Examples.Counter.html#4095" class="Bound">vtx</a> <a id="4184" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4186" href="StateMachine.Examples.Counter.html#4101" class="Bound">vl&#39;</a> <a id="4190" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4192" href="StateMachine.Examples.Counter.html#4107" class="Bound">p</a>
</pre></body></html>