<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.String.Base</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Strings: builtin type and basic operations</a>
<a id="152" class="Comment">------------------------------------------------------------------------</a>

<a id="226" class="Symbol">{-#</a> <a id="230" class="Keyword">OPTIONS</a> <a id="238" class="Pragma">--without-K</a> <a id="250" class="Pragma">--safe</a> <a id="257" class="Symbol">#-}</a>

<a id="262" class="Keyword">module</a> <a id="269" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="286" class="Keyword">where</a>

<a id="293" class="Keyword">open</a> <a id="298" class="Keyword">import</a> <a id="305" href="Level.html" class="Module">Level</a> <a id="311" class="Keyword">using</a> <a id="317" class="Symbol">(</a><a id="318" href="Agda.Primitive.html#590" class="Primitive">zero</a><a id="322" class="Symbol">)</a>
<a id="324" class="Keyword">open</a> <a id="329" class="Keyword">import</a> <a id="336" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="346" class="Keyword">using</a> <a id="352" class="Symbol">(</a><a id="353" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="357" class="Symbol">;</a> <a id="359" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="364" class="Symbol">)</a>
<a id="366" class="Keyword">open</a> <a id="371" class="Keyword">import</a> <a id="378" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="392" class="Symbol">as</a> <a id="395" class="Module">ℕ</a> <a id="397" class="Keyword">using</a> <a id="403" class="Symbol">(</a><a id="404" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="405" class="Symbol">;</a> <a id="407" href="Data.Nat.Base.html#1429" class="Primitive Operator">_∸_</a><a id="410" class="Symbol">;</a> <a id="412" href="Data.Nat.Base.html#1859" class="Function Operator">⌊_/2⌋</a><a id="417" class="Symbol">;</a> <a id="419" href="Data.Nat.Base.html#1986" class="Function Operator">⌈_/2⌉</a><a id="424" class="Symbol">)</a>
<a id="426" class="Keyword">import</a> <a id="433" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="453" class="Symbol">as</a> <a id="456" class="Module">ℕₚ</a>
<a id="459" class="Keyword">open</a> <a id="464" class="Keyword">import</a> <a id="471" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="486" class="Symbol">as</a> <a id="489" class="Module">List</a> <a id="494" class="Keyword">using</a> <a id="500" class="Symbol">(</a><a id="501" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="505" class="Symbol">;</a> <a id="507" href="Data.List.Base.html#4458" class="Function Operator">[_]</a><a id="510" class="Symbol">)</a>
<a id="512" class="Keyword">open</a> <a id="517" class="Keyword">import</a> <a id="524" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="543" class="Symbol">as</a> <a id="546" class="Module">NE</a> <a id="549" class="Keyword">using</a> <a id="555" class="Symbol">(</a><a id="556" href="Data.List.NonEmpty.html#1318" class="Record">List⁺</a><a id="561" class="Symbol">)</a>
<a id="563" class="Keyword">open</a> <a id="568" class="Keyword">import</a> <a id="575" href="Data.List.Extrema.html" class="Module">Data.List.Extrema</a> <a id="593" href="Data.Nat.Properties.html#5728" class="Function">ℕₚ.≤-totalOrder</a>
<a id="609" class="Keyword">open</a> <a id="614" class="Keyword">import</a> <a id="621" href="Data.List.Relation.Binary.Pointwise.html" class="Module">Data.List.Relation.Binary.Pointwise</a> <a id="657" class="Keyword">using</a> <a id="663" class="Symbol">(</a><a id="664" href="Data.List.Relation.Binary.Pointwise.html#1571" class="Datatype">Pointwise</a><a id="673" class="Symbol">)</a>
<a id="675" class="Keyword">open</a> <a id="680" class="Keyword">import</a> <a id="687" href="Data.List.Relation.Binary.Lex.Strict.html" class="Module">Data.List.Relation.Binary.Lex.Strict</a> <a id="724" class="Keyword">using</a> <a id="730" class="Symbol">(</a><a id="731" href="Data.List.Relation.Binary.Lex.Strict.html#1177" class="Function">Lex-&lt;</a><a id="736" class="Symbol">)</a>
<a id="738" class="Keyword">open</a> <a id="743" class="Keyword">import</a> <a id="750" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="764" class="Symbol">as</a> <a id="767" class="Module">Vec</a> <a id="771" class="Keyword">using</a> <a id="777" class="Symbol">(</a><a id="778" href="Data.Vec.Base.html#959" class="Datatype">Vec</a><a id="781" class="Symbol">)</a>
<a id="783" class="Keyword">open</a> <a id="788" class="Keyword">import</a> <a id="795" href="Data.Char.Base.html" class="Module">Data.Char.Base</a> <a id="810" class="Symbol">as</a> <a id="813" class="Module">Char</a> <a id="818" class="Keyword">using</a> <a id="824" class="Symbol">(</a><a id="825" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a><a id="829" class="Symbol">)</a>
<a id="831" class="Keyword">import</a> <a id="838" href="Data.Char.Properties.html" class="Module">Data.Char.Properties</a> <a id="859" class="Symbol">as</a> <a id="862" class="Module">Char</a> <a id="867" class="Keyword">using</a> <a id="873" class="Symbol">(</a><a id="874" href="Data.Char.Properties.html#1963" class="Function Operator">_≟_</a><a id="877" class="Symbol">)</a>
<a id="879" class="Keyword">open</a> <a id="884" class="Keyword">import</a> <a id="891" href="Function.html" class="Module">Function</a>
<a id="900" class="Keyword">open</a> <a id="905" class="Keyword">import</a> <a id="912" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="928" class="Keyword">using</a> <a id="934" class="Symbol">(</a><a id="935" href="Relation.Binary.Core.html#845" class="Function">Rel</a><a id="938" class="Symbol">)</a>
<a id="940" class="Keyword">open</a> <a id="945" class="Keyword">import</a> <a id="952" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="969" class="Keyword">using</a> <a id="975" class="Symbol">(</a><a id="976" href="Relation.Nullary.html#1578" class="Field">does</a><a id="980" class="Symbol">)</a>

<a id="983" class="Keyword">open</a> <a id="988" class="Keyword">import</a> <a id="995" href="Data.List.Membership.DecPropositional.html" class="Module">Data.List.Membership.DecPropositional</a> <a id="1033" href="Data.Char.Properties.html#1963" class="Function Operator">Char._≟_</a>

<a id="1043" class="Comment">------------------------------------------------------------------------</a>
<a id="1116" class="Comment">-- From Agda.Builtin: type and renamed primitives</a>

<a id="1167" class="Comment">-- Note that we do not re-export primStringAppend because we want to</a>
<a id="1236" class="Comment">-- give it an infix definition and be able to assign it a level.</a>

<a id="1302" class="Keyword">import</a> <a id="1309" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a> <a id="1329" class="Symbol">as</a> <a id="1332" class="Module">String</a>

<a id="1340" class="Keyword">open</a> <a id="1345" href="Agda.Builtin.String.html" class="Module">String</a> <a id="1352" class="Keyword">public</a> <a id="1359" class="Keyword">using</a> <a id="1365" class="Symbol">(</a> <a id="1367" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="1374" class="Symbol">)</a>
  <a id="1378" class="Keyword">renaming</a>
  <a id="1389" class="Symbol">(</a> <a id="1391" href="Agda.Builtin.String.html#330" class="Primitive">primStringToList</a>   <a id="1410" class="Symbol">to</a> <a id="primStringToList"></a><a id="1413" href="Data.String.Base.html#1413" class="Primitive">toList</a>
  <a id="1422" class="Symbol">;</a> <a id="1424" href="Agda.Builtin.String.html#372" class="Primitive">primStringFromList</a> <a id="1443" class="Symbol">to</a> <a id="primStringFromList"></a><a id="1446" href="Data.String.Base.html#1446" class="Primitive">fromList</a>
  <a id="1457" class="Symbol">;</a> <a id="1459" href="Agda.Builtin.String.html#545" class="Primitive">primShowString</a>     <a id="1478" class="Symbol">to</a> <a id="primShowString"></a><a id="1481" href="Data.String.Base.html#1481" class="Primitive">show</a>
  <a id="1488" class="Symbol">)</a>

<a id="1491" class="Comment">------------------------------------------------------------------------</a>
<a id="1564" class="Comment">-- Relations</a>

<a id="1578" class="Comment">-- Pointwise equality on Strings</a>

<a id="1612" class="Keyword">infix</a> <a id="1618" class="Number">4</a> <a id="1620" href="Data.String.Base.html#1624" class="Function Operator">_≈_</a>
<a id="_≈_"></a><a id="1624" href="Data.String.Base.html#1624" class="Function Operator">_≈_</a> <a id="1628" class="Symbol">:</a> <a id="1630" href="Relation.Binary.Core.html#845" class="Function">Rel</a> <a id="1634" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="1641" href="Agda.Primitive.html#590" class="Primitive">zero</a>
<a id="1646" href="Data.String.Base.html#1624" class="Function Operator">_≈_</a> <a id="1650" class="Symbol">=</a> <a id="1652" href="Data.List.Relation.Binary.Pointwise.html#1571" class="Datatype">Pointwise</a> <a id="1662" href="Data.Char.Base.html#1132" class="Function Operator">Char._≈_</a> <a id="1671" href="Function.Base.html#3938" class="Function Operator">on</a> <a id="1674" href="Data.String.Base.html#1413" class="Primitive">toList</a>

<a id="1682" class="Comment">-- Lexicographic ordering on Strings</a>

<a id="1720" class="Keyword">infix</a> <a id="1726" class="Number">4</a> <a id="1728" href="Data.String.Base.html#1732" class="Function Operator">_&lt;_</a>
<a id="_&lt;_"></a><a id="1732" href="Data.String.Base.html#1732" class="Function Operator">_&lt;_</a> <a id="1736" class="Symbol">:</a> <a id="1738" href="Relation.Binary.Core.html#845" class="Function">Rel</a> <a id="1742" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="1749" href="Agda.Primitive.html#590" class="Primitive">zero</a>
<a id="1754" href="Data.String.Base.html#1732" class="Function Operator">_&lt;_</a> <a id="1758" class="Symbol">=</a> <a id="1760" href="Data.List.Relation.Binary.Lex.Strict.html#1177" class="Function">Lex-&lt;</a> <a id="1766" href="Data.Char.Base.html#1132" class="Function Operator">Char._≈_</a> <a id="1775" href="Data.Char.Base.html#1182" class="Function Operator">Char._&lt;_</a> <a id="1784" href="Function.Base.html#3938" class="Function Operator">on</a> <a id="1787" href="Data.String.Base.html#1413" class="Primitive">toList</a>

<a id="1795" class="Comment">------------------------------------------------------------------------</a>
<a id="1868" class="Comment">-- Operations</a>

<a id="1883" class="Comment">-- Additional conversion functions</a>

<a id="fromChar"></a><a id="1919" href="Data.String.Base.html#1919" class="Function">fromChar</a> <a id="1928" class="Symbol">:</a> <a id="1930" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a> <a id="1935" class="Symbol">→</a> <a id="1937" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="1944" href="Data.String.Base.html#1919" class="Function">fromChar</a> <a id="1953" class="Symbol">=</a> <a id="1955" href="Data.String.Base.html#1446" class="Primitive">fromList</a> <a id="1964" href="Function.Base.html#3193" class="Function Operator">∘′</a> <a id="1967" href="Data.List.Base.html#4458" class="Function Operator">[_]</a>

<a id="fromList⁺"></a><a id="1972" href="Data.String.Base.html#1972" class="Function">fromList⁺</a> <a id="1982" class="Symbol">:</a> <a id="1984" href="Data.List.NonEmpty.html#1318" class="Record">List⁺</a> <a id="1990" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a> <a id="1995" class="Symbol">→</a> <a id="1997" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="2004" href="Data.String.Base.html#1972" class="Function">fromList⁺</a> <a id="2014" class="Symbol">=</a> <a id="2016" href="Data.String.Base.html#1446" class="Primitive">fromList</a> <a id="2025" href="Function.Base.html#3193" class="Function Operator">∘′</a> <a id="2028" href="Data.List.NonEmpty.html#1760" class="Function">NE.toList</a>

<a id="2039" class="Comment">-- List-like functions</a>

<a id="2063" class="Keyword">infixr</a> <a id="2070" class="Number">5</a> <a id="2072" href="Data.String.Base.html#2077" class="Function Operator">_++_</a>
<a id="_++_"></a><a id="2077" href="Data.String.Base.html#2077" class="Function Operator">_++_</a> <a id="2082" class="Symbol">:</a> <a id="2084" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="2091" class="Symbol">→</a> <a id="2093" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="2100" class="Symbol">→</a> <a id="2102" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="2109" href="Data.String.Base.html#2077" class="Function Operator">_++_</a> <a id="2114" class="Symbol">=</a> <a id="2116" href="Agda.Builtin.String.html#414" class="Primitive">String.primStringAppend</a>

<a id="length"></a><a id="2141" href="Data.String.Base.html#2141" class="Function">length</a> <a id="2148" class="Symbol">:</a> <a id="2150" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="2157" class="Symbol">→</a> <a id="2159" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="2161" href="Data.String.Base.html#2141" class="Function">length</a> <a id="2168" class="Symbol">=</a> <a id="2170" href="Data.List.Base.html#4297" class="Function">List.length</a> <a id="2182" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2184" href="Data.String.Base.html#1413" class="Primitive">toList</a>

<a id="replicate"></a><a id="2192" href="Data.String.Base.html#2192" class="Function">replicate</a> <a id="2202" class="Symbol">:</a> <a id="2204" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2206" class="Symbol">→</a> <a id="2208" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a> <a id="2213" class="Symbol">→</a> <a id="2215" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="2222" href="Data.String.Base.html#2192" class="Function">replicate</a> <a id="2232" href="Data.String.Base.html#2232" class="Bound">n</a> <a id="2234" class="Symbol">=</a> <a id="2236" href="Data.String.Base.html#1446" class="Primitive">fromList</a> <a id="2245" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2247" href="Data.List.Base.html#4572" class="Function">List.replicate</a> <a id="2262" href="Data.String.Base.html#2232" class="Bound">n</a>

<a id="concat"></a><a id="2265" href="Data.String.Base.html#2265" class="Function">concat</a> <a id="2272" class="Symbol">:</a> <a id="2274" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2279" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="2286" class="Symbol">→</a> <a id="2288" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="2295" href="Data.String.Base.html#2265" class="Function">concat</a> <a id="2302" class="Symbol">=</a> <a id="2304" href="Data.List.Base.html#3625" class="Function">List.foldr</a> <a id="2315" href="Data.String.Base.html#2077" class="Function Operator">_++_</a> <a id="2320" class="String">&quot;&quot;</a>

<a id="intersperse"></a><a id="2324" href="Data.String.Base.html#2324" class="Function">intersperse</a> <a id="2336" class="Symbol">:</a> <a id="2338" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="2345" class="Symbol">→</a> <a id="2347" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2352" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="2359" class="Symbol">→</a> <a id="2361" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="2368" href="Data.String.Base.html#2324" class="Function">intersperse</a> <a id="2380" href="Data.String.Base.html#2380" class="Bound">sep</a> <a id="2384" class="Symbol">=</a> <a id="2386" href="Data.String.Base.html#2265" class="Function">concat</a> <a id="2393" href="Function.Base.html#3193" class="Function Operator">∘′</a> <a id="2396" class="Symbol">(</a><a id="2397" href="Data.List.Base.html#1848" class="Function">List.intersperse</a> <a id="2414" href="Data.String.Base.html#2380" class="Bound">sep</a><a id="2417" class="Symbol">)</a>

<a id="2420" class="Comment">-- String-specific functions</a>

<a id="unlines"></a><a id="2450" href="Data.String.Base.html#2450" class="Function">unlines</a> <a id="2458" class="Symbol">:</a> <a id="2460" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2465" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="2472" class="Symbol">→</a> <a id="2474" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="2481" href="Data.String.Base.html#2450" class="Function">unlines</a> <a id="2489" class="Symbol">=</a> <a id="2491" href="Data.String.Base.html#2324" class="Function">intersperse</a> <a id="2503" class="String">&quot;\n&quot;</a>

<a id="unwords"></a><a id="2509" href="Data.String.Base.html#2509" class="Function">unwords</a> <a id="2517" class="Symbol">:</a> <a id="2519" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2524" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="2531" class="Symbol">→</a> <a id="2533" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="2540" href="Data.String.Base.html#2509" class="Function">unwords</a> <a id="2548" class="Symbol">=</a> <a id="2550" href="Data.String.Base.html#2324" class="Function">intersperse</a> <a id="2562" class="String">&quot; &quot;</a>

<a id="parens"></a><a id="2567" href="Data.String.Base.html#2567" class="Function">parens</a> <a id="2574" class="Symbol">:</a> <a id="2576" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="2583" class="Symbol">→</a> <a id="2585" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="2592" href="Data.String.Base.html#2567" class="Function">parens</a> <a id="2599" href="Data.String.Base.html#2599" class="Bound">s</a> <a id="2601" class="Symbol">=</a> <a id="2603" class="String">&quot;(&quot;</a> <a id="2607" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="2610" href="Data.String.Base.html#2599" class="Bound">s</a> <a id="2612" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="2615" class="String">&quot;)&quot;</a>

<a id="2620" class="Comment">-- enclose string with parens if it contains a space character</a>
<a id="parensIfSpace"></a><a id="2683" href="Data.String.Base.html#2683" class="Function">parensIfSpace</a> <a id="2697" class="Symbol">:</a> <a id="2699" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="2706" class="Symbol">→</a> <a id="2708" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="2715" href="Data.String.Base.html#2683" class="Function">parensIfSpace</a> <a id="2729" href="Data.String.Base.html#2729" class="Bound">s</a> <a id="2731" class="Keyword">with</a> <a id="2736" href="Relation.Nullary.html#1578" class="Field">does</a> <a id="2741" class="Symbol">(</a><a id="2742" class="String">&#39; &#39;</a> <a id="2746" href="Data.List.Membership.DecSetoid.html#762" class="Function Operator">∈?</a> <a id="2749" href="Data.String.Base.html#1413" class="Primitive">toList</a> <a id="2756" href="Data.String.Base.html#2729" class="Bound">s</a><a id="2757" class="Symbol">)</a>
<a id="2759" class="Symbol">...</a> <a id="2763" class="Symbol">|</a> <a id="2765" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>  <a id="2771" class="Symbol">=</a> <a id="2773" href="Data.String.Base.html#2567" class="Function">parens</a> <a id="2780" class="Bound">s</a>
<a id="2782" class="Symbol">...</a> <a id="2786" class="Symbol">|</a> <a id="2788" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="2794" class="Symbol">=</a> <a id="2796" class="Bound">s</a>

<a id="braces"></a><a id="2799" href="Data.String.Base.html#2799" class="Function">braces</a> <a id="2806" class="Symbol">:</a> <a id="2808" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="2815" class="Symbol">→</a> <a id="2817" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="2824" href="Data.String.Base.html#2799" class="Function">braces</a> <a id="2831" href="Data.String.Base.html#2831" class="Bound">s</a> <a id="2833" class="Symbol">=</a> <a id="2835" class="String">&quot;{&quot;</a> <a id="2839" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="2842" href="Data.String.Base.html#2831" class="Bound">s</a> <a id="2844" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="2847" class="String">&quot;}&quot;</a>

<a id="2852" class="Comment">-- append that also introduces spaces, if necessary</a>
<a id="2904" class="Keyword">infixr</a> <a id="2911" class="Number">5</a> <a id="2913" href="Data.String.Base.html#2919" class="Function Operator">_&lt;+&gt;_</a>
<a id="_&lt;+&gt;_"></a><a id="2919" href="Data.String.Base.html#2919" class="Function Operator">_&lt;+&gt;_</a> <a id="2925" class="Symbol">:</a> <a id="2927" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="2934" class="Symbol">→</a> <a id="2936" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="2943" class="Symbol">→</a> <a id="2945" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="2952" class="String">&quot;&quot;</a> <a id="2955" href="Data.String.Base.html#2919" class="Function Operator">&lt;+&gt;</a> <a id="2959" href="Data.String.Base.html#2959" class="Bound">b</a> <a id="2961" class="Symbol">=</a> <a id="2963" href="Data.String.Base.html#2959" class="Bound">b</a>
<a id="2965" href="Data.String.Base.html#2965" class="Bound">a</a> <a id="2967" href="Data.String.Base.html#2919" class="Function Operator">&lt;+&gt;</a> <a id="2971" class="String">&quot;&quot;</a> <a id="2974" class="Symbol">=</a> <a id="2976" href="Data.String.Base.html#2965" class="Bound">a</a>
<a id="2978" href="Data.String.Base.html#2978" class="Bound">a</a> <a id="2980" href="Data.String.Base.html#2919" class="Function Operator">&lt;+&gt;</a> <a id="2984" href="Data.String.Base.html#2984" class="Bound">b</a> <a id="2986" class="Symbol">=</a> <a id="2988" href="Data.String.Base.html#2978" class="Bound">a</a> <a id="2990" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="2993" class="String">&quot; &quot;</a> <a id="2997" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="3000" href="Data.String.Base.html#2984" class="Bound">b</a>

<a id="3003" class="Comment">------------------------------------------------------------------------</a>
<a id="3076" class="Comment">-- Padding</a>

<a id="3088" class="Comment">-- Each one of the padding functions should verify the following</a>
<a id="3153" class="Comment">-- invariant:</a>
<a id="3167" class="Comment">--   If length str ≤ n then length (padLeft c n str) ≡ n</a>
<a id="3224" class="Comment">--   and otherwise padLeft c n str ≡ str.</a>

<a id="3267" class="Comment">-- Appending an empty string is expensive (append for Haskell&#39;s</a>
<a id="3331" class="Comment">-- Text creates a fresh Text value in which both contents are</a>
<a id="3393" class="Comment">-- copied) so we precompute `n ∸ length str` and check whether</a>
<a id="3456" class="Comment">-- it is equal to 0.</a>

<a id="padLeft"></a><a id="3478" href="Data.String.Base.html#3478" class="Function">padLeft</a> <a id="3486" class="Symbol">:</a> <a id="3488" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a> <a id="3493" class="Symbol">→</a> <a id="3495" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="3497" class="Symbol">→</a> <a id="3499" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="3506" class="Symbol">→</a> <a id="3508" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="3515" href="Data.String.Base.html#3478" class="Function">padLeft</a> <a id="3523" href="Data.String.Base.html#3523" class="Bound">c</a> <a id="3525" href="Data.String.Base.html#3525" class="Bound">n</a> <a id="3527" href="Data.String.Base.html#3527" class="Bound">str</a> <a id="3531" class="Keyword">with</a> <a id="3536" href="Data.String.Base.html#3525" class="Bound">n</a> <a id="3538" href="Data.Nat.Base.html#1429" class="Primitive Operator">∸</a> <a id="3540" href="Data.String.Base.html#2141" class="Function">length</a> <a id="3547" href="Data.String.Base.html#3527" class="Bound">str</a>
<a id="3551" class="Symbol">...</a> <a id="3555" class="Symbol">|</a> <a id="3557" class="Number">0</a> <a id="3559" class="Symbol">=</a> <a id="3561" class="Bound">str</a>
<a id="3565" class="CatchallClause Symbol">...</a><a id="3568" class="CatchallClause"> </a><a id="3569" class="CatchallClause Symbol">|</a><a id="3570" class="CatchallClause"> </a><a id="3571" href="Data.String.Base.html#3571" class="CatchallClause Bound">l</a> <a id="3573" class="Symbol">=</a> <a id="3575" href="Data.String.Base.html#2192" class="Function">replicate</a> <a id="3585" href="Data.String.Base.html#3571" class="Bound">l</a> <a id="3587" class="Bound">c</a> <a id="3589" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="3592" class="Bound">str</a>

<a id="padRight"></a><a id="3597" href="Data.String.Base.html#3597" class="Function">padRight</a> <a id="3606" class="Symbol">:</a> <a id="3608" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a> <a id="3613" class="Symbol">→</a> <a id="3615" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="3617" class="Symbol">→</a> <a id="3619" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="3626" class="Symbol">→</a> <a id="3628" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="3635" href="Data.String.Base.html#3597" class="Function">padRight</a> <a id="3644" href="Data.String.Base.html#3644" class="Bound">c</a> <a id="3646" href="Data.String.Base.html#3646" class="Bound">n</a> <a id="3648" href="Data.String.Base.html#3648" class="Bound">str</a> <a id="3652" class="Keyword">with</a> <a id="3657" href="Data.String.Base.html#3646" class="Bound">n</a> <a id="3659" href="Data.Nat.Base.html#1429" class="Primitive Operator">∸</a> <a id="3661" href="Data.String.Base.html#2141" class="Function">length</a> <a id="3668" href="Data.String.Base.html#3648" class="Bound">str</a>
<a id="3672" class="Symbol">...</a> <a id="3676" class="Symbol">|</a> <a id="3678" class="Number">0</a> <a id="3680" class="Symbol">=</a> <a id="3682" class="Bound">str</a>
<a id="3686" class="CatchallClause Symbol">...</a><a id="3689" class="CatchallClause"> </a><a id="3690" class="CatchallClause Symbol">|</a><a id="3691" class="CatchallClause"> </a><a id="3692" href="Data.String.Base.html#3692" class="CatchallClause Bound">l</a> <a id="3694" class="Symbol">=</a> <a id="3696" class="Bound">str</a> <a id="3700" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="3703" href="Data.String.Base.html#2192" class="Function">replicate</a> <a id="3713" href="Data.String.Base.html#3692" class="Bound">l</a> <a id="3715" class="Bound">c</a>

<a id="padBoth"></a><a id="3718" href="Data.String.Base.html#3718" class="Function">padBoth</a> <a id="3726" class="Symbol">:</a> <a id="3728" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a> <a id="3733" class="Symbol">→</a> <a id="3735" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a> <a id="3740" class="Symbol">→</a> <a id="3742" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="3744" class="Symbol">→</a> <a id="3746" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="3753" class="Symbol">→</a> <a id="3755" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="3762" href="Data.String.Base.html#3718" class="Function">padBoth</a> <a id="3770" href="Data.String.Base.html#3770" class="Bound">cₗ</a> <a id="3773" href="Data.String.Base.html#3773" class="Bound">cᵣ</a> <a id="3776" href="Data.String.Base.html#3776" class="Bound">n</a> <a id="3778" href="Data.String.Base.html#3778" class="Bound">str</a> <a id="3782" class="Keyword">with</a> <a id="3787" href="Data.String.Base.html#3776" class="Bound">n</a> <a id="3789" href="Data.Nat.Base.html#1429" class="Primitive Operator">∸</a> <a id="3791" href="Data.String.Base.html#2141" class="Function">length</a> <a id="3798" href="Data.String.Base.html#3778" class="Bound">str</a>
<a id="3802" class="Symbol">...</a> <a id="3806" class="Symbol">|</a> <a id="3808" class="Number">0</a> <a id="3810" class="Symbol">=</a> <a id="3812" class="Bound">str</a>
<a id="3816" class="CatchallClause Symbol">...</a><a id="3819" class="CatchallClause"> </a><a id="3820" class="CatchallClause Symbol">|</a><a id="3821" class="CatchallClause"> </a><a id="3822" href="Data.String.Base.html#3822" class="CatchallClause Bound">l</a> <a id="3824" class="Symbol">=</a> <a id="3826" href="Data.String.Base.html#2192" class="Function">replicate</a> <a id="3836" href="Data.Nat.Base.html#1859" class="Function Operator">⌊</a> <a id="3838" href="Data.String.Base.html#3822" class="Bound">l</a> <a id="3840" href="Data.Nat.Base.html#1859" class="Function Operator">/2⌋</a> <a id="3844" class="Bound">cₗ</a> <a id="3847" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="3850" class="Bound">str</a> <a id="3854" href="Data.String.Base.html#2077" class="Function Operator">++</a> <a id="3857" href="Data.String.Base.html#2192" class="Function">replicate</a> <a id="3867" href="Data.Nat.Base.html#1986" class="Function Operator">⌈</a> <a id="3869" href="Data.String.Base.html#3822" class="Bound">l</a> <a id="3871" href="Data.Nat.Base.html#1986" class="Function Operator">/2⌉</a> <a id="3875" class="Bound">cᵣ</a>

<a id="3879" class="Comment">------------------------------------------------------------------------</a>
<a id="3952" class="Comment">-- Alignment</a>

<a id="3966" class="Comment">-- We can align a String left, center or right in a column of a given</a>
<a id="4036" class="Comment">-- width by padding it with whitespace.</a>

<a id="4077" class="Keyword">data</a> <a id="Alignment"></a><a id="4082" href="Data.String.Base.html#4082" class="Datatype">Alignment</a> <a id="4092" class="Symbol">:</a> <a id="4094" class="PrimitiveType">Set</a> <a id="4098" class="Keyword">where</a>
  <a id="Alignment.Left"></a><a id="4106" href="Data.String.Base.html#4106" class="InductiveConstructor">Left</a> <a id="Alignment.Center"></a><a id="4111" href="Data.String.Base.html#4111" class="InductiveConstructor">Center</a> <a id="Alignment.Right"></a><a id="4118" href="Data.String.Base.html#4118" class="InductiveConstructor">Right</a> <a id="4124" class="Symbol">:</a> <a id="4126" href="Data.String.Base.html#4082" class="Datatype">Alignment</a>

<a id="fromAlignment"></a><a id="4137" href="Data.String.Base.html#4137" class="Function">fromAlignment</a> <a id="4151" class="Symbol">:</a> <a id="4153" href="Data.String.Base.html#4082" class="Datatype">Alignment</a> <a id="4163" class="Symbol">→</a> <a id="4165" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="4167" class="Symbol">→</a> <a id="4169" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="4176" class="Symbol">→</a> <a id="4178" href="Agda.Builtin.String.html#274" class="Postulate">String</a>
<a id="4185" href="Data.String.Base.html#4137" class="Function">fromAlignment</a> <a id="4199" href="Data.String.Base.html#4106" class="InductiveConstructor">Left</a>   <a id="4206" class="Symbol">=</a> <a id="4208" href="Data.String.Base.html#3597" class="Function">padRight</a> <a id="4217" class="String">&#39; &#39;</a>
<a id="4221" href="Data.String.Base.html#4137" class="Function">fromAlignment</a> <a id="4235" href="Data.String.Base.html#4111" class="InductiveConstructor">Center</a> <a id="4242" class="Symbol">=</a> <a id="4244" href="Data.String.Base.html#3718" class="Function">padBoth</a> <a id="4252" class="String">&#39; &#39;</a> <a id="4256" class="String">&#39; &#39;</a>
<a id="4260" href="Data.String.Base.html#4137" class="Function">fromAlignment</a> <a id="4274" href="Data.String.Base.html#4118" class="InductiveConstructor">Right</a>  <a id="4281" class="Symbol">=</a> <a id="4283" href="Data.String.Base.html#3478" class="Function">padLeft</a> <a id="4291" class="String">&#39; &#39;</a>

<a id="4296" class="Comment">------------------------------------------------------------------------</a>
<a id="4369" class="Comment">-- Rectangle</a>

<a id="4383" class="Comment">-- Build a rectangular column by:</a>
<a id="4417" class="Comment">-- Given a vector of cells and a padding function for each one</a>
<a id="4480" class="Comment">-- Compute the max of the widths, and pad the strings accordingly.</a>

<a id="rectangle"></a><a id="4548" href="Data.String.Base.html#4548" class="Function">rectangle</a> <a id="4558" class="Symbol">:</a> <a id="4560" class="Symbol">∀</a> <a id="4562" class="Symbol">{</a><a id="4563" href="Data.String.Base.html#4563" class="Bound">n</a><a id="4564" class="Symbol">}</a> <a id="4566" class="Symbol">→</a> <a id="4568" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4572" class="Symbol">(</a><a id="4573" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="4575" class="Symbol">→</a> <a id="4577" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="4584" class="Symbol">→</a> <a id="4586" href="Agda.Builtin.String.html#274" class="Postulate">String</a><a id="4592" class="Symbol">)</a> <a id="4594" href="Data.String.Base.html#4563" class="Bound">n</a> <a id="4596" class="Symbol">→</a>
            <a id="4610" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4614" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="4621" href="Data.String.Base.html#4563" class="Bound">n</a> <a id="4623" class="Symbol">→</a> <a id="4625" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4629" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="4636" href="Data.String.Base.html#4563" class="Bound">n</a>
<a id="4638" href="Data.String.Base.html#4548" class="Function">rectangle</a> <a id="4648" href="Data.String.Base.html#4648" class="Bound">pads</a> <a id="4653" href="Data.String.Base.html#4653" class="Bound">cells</a> <a id="4659" class="Symbol">=</a> <a id="4661" href="Data.Vec.Base.html#3379" class="Function">Vec.zipWith</a> <a id="4673" class="Symbol">(λ</a> <a id="4676" href="Data.String.Base.html#4676" class="Bound">p</a> <a id="4678" href="Data.String.Base.html#4678" class="Bound">c</a> <a id="4680" class="Symbol">→</a> <a id="4682" href="Data.String.Base.html#4676" class="Bound">p</a> <a id="4684" href="Data.String.Base.html#4758" class="Function">width</a> <a id="4690" href="Data.String.Base.html#4678" class="Bound">c</a><a id="4691" class="Symbol">)</a> <a id="4693" href="Data.String.Base.html#4648" class="Bound">pads</a> <a id="4698" href="Data.String.Base.html#4653" class="Bound">cells</a> <a id="4704" class="Keyword">where</a>

  <a id="4713" href="Data.String.Base.html#4713" class="Function">sizes</a> <a id="4719" class="Symbol">=</a> <a id="4721" href="Data.List.Base.html#1497" class="Function">List.map</a> <a id="4730" href="Data.String.Base.html#2141" class="Function">length</a> <a id="4737" class="Symbol">(</a><a id="4738" href="Data.Vec.Base.html#7399" class="Function">Vec.toList</a> <a id="4749" href="Data.String.Base.html#4653" class="Bound">cells</a><a id="4754" class="Symbol">)</a>
  <a id="4758" href="Data.String.Base.html#4758" class="Function">width</a> <a id="4764" class="Symbol">=</a> <a id="4766" href="Data.List.Extrema.html#1917" class="Function">max</a> <a id="4770" class="Number">0</a> <a id="4772" href="Data.String.Base.html#4713" class="Function">sizes</a>

<a id="4779" class="Comment">-- Special cases for left, center, and right alignment</a>

<a id="rectangleˡ"></a><a id="4835" href="Data.String.Base.html#4835" class="Function">rectangleˡ</a> <a id="4846" class="Symbol">:</a> <a id="4848" class="Symbol">∀</a> <a id="4850" class="Symbol">{</a><a id="4851" href="Data.String.Base.html#4851" class="Bound">n</a><a id="4852" class="Symbol">}</a> <a id="4854" class="Symbol">→</a> <a id="4856" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a> <a id="4861" class="Symbol">→</a> <a id="4863" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4867" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="4874" href="Data.String.Base.html#4851" class="Bound">n</a> <a id="4876" class="Symbol">→</a> <a id="4878" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4882" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="4889" href="Data.String.Base.html#4851" class="Bound">n</a>
<a id="4891" href="Data.String.Base.html#4835" class="Function">rectangleˡ</a> <a id="4902" href="Data.String.Base.html#4902" class="Bound">c</a> <a id="4904" class="Symbol">=</a> <a id="4906" href="Data.String.Base.html#4548" class="Function">rectangle</a> <a id="4916" class="Symbol">(</a><a id="4917" href="Data.Vec.Base.html#5745" class="Function">Vec.replicate</a> <a id="4931" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="4933" href="Data.String.Base.html#3478" class="Function">padLeft</a> <a id="4941" href="Data.String.Base.html#4902" class="Bound">c</a><a id="4942" class="Symbol">)</a>

<a id="rectangleʳ"></a><a id="4945" href="Data.String.Base.html#4945" class="Function">rectangleʳ</a> <a id="4956" class="Symbol">:</a> <a id="4958" class="Symbol">∀</a> <a id="4960" class="Symbol">{</a><a id="4961" href="Data.String.Base.html#4961" class="Bound">n</a><a id="4962" class="Symbol">}</a> <a id="4964" class="Symbol">→</a> <a id="4966" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a> <a id="4971" class="Symbol">→</a> <a id="4973" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4977" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="4984" href="Data.String.Base.html#4961" class="Bound">n</a> <a id="4986" class="Symbol">→</a> <a id="4988" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="4992" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="4999" href="Data.String.Base.html#4961" class="Bound">n</a>
<a id="5001" href="Data.String.Base.html#4945" class="Function">rectangleʳ</a> <a id="5012" href="Data.String.Base.html#5012" class="Bound">c</a> <a id="5014" class="Symbol">=</a> <a id="5016" href="Data.String.Base.html#4548" class="Function">rectangle</a> <a id="5026" class="Symbol">(</a><a id="5027" href="Data.Vec.Base.html#5745" class="Function">Vec.replicate</a> <a id="5041" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="5043" href="Data.String.Base.html#3597" class="Function">padRight</a> <a id="5052" href="Data.String.Base.html#5012" class="Bound">c</a><a id="5053" class="Symbol">)</a>

<a id="rectangleᶜ"></a><a id="5056" href="Data.String.Base.html#5056" class="Function">rectangleᶜ</a> <a id="5067" class="Symbol">:</a> <a id="5069" class="Symbol">∀</a> <a id="5071" class="Symbol">{</a><a id="5072" href="Data.String.Base.html#5072" class="Bound">n</a><a id="5073" class="Symbol">}</a> <a id="5075" class="Symbol">→</a> <a id="5077" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a> <a id="5082" class="Symbol">→</a> <a id="5084" href="Agda.Builtin.Char.html#227" class="Postulate">Char</a> <a id="5089" class="Symbol">→</a> <a id="5091" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="5095" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="5102" href="Data.String.Base.html#5072" class="Bound">n</a> <a id="5104" class="Symbol">→</a> <a id="5106" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="5110" href="Agda.Builtin.String.html#274" class="Postulate">String</a> <a id="5117" href="Data.String.Base.html#5072" class="Bound">n</a>
<a id="5119" href="Data.String.Base.html#5056" class="Function">rectangleᶜ</a> <a id="5130" href="Data.String.Base.html#5130" class="Bound">cₗ</a> <a id="5133" href="Data.String.Base.html#5133" class="Bound">cᵣ</a> <a id="5136" class="Symbol">=</a> <a id="5138" href="Data.String.Base.html#4548" class="Function">rectangle</a> <a id="5148" class="Symbol">(</a><a id="5149" href="Data.Vec.Base.html#5745" class="Function">Vec.replicate</a> <a id="5163" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="5165" href="Data.String.Base.html#3718" class="Function">padBoth</a> <a id="5173" href="Data.String.Base.html#5130" class="Bound">cₗ</a> <a id="5176" href="Data.String.Base.html#5133" class="Bound">cᵣ</a><a id="5178" class="Symbol">)</a>
</pre></body></html>