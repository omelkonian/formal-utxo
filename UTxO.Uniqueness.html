<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>UTxO.Uniqueness</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="UTxO.Uniqueness.html" class="Module">UTxO.Uniqueness</a> <a id="24" class="Keyword">where</a>

<a id="31" class="Keyword">open</a> <a id="36" class="Keyword">import</a> <a id="43" href="Data.List.Membership.Propositional.Properties.html" class="Module">Data.List.Membership.Propositional.Properties</a> <a id="89" class="Keyword">using</a> <a id="95" class="Symbol">(</a><a id="96" href="Data.List.Membership.Propositional.Properties.html#3429" class="Function">∈-map⁻</a><a id="102" class="Symbol">;</a> <a id="104" href="Data.List.Membership.Propositional.Properties.html#6447" class="Function">∈-filter⁻</a><a id="113" class="Symbol">)</a>
<a id="115" class="Keyword">open</a> <a id="120" class="Keyword">import</a> <a id="127" href="Data.List.Relation.Unary.Unique.Propositional.Properties.html" class="Module">Data.List.Relation.Unary.Unique.Propositional.Properties</a> <a id="184" class="Keyword">using</a> <a id="190" class="Symbol">(</a><a id="191" href="Data.List.Relation.Unary.Unique.Propositional.Properties.html#1580" class="Function">++⁺</a><a id="194" class="Symbol">;</a> <a id="196" href="Data.List.Relation.Unary.Unique.Propositional.Properties.html#3984" class="Function">filter⁺</a><a id="203" class="Symbol">)</a>
<a id="205" class="Keyword">import</a> <a id="212" href="Data.List.Relation.Unary.AllPairs.html" class="Module">Data.List.Relation.Unary.AllPairs</a> <a id="246" class="Symbol">as</a> <a id="249" class="Module">AllPairs</a>

<a id="259" class="Keyword">open</a> <a id="264" class="Keyword">import</a> <a id="271" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="284" class="Keyword">open</a> <a id="289" class="Keyword">import</a> <a id="296" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="310" class="Keyword">open</a> <a id="315" class="Keyword">import</a> <a id="322" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="336" class="Keyword">open</a> <a id="341" class="Keyword">import</a> <a id="348" href="Prelude.Set%2527.html" class="Module">Prelude.Set&#39;</a>

<a id="362" class="Keyword">open</a> <a id="367" class="Keyword">import</a> <a id="374" href="UTxO.Hashing.Base.html" class="Module">UTxO.Hashing.Base</a>
<a id="392" class="Keyword">open</a> <a id="397" class="Keyword">import</a> <a id="404" href="UTxO.Hashing.Types.html" class="Module">UTxO.Hashing.Types</a>
<a id="423" class="Keyword">open</a> <a id="428" class="Keyword">import</a> <a id="435" href="UTxO.Value.html" class="Module">UTxO.Value</a>
<a id="446" class="Keyword">open</a> <a id="451" class="Keyword">import</a> <a id="458" href="UTxO.Types.html" class="Module">UTxO.Types</a> <a id="469" class="Keyword">hiding</a> <a id="476" class="Symbol">(</a><a id="477" href="UTxO.Types.html#751" class="InductiveConstructor">I</a><a id="478" class="Symbol">)</a>
<a id="480" class="Keyword">open</a> <a id="485" class="Keyword">import</a> <a id="492" href="UTxO.TxUtilities.html" class="Module">UTxO.TxUtilities</a>
<a id="509" class="Keyword">open</a> <a id="514" class="Keyword">import</a> <a id="521" href="UTxO.Validity.html" class="Module">UTxO.Validity</a>

<a id="536" class="Keyword">postulate</a>
  <a id="genesis"></a><a id="548" href="UTxO.Uniqueness.html#548" class="Postulate">genesis</a> <a id="556" class="Symbol">:</a> <a id="558" class="Symbol">∀</a> <a id="560" class="Symbol">{</a><a id="561" href="UTxO.Uniqueness.html#561" class="Bound">l</a><a id="562" class="Symbol">}</a> <a id="564" class="Symbol">→</a> <a id="566" href="UTxO.Validity.html#2109" class="Datatype">ValidLedger</a> <a id="578" href="UTxO.Uniqueness.html#561" class="Bound">l</a> <a id="580" class="Symbol">→</a> <a id="582" href="Prelude.Lists.html#13946" class="Function">¬Null</a> <a id="588" href="UTxO.Uniqueness.html#561" class="Bound">l</a> <a id="590" class="Symbol">→</a> <a id="592" href="Prelude.Lists.html#16996" class="Function">count</a> <a id="598" class="Symbol">(</a><a id="599" href="Prelude.Lists.html#13989" class="Function">null?</a> <a id="605" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="607" href="UTxO.Types.html#7415" class="Field">inputs</a><a id="613" class="Symbol">)</a> <a id="615" href="UTxO.Uniqueness.html#561" class="Bound">l</a> <a id="617" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="619" class="Number">1</a>

<a id="Unique-ledger"></a><a id="622" href="UTxO.Uniqueness.html#622" class="Function">Unique-ledger</a> <a id="636" class="Symbol">:</a> <a id="638" class="Symbol">∀</a> <a id="640" class="Symbol">{</a><a id="641" href="UTxO.Uniqueness.html#641" class="Bound">l</a><a id="642" class="Symbol">}</a> <a id="644" class="Symbol">→</a> <a id="646" href="UTxO.Validity.html#2109" class="Datatype">ValidLedger</a> <a id="658" href="UTxO.Uniqueness.html#641" class="Bound">l</a> <a id="660" class="Symbol">→</a> <a id="662" href="Data.List.Relation.Unary.Unique.Setoid.html#869" class="Datatype">Unique</a> <a id="669" href="UTxO.Uniqueness.html#641" class="Bound">l</a>
<a id="671" href="UTxO.Uniqueness.html#622" class="Function">Unique-ledger</a> <a id="685" class="Symbol">{</a><a id="686" class="DottedPattern Symbol">.</a><a id="687" href="Agda.Builtin.List.html#185" class="DottedPattern InductiveConstructor">[]</a><a id="689" class="Symbol">}</a>     <a id="695" href="UTxO.Validity.html#2145" class="InductiveConstructor">∙</a>                    <a id="716" class="Symbol">=</a> <a id="718" href="Data.List.Relation.Unary.AllPairs.Core.html#986" class="InductiveConstructor">[]</a>
<a id="721" href="UTxO.Uniqueness.html#622" class="Function">Unique-ledger</a> <a id="735" class="Symbol">{</a><a id="736" class="DottedPattern Symbol">.</a><a id="737" href="UTxO.Uniqueness.html#755" class="DottedPattern Bound">tx</a> <a id="740" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="742" href="UTxO.Uniqueness.html#742" class="Bound">l</a><a id="743" class="Symbol">}</a> <a id="745" href="UTxO.Uniqueness.html#745" class="Bound">vl₀</a><a id="748" class="Symbol">@(</a><a id="750" href="UTxO.Uniqueness.html#750" class="Bound">vl</a> <a id="753" href="UTxO.Validity.html#2167" class="InductiveConstructor Operator">⊕</a> <a id="755" href="UTxO.Uniqueness.html#755" class="Bound">tx</a> <a id="758" href="UTxO.Validity.html#2167" class="InductiveConstructor Operator">∶-</a> <a id="761" href="UTxO.Uniqueness.html#761" class="Bound">vtx</a><a id="764" class="Symbol">)</a>
  <a id="768" class="Keyword">with</a> <a id="773" href="Prelude.Lists.html#13989" class="Function">null?</a> <a id="779" class="Symbol">(</a><a id="780" href="UTxO.Types.html#7415" class="Field">inputs</a> <a id="787" href="UTxO.Uniqueness.html#755" class="Bound">tx</a><a id="789" class="Symbol">)</a>
<a id="791" class="Symbol">...</a> <a id="795" class="Symbol">|</a> <a id="797" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="801" href="UTxO.Uniqueness.html#801" class="Bound">px</a>
    <a id="808" class="Symbol">=</a> <a id="810" href="Prelude.Lists.html#17079" class="Function">count-single</a> <a id="823" class="Symbol">{</a><a id="824" class="Argument">P?</a> <a id="827" class="Symbol">=</a> <a id="829" href="Prelude.Lists.html#13989" class="Function">null?</a> <a id="835" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="837" href="UTxO.Types.html#7415" class="Field">inputs</a><a id="843" class="Symbol">}</a> <a id="845" class="Symbol">(</a><a id="846" href="UTxO.Uniqueness.html#548" class="Postulate">genesis</a> <a id="854" class="Bound">vl₀</a> <a id="858" class="Symbol">λ</a> <a id="860" class="Symbol">())</a> <a id="864" href="UTxO.Uniqueness.html#801" class="Bound">px</a> <a id="867" href="Data.List.Relation.Unary.AllPairs.Core.html#1006" class="InductiveConstructor Operator">∷</a> <a id="869" href="UTxO.Uniqueness.html#622" class="Function">Unique-ledger</a> <a id="883" class="Bound">vl</a>
<a id="886" class="Symbol">...</a> <a id="890" class="Symbol">|</a> <a id="892" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a> <a id="895" href="UTxO.Uniqueness.html#895" class="Bound">¬px</a>
    <a id="903" class="Symbol">=</a> <a id="905" href="Data.List.Relation.Unary.All.Properties.html#3463" class="Function">L.All.¬Any⇒All¬</a> <a id="921" class="Bound">l</a> <a id="923" href="UTxO.Uniqueness.html#962" class="Function">tx∉</a> <a id="927" href="Data.List.Relation.Unary.AllPairs.Core.html#1006" class="InductiveConstructor Operator">∷</a> <a id="929" href="UTxO.Uniqueness.html#622" class="Function">Unique-ledger</a> <a id="943" class="Bound">vl</a>
    <a id="950" class="Keyword">where</a>
      <a id="962" href="UTxO.Uniqueness.html#962" class="Function">tx∉</a> <a id="966" class="Symbol">:</a> <a id="968" class="Bound">tx</a> <a id="971" href="Data.List.Membership.Setoid.html#931" class="Function Operator">∉</a> <a id="973" class="Bound">l</a>
      <a id="981" href="UTxO.Uniqueness.html#962" class="Function">tx∉</a> <a id="985" href="UTxO.Uniqueness.html#985" class="Bound">tx∈</a> <a id="989" class="Keyword">with</a> <a id="994" href="UTxO.Uniqueness.html#994" class="Bound">x</a> <a id="996" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="998" href="UTxO.Uniqueness.html#998" class="Bound">x∈</a>        ← <a id="1010" href="Prelude.Lists.html#16181" class="Function">¬Null⇒∃x</a> <a id="1019" class="Symbol">(</a><a id="1020" href="Prelude.Lists.html#14250" class="Function">map≢[]</a> <a id="1027" class="Symbol">{</a><a id="1028" class="Argument">f</a> <a id="1030" class="Symbol">=</a> <a id="1032" href="UTxO.Types.html#7268" class="Field">outputRef</a><a id="1041" class="Symbol">}</a> <a id="1043" href="UTxO.Uniqueness.html#895" class="Bound">¬px</a><a id="1046" class="Symbol">)</a>
              <a id="1062" class="Keyword">with</a> <a id="1067" href="UTxO.Uniqueness.html#1067" class="Bound">l′</a> <a id="1070" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1072" href="UTxO.Uniqueness.html#1072" class="Bound">suf</a>      ← <a id="1083" href="Prelude.Lists.html#20251" class="Function">∈⇒Suffix</a> <a id="1092" href="UTxO.Uniqueness.html#985" class="Bound">tx∈</a>
              <a id="1110" class="Keyword">with</a> <a id="1115" class="Symbol">_</a> <a id="1117" href="UTxO.Validity.html#2167" class="InductiveConstructor Operator">⊕</a> <a id="1119" class="Symbol">_</a> <a id="1121" href="UTxO.Validity.html#2167" class="InductiveConstructor Operator">∶-</a> <a id="1124" href="UTxO.Uniqueness.html#1124" class="Bound">vtx′</a> ← <a id="1131" href="UTxO.Validity.html#5116" class="Function">≼⇒valid</a> <a id="1139" class="Bound">vl</a> <a id="1142" href="UTxO.Uniqueness.html#1072" class="Bound">suf</a>
                 <a id="1163" class="Symbol">=</a> <a id="1165" href="UTxO.Validity.html#5584" class="Postulate">suf-utxo</a> <a id="1174" class="Bound">vl</a> <a id="1177" href="UTxO.Uniqueness.html#1072" class="Bound">suf</a> <a id="1181" class="Symbol">(</a><a id="1182" href="UTxO.Validity.html#1320" class="Field">validOutputRefs</a> <a id="1198" href="UTxO.Uniqueness.html#1124" class="Bound">vtx′</a> <a id="1203" href="UTxO.Uniqueness.html#998" class="Bound">x∈</a><a id="1205" class="Symbol">)</a> <a id="1207" href="UTxO.Uniqueness.html#998" class="Bound">x∈</a> <a id="1210" class="Symbol">(</a><a id="1211" href="UTxO.Validity.html#1320" class="Field">validOutputRefs</a> <a id="1227" class="Bound">vtx</a> <a id="1231" href="UTxO.Uniqueness.html#998" class="Bound">x∈</a><a id="1233" class="Symbol">)</a>

<a id="u∈mkUtxo"></a><a id="1236" href="UTxO.Uniqueness.html#1236" class="Function">u∈mkUtxo</a> <a id="1245" class="Symbol">:</a> <a id="1247" class="Symbol">∀</a> <a id="1249" class="Symbol">{</a><a id="1250" href="UTxO.Uniqueness.html#1250" class="Bound">u</a> <a id="1252" href="UTxO.Uniqueness.html#1252" class="Bound">tx</a><a id="1254" class="Symbol">}</a>
  <a id="1258" class="Symbol">→</a> <a id="1260" href="UTxO.Uniqueness.html#1250" class="Bound">u</a> <a id="1262" href="Data.List.Membership.Setoid.html#882" class="Function Operator">∈</a> <a id="1264" href="Data.List.Membership.Setoid.html#1123" class="Function">mapWith∈</a> <a id="1273" class="Symbol">(</a><a id="1274" href="UTxO.Types.html#7520" class="Field">outputs</a> <a id="1282" href="UTxO.Uniqueness.html#1252" class="Bound">tx</a><a id="1284" class="Symbol">)</a> <a id="1286" class="Symbol">(</a><a id="1287" href="UTxO.TxUtilities.html#555" class="Function">mkUtxo</a> <a id="1294" href="UTxO.Uniqueness.html#1252" class="Bound">tx</a><a id="1296" class="Symbol">)</a>
  <a id="1300" class="Symbol">→</a> <a id="1302" href="UTxO.TxUtilities.html#522" class="Field">prevTx</a> <a id="1309" href="UTxO.Uniqueness.html#1250" class="Bound">u</a> <a id="1311" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1313" href="UTxO.Uniqueness.html#1252" class="Bound">tx</a>
<a id="1316" href="UTxO.Uniqueness.html#1236" class="Function">u∈mkUtxo</a> <a id="1325" class="Symbol">{</a><a id="1326" class="Argument">tx</a> <a id="1329" class="Symbol">=</a> <a id="1331" href="UTxO.Uniqueness.html#1331" class="Bound">tx</a><a id="1333" class="Symbol">}</a> <a id="1335" class="Symbol">=</a> <a id="1337" href="Prelude.Lists.html#11230" class="Function">mapWith∈-∀</a> <a id="1348" class="Symbol">{</a><a id="1349" class="Argument">P</a> <a id="1351" class="Symbol">=</a> <a id="1353" class="Symbol">(</a><a id="1354" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡</a> <a id="1357" href="UTxO.Uniqueness.html#1331" class="Bound">tx</a><a id="1359" class="Symbol">)</a> <a id="1361" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1363" href="UTxO.TxUtilities.html#522" class="Field">prevTx</a><a id="1369" class="Symbol">}</a> <a id="1371" class="Symbol">λ</a> <a id="1373" href="UTxO.Uniqueness.html#1373" class="Bound">_</a> <a id="1375" class="Symbol">→</a> <a id="1377" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="Unique-utxo"></a><a id="1383" href="UTxO.Uniqueness.html#1383" class="Function">Unique-utxo</a> <a id="1395" class="Symbol">:</a> <a id="1397" class="Symbol">∀</a> <a id="1399" class="Symbol">{</a><a id="1400" href="UTxO.Uniqueness.html#1400" class="Bound">l</a><a id="1401" class="Symbol">}</a>
  <a id="1405" class="Symbol">→</a> <a id="1407" href="UTxO.Validity.html#2109" class="Datatype">ValidLedger</a> <a id="1419" href="UTxO.Uniqueness.html#1400" class="Bound">l</a>
  <a id="1423" class="Symbol">→</a> <a id="1425" href="Data.List.Relation.Unary.Unique.Setoid.html#869" class="Datatype">Unique</a> <a id="1432" class="Symbol">(</a><a id="1433" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="1438" href="UTxO.Uniqueness.html#1400" class="Bound">l</a><a id="1439" class="Symbol">)</a>
<a id="1441" href="UTxO.Uniqueness.html#1383" class="Function">Unique-utxo</a> <a id="1453" class="Symbol">{</a><a id="1454" class="Argument">l</a> <a id="1456" class="Symbol">=</a> <a id="1458" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1460" class="Symbol">}</a>     <a id="1466" href="UTxO.Validity.html#2145" class="InductiveConstructor">∙</a>                     <a id="1488" class="Symbol">=</a> <a id="1490" href="Data.List.Relation.Unary.AllPairs.Core.html#986" class="InductiveConstructor">[]</a>
<a id="1493" href="UTxO.Uniqueness.html#1383" class="Function">Unique-utxo</a> <a id="1505" class="Symbol">{</a><a id="1506" class="Argument">l</a> <a id="1508" class="Symbol">=</a> <a id="1510" href="UTxO.Uniqueness.html#1510" class="Bound">tx</a> <a id="1513" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1515" href="UTxO.Uniqueness.html#1515" class="Bound">l</a><a id="1516" class="Symbol">}</a> <a id="1518" href="UTxO.Uniqueness.html#1518" class="Bound">vl₀</a><a id="1521" class="Symbol">@(</a><a id="1523" href="UTxO.Uniqueness.html#1523" class="Bound">vl</a> <a id="1526" href="UTxO.Validity.html#2167" class="InductiveConstructor Operator">⊕</a> <a id="1528" class="DottedPattern Symbol">.</a><a id="1529" href="UTxO.Uniqueness.html#1510" class="DottedPattern Bound">tx</a> <a id="1532" href="UTxO.Validity.html#2167" class="InductiveConstructor Operator">∶-</a> <a id="1535" href="UTxO.Uniqueness.html#1535" class="Bound">vtx</a><a id="1538" class="Symbol">)</a> <a id="1540" class="Symbol">=</a> <a id="1542" href="Data.List.Relation.Unary.Unique.Propositional.Properties.html#1580" class="Function">++⁺</a> <a id="1546" href="UTxO.Uniqueness.html#1675" class="Function">uniqˡ</a> <a id="1552" href="UTxO.Uniqueness.html#1766" class="Function">uniqʳ</a> <a id="1558" href="UTxO.Uniqueness.html#2036" class="Function">disj</a>
  <a id="1565" class="Keyword">where</a>
    <a id="1575" href="UTxO.Uniqueness.html#1575" class="Function">lˡ</a> <a id="1578" class="Symbol">=</a> <a id="1580" href="Data.List.Base.html#7436" class="Function">filter</a> <a id="1587" class="Symbol">((</a><a id="1589" href="Prelude.DecEq.html#2182" class="Function Operator">_∉?</a> <a id="1593" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="1604" href="UTxO.Uniqueness.html#1510" class="Bound">tx</a><a id="1606" class="Symbol">)</a> <a id="1608" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1610" href="UTxO.TxUtilities.html#471" class="Field">outRef</a><a id="1616" class="Symbol">)</a> <a id="1618" class="Symbol">(</a><a id="1619" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="1624" href="UTxO.Uniqueness.html#1515" class="Bound">l</a><a id="1625" class="Symbol">)</a>
    <a id="1631" href="UTxO.Uniqueness.html#1631" class="Function">lʳ</a> <a id="1634" class="Symbol">=</a> <a id="1636" href="Data.List.Membership.Setoid.html#1123" class="Function">mapWith∈</a> <a id="1645" class="Symbol">(</a><a id="1646" href="UTxO.Types.html#7520" class="Field">outputs</a> <a id="1654" href="UTxO.Uniqueness.html#1510" class="Bound">tx</a><a id="1656" class="Symbol">)</a> <a id="1658" class="Symbol">(</a><a id="1659" href="UTxO.TxUtilities.html#555" class="Function">mkUtxo</a> <a id="1666" href="UTxO.Uniqueness.html#1510" class="Bound">tx</a><a id="1668" class="Symbol">)</a>

    <a id="1675" href="UTxO.Uniqueness.html#1675" class="Function">uniqˡ</a> <a id="1681" class="Symbol">:</a> <a id="1683" href="Data.List.Relation.Unary.Unique.Setoid.html#869" class="Datatype">Unique</a> <a id="1690" href="UTxO.Uniqueness.html#1575" class="Function">lˡ</a>
    <a id="1697" href="UTxO.Uniqueness.html#1675" class="Function">uniqˡ</a> <a id="1703" class="Symbol">=</a> <a id="1705" href="Data.List.Relation.Unary.Unique.Propositional.Properties.html#3984" class="Function">filter⁺</a> <a id="1713" class="Symbol">((</a><a id="1715" href="Prelude.DecEq.html#2182" class="Function Operator">_∉?</a> <a id="1719" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="1730" href="UTxO.Uniqueness.html#1510" class="Bound">tx</a><a id="1732" class="Symbol">)</a> <a id="1734" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1736" href="UTxO.TxUtilities.html#471" class="Field">outRef</a><a id="1742" class="Symbol">)</a> <a id="1744" class="Symbol">(</a><a id="1745" href="UTxO.Uniqueness.html#1383" class="Function">Unique-utxo</a> <a id="1757" href="UTxO.Uniqueness.html#1523" class="Bound">vl</a><a id="1759" class="Symbol">)</a>

    <a id="1766" href="UTxO.Uniqueness.html#1766" class="Function">uniqʳ</a> <a id="1772" class="Symbol">:</a> <a id="1774" href="Data.List.Relation.Unary.Unique.Setoid.html#869" class="Datatype">Unique</a> <a id="1781" href="UTxO.Uniqueness.html#1631" class="Function">lʳ</a>
    <a id="1788" href="UTxO.Uniqueness.html#1766" class="Function">uniqʳ</a> <a id="1794" class="Symbol">=</a> <a id="1796" href="Prelude.Lists.html#13466" class="Function">Unique-mapWith∈</a> <a id="1812" href="UTxO.Uniqueness.html#1834" class="Function">h</a>
      <a id="1820" class="Keyword">where</a>
        <a id="1834" href="UTxO.Uniqueness.html#1834" class="Function">h</a> <a id="1836" class="Symbol">:</a> <a id="1838" class="Symbol">∀</a> <a id="1840" class="Symbol">{</a><a id="1841" href="UTxO.Uniqueness.html#1841" class="Bound">x</a> <a id="1843" href="UTxO.Uniqueness.html#1843" class="Bound">x′</a><a id="1845" class="Symbol">}</a> <a id="1847" class="Symbol">{</a><a id="1848" href="UTxO.Uniqueness.html#1848" class="Bound">x∈</a> <a id="1851" class="Symbol">:</a> <a id="1853" href="UTxO.Uniqueness.html#1841" class="Bound">x</a> <a id="1855" href="Data.List.Membership.Setoid.html#882" class="Function Operator">∈</a> <a id="1857" href="UTxO.Types.html#7520" class="Field">outputs</a> <a id="1865" href="UTxO.Uniqueness.html#1510" class="Bound">tx</a><a id="1867" class="Symbol">}</a> <a id="1869" class="Symbol">{</a><a id="1870" href="UTxO.Uniqueness.html#1870" class="Bound">x∈′</a> <a id="1874" class="Symbol">:</a> <a id="1876" href="UTxO.Uniqueness.html#1843" class="Bound">x′</a> <a id="1879" href="Data.List.Membership.Setoid.html#882" class="Function Operator">∈</a> <a id="1881" href="UTxO.Types.html#7520" class="Field">outputs</a> <a id="1889" href="UTxO.Uniqueness.html#1510" class="Bound">tx</a><a id="1891" class="Symbol">}</a>
          <a id="1903" class="Symbol">→</a> <a id="1905" href="UTxO.TxUtilities.html#555" class="Function">mkUtxo</a> <a id="1912" href="UTxO.Uniqueness.html#1510" class="Bound">tx</a> <a id="1915" href="UTxO.Uniqueness.html#1848" class="Bound">x∈</a> <a id="1918" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1920" href="UTxO.TxUtilities.html#555" class="Function">mkUtxo</a> <a id="1927" href="UTxO.Uniqueness.html#1510" class="Bound">tx</a> <a id="1930" href="UTxO.Uniqueness.html#1870" class="Bound">x∈′</a>
          <a id="1944" class="Symbol">→</a> <a id="1946" href="Data.List.Relation.Unary.Any.html#1909" class="Function">L.Any.index</a> <a id="1958" href="UTxO.Uniqueness.html#1848" class="Bound">x∈</a> <a id="1961" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1963" href="Data.List.Relation.Unary.Any.html#1909" class="Function">L.Any.index</a> <a id="1975" href="UTxO.Uniqueness.html#1870" class="Bound">x∈′</a>
        <a id="1987" href="UTxO.Uniqueness.html#1834" class="Function">h</a> <a id="1989" class="Symbol">=</a> <a id="1991" href="Data.Fin.Properties.html#3140" class="Function">F.toℕ-injective</a> <a id="2007" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2009" href="Relation.Binary.PropositionalEquality.Core.html#1131" class="Function">cong</a> <a id="2014" class="Symbol">(</a><a id="2015" href="UTxO.Types.html#4146" class="Field">index</a> <a id="2021" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2023" href="UTxO.TxUtilities.html#471" class="Field">outRef</a><a id="2029" class="Symbol">)</a>

    <a id="2036" href="UTxO.Uniqueness.html#2036" class="Function">disj</a> <a id="2041" class="Symbol">:</a> <a id="2043" href="Data.List.Relation.Binary.Disjoint.Setoid.html#837" class="Function">Disjoint</a> <a id="2052" href="UTxO.Uniqueness.html#1575" class="Function">lˡ</a> <a id="2055" href="UTxO.Uniqueness.html#1631" class="Function">lʳ</a>
    <a id="2062" href="UTxO.Uniqueness.html#2036" class="Function">disj</a> <a id="2067" class="Symbol">(</a><a id="2068" href="UTxO.Uniqueness.html#2068" class="Bound">x∈ˡ</a> <a id="2072" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2074" href="UTxO.Uniqueness.html#2074" class="Bound">x∈ʳ</a><a id="2077" class="Symbol">)</a>
      <a id="2085" class="Keyword">with</a> <a id="2090" href="Data.List.Membership.Propositional.Properties.html#6447" class="Function">∈-filter⁻</a> <a id="2100" class="Symbol">((</a><a id="2102" href="Prelude.DecEq.html#2182" class="Function Operator">_∉?</a> <a id="2106" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="2117" href="UTxO.Uniqueness.html#1510" class="Bound">tx</a><a id="2119" class="Symbol">)</a> <a id="2121" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2123" href="UTxO.TxUtilities.html#471" class="Field">outRef</a><a id="2129" class="Symbol">)</a> <a id="2131" class="Symbol">{</a><a id="2132" class="Argument">xs</a> <a id="2135" class="Symbol">=</a> <a id="2137" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="2142" href="UTxO.Uniqueness.html#1515" class="Bound">l</a><a id="2143" class="Symbol">}</a> <a id="2145" href="UTxO.Uniqueness.html#2068" class="Bound">x∈ˡ</a>
    <a id="2153" class="Symbol">...</a> <a id="2157" class="Symbol">|</a> <a id="2159" href="UTxO.Uniqueness.html#2159" class="Bound">x∈ˡ′</a> <a id="2164" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2166" class="Symbol">_</a>
      <a id="2174" class="Keyword">with</a> <a id="2179" href="UTxO.TxUtilities.html#2015" class="Function">∈utxo⇒outRef≡</a> <a id="2193" class="Symbol">{</a><a id="2194" class="Argument">l</a> <a id="2196" class="Symbol">=</a> <a id="2198" href="UTxO.Uniqueness.html#1515" class="Bound">l</a><a id="2199" class="Symbol">}</a> <a id="2201" href="UTxO.Uniqueness.html#2159" class="Bound">x∈ˡ′</a>
    <a id="2210" class="Symbol">...</a> <a id="2214" class="Symbol">|</a> <a id="2216" href="UTxO.Uniqueness.html#2216" class="Bound">x∈ˡ″</a> <a id="2221" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2223" class="Symbol">_</a>
      <a id="2231" class="Keyword">rewrite</a> <a id="2239" href="UTxO.Uniqueness.html#1236" class="Function">u∈mkUtxo</a> <a id="2248" class="Bound">x∈ʳ</a>
      <a id="2258" class="Keyword">with</a> <a id="2263" href="Data.List.Relation.Unary.AllPairs.html#1278" class="Function">AllPairs.head</a> <a id="2277" class="Symbol">(</a><a id="2278" href="UTxO.Uniqueness.html#622" class="Function">Unique-ledger</a> <a id="2292" href="UTxO.Uniqueness.html#1518" class="Bound">vl₀</a><a id="2295" class="Symbol">)</a>
    <a id="2301" class="Symbol">...</a> <a id="2305" class="Symbol">|</a> <a id="2307" href="UTxO.Uniqueness.html#2307" class="Bound">all≢tx</a>
        <a id="2322" class="Symbol">=</a> <a id="2324" href="Data.List.Relation.Unary.All.html#5949" class="Function">L.All.lookup</a> <a id="2337" href="UTxO.Uniqueness.html#2307" class="Bound">all≢tx</a> <a id="2344" class="Bound">x∈ˡ″</a> <a id="2349" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre></body></html>