<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Prelude.Lists.Combinatorics</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-utxo/tree/master/'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Combinatorics on lists.</a>

<a id="102" class="Symbol">{-#</a> <a id="106" class="Keyword">OPTIONS</a> <a id="114" class="Pragma">--safe</a> <a id="121" class="Symbol">#-}</a>
<a id="125" class="Keyword">module</a> <a id="132" href="Prelude.Lists.Combinatorics.html" class="Module">Prelude.Lists.Combinatorics</a> <a id="160" class="Keyword">where</a>

<a id="167" class="Keyword">open</a> <a id="172" class="Keyword">import</a> <a id="179" href="Prelude.Init.html" class="Module">Prelude.Init</a><a id="191" class="Symbol">;</a> <a id="193" class="Keyword">open</a> <a id="198" href="Prelude.Init.html#504" class="Module">SetAsType</a>
<a id="208" class="Keyword">open</a> <a id="213" href="Prelude.Init.html#7133" class="Module">L.Mem</a>
<a id="219" class="Keyword">open</a> <a id="224" class="Keyword">import</a> <a id="231" href="Prelude.Bifunctor.html" class="Module">Prelude.Bifunctor</a>

<a id="250" class="Keyword">private</a> <a id="258" class="Keyword">variable</a>
  <a id="269" href="Prelude.Lists.Combinatorics.html#269" class="Generalizable">A</a> <a id="271" href="Prelude.Lists.Combinatorics.html#271" class="Generalizable">B</a> <a id="273" class="Symbol">:</a> <a id="275" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="280" href="Prelude.Init.html#261" class="Generalizable">ℓ</a>
  <a id="284" href="Prelude.Lists.Combinatorics.html#284" class="Generalizable">x</a> <a id="286" class="Symbol">:</a> <a id="288" href="Prelude.Lists.Combinatorics.html#269" class="Generalizable">A</a><a id="289" class="Symbol">;</a> <a id="291" href="Prelude.Lists.Combinatorics.html#291" class="Generalizable">xs</a> <a id="294" class="Symbol">:</a> <a id="296" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="301" href="Prelude.Lists.Combinatorics.html#269" class="Generalizable">A</a>
  <a id="305" href="Prelude.Lists.Combinatorics.html#305" class="Generalizable">y</a> <a id="307" class="Symbol">:</a> <a id="309" href="Prelude.Lists.Combinatorics.html#271" class="Generalizable">B</a><a id="310" class="Symbol">;</a> <a id="312" href="Prelude.Lists.Combinatorics.html#312" class="Generalizable">ys</a> <a id="315" class="Symbol">:</a> <a id="317" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="322" href="Prelude.Lists.Combinatorics.html#271" class="Generalizable">B</a>

<a id="325" class="Comment">-- ** Adjacent pairs.</a>
<a id="pairs"></a><a id="347" href="Prelude.Lists.Combinatorics.html#347" class="Function">pairs</a> <a id="353" class="Symbol">:</a> <a id="355" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="360" href="Prelude.Lists.Combinatorics.html#269" class="Generalizable">A</a> <a id="362" class="Symbol">→</a> <a id="364" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="369" class="Symbol">(</a><a id="370" href="Prelude.Lists.Combinatorics.html#269" class="Generalizable">A</a> <a id="372" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="374" href="Prelude.Lists.Combinatorics.html#269" class="Generalizable">A</a><a id="375" class="Symbol">)</a>
<a id="377" href="Prelude.Lists.Combinatorics.html#347" class="Function">pairs</a> <a id="383" class="Symbol">=</a> <a id="385" class="Symbol">λ</a> <a id="387" class="Keyword">where</a>
  <a id="395" class="Symbol">(</a><a id="396" href="Prelude.Lists.Combinatorics.html#396" class="Bound">x</a> <a id="398" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="400" href="Prelude.Lists.Combinatorics.html#400" class="Bound">y</a> <a id="402" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="404" href="Prelude.Lists.Combinatorics.html#404" class="Bound">xs</a><a id="406" class="Symbol">)</a> <a id="408" class="Symbol">→</a> <a id="410" class="Symbol">(</a><a id="411" href="Prelude.Lists.Combinatorics.html#396" class="Bound">x</a> <a id="413" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="415" href="Prelude.Lists.Combinatorics.html#400" class="Bound">y</a><a id="416" class="Symbol">)</a> <a id="418" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="420" href="Prelude.Lists.Combinatorics.html#347" class="Function">pairs</a> <a id="426" class="Symbol">(</a><a id="427" href="Prelude.Lists.Combinatorics.html#400" class="Bound">y</a> <a id="429" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="431" href="Prelude.Lists.Combinatorics.html#404" class="Bound">xs</a><a id="433" class="Symbol">)</a>
  <a id="437" class="CatchallClause Symbol">_</a>            <a id="450" class="Symbol">→</a> <a id="452" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>

<a id="∈-pairs⁻"></a><a id="456" href="Prelude.Lists.Combinatorics.html#456" class="Function">∈-pairs⁻</a> <a id="465" class="Symbol">:</a> <a id="467" class="Symbol">∀</a> <a id="469" class="Symbol">{</a><a id="470" href="Prelude.Lists.Combinatorics.html#470" class="Bound">x</a> <a id="472" href="Prelude.Lists.Combinatorics.html#472" class="Bound">y</a> <a id="474" class="Symbol">:</a> <a id="476" href="Prelude.Lists.Combinatorics.html#269" class="Generalizable">A</a><a id="477" class="Symbol">}</a> <a id="479" class="Symbol">→</a> <a id="481" class="Symbol">(</a><a id="482" href="Prelude.Lists.Combinatorics.html#470" class="Bound">x</a> <a id="484" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="486" href="Prelude.Lists.Combinatorics.html#472" class="Bound">y</a><a id="487" class="Symbol">)</a> <a id="489" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="491" href="Prelude.Lists.Combinatorics.html#347" class="Function">pairs</a> <a id="497" href="Prelude.Lists.Combinatorics.html#291" class="Generalizable">xs</a> <a id="500" class="Symbol">→</a> <a id="502" class="Symbol">(</a><a id="503" href="Prelude.Lists.Combinatorics.html#470" class="Bound">x</a> <a id="505" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="507" href="Prelude.Lists.Combinatorics.html#291" class="Generalizable">xs</a><a id="509" class="Symbol">)</a> <a id="511" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="513" class="Symbol">(</a><a id="514" href="Prelude.Lists.Combinatorics.html#472" class="Bound">y</a> <a id="516" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="518" href="Prelude.Lists.Combinatorics.html#291" class="Generalizable">xs</a><a id="520" class="Symbol">)</a>
<a id="522" href="Prelude.Lists.Combinatorics.html#456" class="Function">∈-pairs⁻</a> <a id="531" class="Symbol">{</a><a id="532" class="Argument">xs</a> <a id="535" class="Symbol">=</a> <a id="537" class="Symbol">_</a> <a id="539" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="541" class="Symbol">_</a> <a id="543" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="545" class="Symbol">_}</a> <a id="548" class="Symbol">=</a> <a id="550" class="Symbol">λ</a> <a id="552" class="Keyword">where</a>
  <a id="560" class="Symbol">(</a><a id="561" href="Data.List.Relation.Unary.Any.html#1228" class="InductiveConstructor">here</a> <a id="566" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="570" class="Symbol">)</a> <a id="572" class="Symbol">→</a> <a id="574" href="Data.List.Relation.Unary.Any.html#1228" class="InductiveConstructor">here</a> <a id="579" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="584" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="586" href="Data.List.Relation.Unary.Any.html#1281" class="InductiveConstructor">there</a> <a id="592" class="Symbol">(</a><a id="593" href="Data.List.Relation.Unary.Any.html#1228" class="InductiveConstructor">here</a> <a id="598" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="602" class="Symbol">)</a>
  <a id="606" class="Symbol">(</a><a id="607" href="Data.List.Relation.Unary.Any.html#1281" class="InductiveConstructor">there</a> <a id="613" href="Prelude.Lists.Combinatorics.html#613" class="Bound">x∈</a><a id="615" class="Symbol">)</a>  <a id="618" class="Symbol">→</a> <a id="620" href="Prelude.Bifunctor.html#930" class="Function">map₁</a> <a id="625" href="Data.List.Relation.Unary.Any.html#1281" class="InductiveConstructor">there</a> <a id="631" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="633" href="Prelude.Bifunctor.html#1037" class="Function">map₂</a> <a id="638" href="Data.List.Relation.Unary.Any.html#1281" class="InductiveConstructor">there</a> <a id="644" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="646" href="Prelude.Lists.Combinatorics.html#456" class="Function">∈-pairs⁻</a> <a id="655" href="Prelude.Lists.Combinatorics.html#613" class="Bound">x∈</a>

<a id="659" class="Comment">-- e.g. subsequences &quot;abc&quot; ≡ [&quot;&quot;,&quot;c&quot;,&quot;b&quot;,&quot;bc&quot;,&quot;a&quot;,&quot;ab&quot;,&quot;ac&quot;,&quot;abc&quot;]</a>
<a id="subsequences"></a><a id="726" href="Prelude.Lists.Combinatorics.html#726" class="Function">subsequences</a> <a id="739" class="Symbol">:</a> <a id="741" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="746" href="Prelude.Lists.Combinatorics.html#269" class="Generalizable">A</a> <a id="748" class="Symbol">→</a> <a id="750" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="755" class="Symbol">(</a><a id="756" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="761" href="Prelude.Lists.Combinatorics.html#269" class="Generalizable">A</a><a id="762" class="Symbol">)</a>
<a id="764" href="Prelude.Lists.Combinatorics.html#726" class="Function">subsequences</a> <a id="777" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>       <a id="786" class="Symbol">=</a> <a id="788" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="790" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="793" href="Data.List.Base.html#5034" class="Function Operator">]</a>
<a id="795" href="Prelude.Lists.Combinatorics.html#726" class="Function">subsequences</a> <a id="808" class="Symbol">(</a><a id="809" href="Prelude.Lists.Combinatorics.html#809" class="Bound">x</a> <a id="811" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="813" href="Prelude.Lists.Combinatorics.html#813" class="Bound">xs</a><a id="815" class="Symbol">)</a> <a id="817" class="Symbol">=</a> <a id="819" href="Prelude.Lists.Combinatorics.html#849" class="Function">xss</a> <a id="823" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="826" href="Data.List.Base.html#1553" class="Function">map</a> <a id="830" class="Symbol">(</a><a id="831" href="Prelude.Lists.Combinatorics.html#809" class="Bound">x</a> <a id="833" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷_</a><a id="835" class="Symbol">)</a> <a id="837" href="Prelude.Lists.Combinatorics.html#849" class="Function">xss</a>
  <a id="843" class="Keyword">where</a> <a id="849" href="Prelude.Lists.Combinatorics.html#849" class="Function">xss</a> <a id="853" class="Symbol">=</a> <a id="855" href="Prelude.Lists.Combinatorics.html#726" class="Function">subsequences</a> <a id="868" href="Prelude.Lists.Combinatorics.html#813" class="Bound">xs</a>

<a id="subsequences-refl"></a><a id="872" href="Prelude.Lists.Combinatorics.html#872" class="Function">subsequences-refl</a> <a id="890" class="Symbol">:</a> <a id="892" href="Prelude.Lists.Combinatorics.html#291" class="Generalizable">xs</a> <a id="895" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="897" href="Prelude.Lists.Combinatorics.html#726" class="Function">subsequences</a> <a id="910" href="Prelude.Lists.Combinatorics.html#291" class="Generalizable">xs</a>
<a id="913" href="Prelude.Lists.Combinatorics.html#872" class="Function">subsequences-refl</a> <a id="931" class="Symbol">{</a><a id="932" class="Argument">xs</a> <a id="935" class="Symbol">=</a> <a id="937" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="939" class="Symbol">}</a>     <a id="945" class="Symbol">=</a> <a id="947" href="Data.List.Relation.Unary.Any.html#1228" class="InductiveConstructor">here</a> <a id="952" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
<a id="957" href="Prelude.Lists.Combinatorics.html#872" class="Function">subsequences-refl</a> <a id="975" class="Symbol">{</a><a id="976" class="Argument">xs</a> <a id="979" class="Symbol">=</a> <a id="981" href="Prelude.Lists.Combinatorics.html#981" class="Bound">x</a> <a id="983" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="985" href="Prelude.Lists.Combinatorics.html#985" class="Bound">xs</a><a id="987" class="Symbol">}</a> <a id="989" class="Symbol">=</a> <a id="991" href="Data.List.Membership.Propositional.Properties.html#4054" class="Function">∈-++⁺ʳ</a> <a id="998" class="Symbol">(</a><a id="999" href="Prelude.Lists.Combinatorics.html#726" class="Function">subsequences</a> <a id="1012" href="Prelude.Lists.Combinatorics.html#985" class="Bound">xs</a><a id="1014" class="Symbol">)</a> <a id="1016" class="Symbol">(</a><a id="1017" href="Data.List.Membership.Propositional.Properties.html#3377" class="Function">∈-map⁺</a> <a id="1024" class="Symbol">(</a><a id="1025" href="Prelude.Lists.Combinatorics.html#981" class="Bound">x</a> <a id="1027" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷_</a><a id="1029" class="Symbol">)</a> <a id="1031" class="Symbol">(</a><a id="1032" href="Prelude.Lists.Combinatorics.html#872" class="Function">subsequences-refl</a> <a id="1050" class="Symbol">{</a><a id="1051" class="Argument">xs</a> <a id="1054" class="Symbol">=</a> <a id="1056" href="Prelude.Lists.Combinatorics.html#985" class="Bound">xs</a><a id="1058" class="Symbol">}))</a>

<a id="1063" class="Comment">-- e.g. combinations [[1,2,3],[4,5]] ≡ [[1,4],[1,5],[2,4],[2,5],[3,4],[3,5]]</a>
<a id="combinations"></a><a id="1140" href="Prelude.Lists.Combinatorics.html#1140" class="Function">combinations</a> <a id="1153" class="Symbol">:</a> <a id="1155" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1160" class="Symbol">(</a><a id="1161" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1166" href="Prelude.Lists.Combinatorics.html#269" class="Generalizable">A</a><a id="1167" class="Symbol">)</a> <a id="1169" class="Symbol">→</a> <a id="1171" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1176" class="Symbol">(</a><a id="1177" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1182" href="Prelude.Lists.Combinatorics.html#269" class="Generalizable">A</a><a id="1183" class="Symbol">)</a>
<a id="1185" href="Prelude.Lists.Combinatorics.html#1140" class="Function">combinations</a> <a id="1198" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>         <a id="1209" class="Symbol">=</a> <a id="1211" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="1213" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="1216" href="Data.List.Base.html#5034" class="Function Operator">]</a>
<a id="1218" href="Prelude.Lists.Combinatorics.html#1140" class="Function">combinations</a> <a id="1231" class="Symbol">(</a><a id="1232" href="Prelude.Lists.Combinatorics.html#1232" class="Bound">xs</a> <a id="1235" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1237" href="Prelude.Lists.Combinatorics.html#1237" class="Bound">xss</a><a id="1240" class="Symbol">)</a> <a id="1242" class="Symbol">=</a> <a id="1244" href="Data.List.Base.html#4459" class="Function">concatMap</a> <a id="1254" class="Symbol">(λ</a> <a id="1257" href="Prelude.Lists.Combinatorics.html#1257" class="Bound">x</a> <a id="1259" class="Symbol">→</a> <a id="1261" href="Data.List.Base.html#1553" class="Function">map</a> <a id="1265" class="Symbol">(</a><a id="1266" href="Prelude.Lists.Combinatorics.html#1257" class="Bound">x</a> <a id="1268" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷_</a><a id="1270" class="Symbol">)</a> <a id="1272" href="Prelude.Lists.Combinatorics.html#1289" class="Function">xss′</a><a id="1276" class="Symbol">)</a> <a id="1278" href="Prelude.Lists.Combinatorics.html#1232" class="Bound">xs</a>
  <a id="1283" class="Keyword">where</a> <a id="1289" href="Prelude.Lists.Combinatorics.html#1289" class="Function">xss′</a> <a id="1294" class="Symbol">=</a> <a id="1296" href="Prelude.Lists.Combinatorics.html#1140" class="Function">combinations</a> <a id="1309" href="Prelude.Lists.Combinatorics.html#1237" class="Bound">xss</a>

<a id="cartesianProduct"></a><a id="1314" href="Prelude.Lists.Combinatorics.html#1314" class="Function">cartesianProduct</a> <a id="1331" class="Symbol">:</a> <a id="1333" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1338" href="Prelude.Lists.Combinatorics.html#269" class="Generalizable">A</a> <a id="1340" class="Symbol">→</a> <a id="1342" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1347" href="Prelude.Lists.Combinatorics.html#271" class="Generalizable">B</a> <a id="1349" class="Symbol">→</a> <a id="1351" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1356" class="Symbol">(</a><a id="1357" href="Prelude.Lists.Combinatorics.html#269" class="Generalizable">A</a> <a id="1359" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1361" href="Prelude.Lists.Combinatorics.html#271" class="Generalizable">B</a><a id="1362" class="Symbol">)</a>
<a id="1364" href="Prelude.Lists.Combinatorics.html#1314" class="Function">cartesianProduct</a> <a id="1381" href="Prelude.Lists.Combinatorics.html#1381" class="Bound">xs</a> <a id="1384" href="Prelude.Lists.Combinatorics.html#1384" class="Bound">ys</a> <a id="1387" class="Symbol">=</a> <a id="1389" href="Data.List.Base.html#4459" class="Function">concatMap</a> <a id="1399" class="Symbol">(λ</a> <a id="1402" href="Prelude.Lists.Combinatorics.html#1402" class="Bound">x</a> <a id="1404" class="Symbol">→</a> <a id="1406" href="Data.List.Base.html#1553" class="Function">map</a> <a id="1410" class="Symbol">(</a><a id="1411" href="Prelude.Lists.Combinatorics.html#1402" class="Bound">x</a> <a id="1413" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,_</a><a id="1415" class="Symbol">)</a> <a id="1417" href="Prelude.Lists.Combinatorics.html#1384" class="Bound">ys</a><a id="1419" class="Symbol">)</a> <a id="1421" href="Prelude.Lists.Combinatorics.html#1381" class="Bound">xs</a>

<a id="allPairs"></a><a id="1425" href="Prelude.Lists.Combinatorics.html#1425" class="Function">allPairs</a> <a id="1434" class="Symbol">:</a> <a id="1436" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1441" href="Prelude.Lists.Combinatorics.html#269" class="Generalizable">A</a> <a id="1443" class="Symbol">→</a> <a id="1445" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1450" class="Symbol">(</a><a id="1451" href="Prelude.Lists.Combinatorics.html#269" class="Generalizable">A</a> <a id="1453" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1455" href="Prelude.Lists.Combinatorics.html#269" class="Generalizable">A</a><a id="1456" class="Symbol">)</a>
<a id="1458" href="Prelude.Lists.Combinatorics.html#1425" class="Function">allPairs</a> <a id="1467" href="Prelude.Lists.Combinatorics.html#1467" class="Bound">xs</a> <a id="1470" class="Symbol">=</a> <a id="1472" href="Prelude.Lists.Combinatorics.html#1314" class="Function">cartesianProduct</a> <a id="1489" href="Prelude.Lists.Combinatorics.html#1467" class="Bound">xs</a> <a id="1492" href="Prelude.Lists.Combinatorics.html#1467" class="Bound">xs</a>
</pre></body></html>