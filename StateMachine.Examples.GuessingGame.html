<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>StateMachine.Examples.GuessingGame</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-utxo/tree/master///StateMachine/Examples/GuessingGame.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--allow-unsolved-metas</a> <a id="36" class="Symbol">#-}</a>
<a id="40" class="Symbol">{-#</a> <a id="44" class="Keyword">OPTIONS</a> <a id="52" class="Pragma">--rewriting</a> <a id="64" class="Symbol">#-}</a>
<a id="68" class="Comment">{- NB: We use REWRITE rules to help normalization of calls to the postulated hash function _♯. -}</a>
<a id="166" class="Keyword">module</a> <a id="173" href="StateMachine.Examples.GuessingGame.html" class="Module">StateMachine.Examples.GuessingGame</a> <a id="208" class="Keyword">where</a>

<a id="215" class="Keyword">open</a> <a id="220" class="Keyword">import</a> <a id="227" href="Agda.Builtin.Equality.Rewrite.html" class="Module">Agda.Builtin.Equality.Rewrite</a>

<a id="258" class="Keyword">open</a> <a id="263" class="Keyword">import</a> <a id="270" href="Level.html" class="Module">Level</a>          <a id="285" class="Keyword">using</a> <a id="291" class="Symbol">(</a><a id="292" href="Level.html#521" class="Function">0ℓ</a><a id="294" class="Symbol">)</a>
<a id="296" class="Keyword">open</a> <a id="301" class="Keyword">import</a> <a id="308" href="Function.html" class="Module">Function</a>       <a id="323" class="Keyword">using</a> <a id="329" class="Symbol">(</a><a id="330" href="Function.Base.html#1040" class="Function Operator">_∘_</a><a id="333" class="Symbol">;</a> <a id="335" href="Function.Base.html#645" class="Function">const</a><a id="340" class="Symbol">;</a> <a id="342" href="Function.Base.html#4130" class="Function Operator">case_of_</a><a id="350" class="Symbol">;</a> <a id="352" href="Function.Base.html#1563" class="Function">flip</a><a id="356" class="Symbol">;</a> <a id="358" href="Function.Base.html#1928" class="Function Operator">_$_</a><a id="361" class="Symbol">)</a>
<a id="363" class="Keyword">open</a> <a id="368" class="Keyword">import</a> <a id="375" href="Category.Monad.html" class="Module">Category.Monad</a> <a id="390" class="Keyword">using</a> <a id="396" class="Symbol">(</a><a id="397" href="Category.Monad.html#457" class="Function">RawMonad</a><a id="405" class="Symbol">)</a>

<a id="408" class="Keyword">open</a> <a id="413" class="Keyword">import</a> <a id="420" href="Data.Empty.html" class="Module">Data.Empty</a>   <a id="433" class="Keyword">using</a> <a id="439" class="Symbol">(</a><a id="440" href="Data.Empty.html#637" class="Function">⊥-elim</a><a id="446" class="Symbol">)</a>
<a id="448" class="Keyword">open</a> <a id="453" class="Keyword">import</a> <a id="460" href="Data.Bool.html" class="Module">Data.Bool</a>    <a id="473" class="Keyword">using</a> <a id="479" class="Symbol">(</a><a id="480" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a><a id="484" class="Symbol">;</a> <a id="486" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a><a id="490" class="Symbol">;</a> <a id="492" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a><a id="497" class="Symbol">;</a> <a id="499" href="Data.Bool.Base.html#995" class="Function Operator">_∧_</a><a id="502" class="Symbol">;</a> <a id="504" href="Data.Bool.Base.html#1292" class="Function Operator">if_then_else_</a><a id="517" class="Symbol">)</a>
<a id="519" class="Keyword">open</a> <a id="524" class="Keyword">import</a> <a id="531" href="Data.Product.html" class="Module">Data.Product</a> <a id="544" class="Keyword">using</a> <a id="550" class="Symbol">(</a><a id="551" href="Data.Product.html#1176" class="Function Operator">_×_</a><a id="554" class="Symbol">;</a> <a id="556" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">_,_</a><a id="559" class="Symbol">)</a>
<a id="561" class="Keyword">open</a> <a id="566" class="Keyword">import</a> <a id="573" href="Data.Maybe.html" class="Module">Data.Maybe</a>   <a id="586" class="Keyword">using</a> <a id="592" class="Symbol">(</a><a id="593" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a><a id="598" class="Symbol">;</a> <a id="600" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a><a id="604" class="Symbol">;</a> <a id="606" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a><a id="613" class="Symbol">)</a>
<a id="615" class="Keyword">open</a> <a id="620" class="Keyword">import</a> <a id="627" href="Data.Nat.html" class="Module">Data.Nat</a>     <a id="640" class="Keyword">using</a> <a id="646" class="Symbol">()</a>
  <a id="651" class="Keyword">renaming</a> <a id="660" class="Symbol">(</a><a id="661" href="Data.Nat.Properties.html#2538" class="Function Operator">_≟_</a> <a id="665" class="Symbol">to</a> <a id="668" class="Function Operator">_≟ℕ_</a><a id="672" class="Symbol">)</a>
<a id="674" class="Keyword">open</a> <a id="679" class="Keyword">import</a> <a id="686" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="699" class="Keyword">using</a> <a id="705" class="Symbol">(</a><a id="706" href="Agda.Builtin.Int.html#246" class="InductiveConstructor">+_</a><a id="708" class="Symbol">;</a> <a id="710" href="Data.Integer.Base.html#1757" class="Function Operator">∣_∣</a><a id="713" class="Symbol">)</a>
<a id="715" class="Keyword">open</a> <a id="720" class="Keyword">import</a> <a id="727" href="Data.Char.html" class="Module">Data.Char</a>    <a id="740" class="Keyword">using</a> <a id="746" class="Symbol">(</a><a id="747" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a><a id="751" class="Symbol">;</a> <a id="753" href="Data.Char.Base.html#1132" class="Primitive">toℕ</a><a id="756" class="Symbol">;</a> <a id="758" href="Data.Char.Base.html#1157" class="Primitive">fromℕ</a><a id="763" class="Symbol">)</a>
<a id="765" class="Keyword">open</a> <a id="770" class="Keyword">import</a> <a id="777" href="Data.String.html" class="Module">Data.String</a>  <a id="790" class="Keyword">using</a> <a id="796" class="Symbol">(</a><a id="797" href="Agda.Builtin.String.html#318" class="Postulate">String</a><a id="803" class="Symbol">;</a> <a id="805" href="Data.String.Base.html#1502" class="Primitive">toList</a><a id="811" class="Symbol">;</a> <a id="813" href="Data.String.Base.html#1535" class="Primitive">fromList</a><a id="821" class="Symbol">)</a>
  <a id="825" class="Keyword">renaming</a> <a id="834" class="Symbol">(</a><a id="835" href="Data.String.Properties.html#2284" class="Function Operator">_≟_</a> <a id="839" class="Symbol">to</a> <a id="842" class="Function Operator">_≟ₛ_</a><a id="846" class="Symbol">)</a>
<a id="848" class="Keyword">open</a> <a id="853" class="Keyword">import</a> <a id="860" href="Data.List.html" class="Module">Data.List</a>    <a id="873" class="Keyword">using</a> <a id="879" class="Symbol">(</a><a id="880" href="Agda.Builtin.List.html#130" class="Datatype">List</a><a id="884" class="Symbol">;</a> <a id="886" href="Data.List.Base.html#10392" class="InductiveConstructor">[]</a><a id="888" class="Symbol">;</a> <a id="890" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">_∷_</a><a id="893" class="Symbol">;</a> <a id="895" href="Data.List.Base.html#5034" class="Function Operator">[_]</a><a id="898" class="Symbol">;</a> <a id="900" href="Data.List.Base.html#4201" class="Function">foldr</a><a id="905" class="Symbol">;</a> <a id="907" href="Data.List.Base.html#1553" class="Function">map</a><a id="910" class="Symbol">)</a>

<a id="913" class="Keyword">import</a> <a id="920" href="Data.Maybe.Categorical.html" class="Module">Data.Maybe.Categorical</a> <a id="943" class="Symbol">as</a> <a id="946" class="Module">MaybeCat</a>
<a id="955" class="Keyword">open</a> <a id="960" href="Category.Monad.html#841" class="Module">RawMonad</a> <a id="969" class="Symbol">{</a><a id="970" class="Argument">f</a> <a id="972" class="Symbol">=</a> <a id="974" href="Level.html#521" class="Function">0ℓ</a><a id="976" class="Symbol">}</a> <a id="978" href="Data.Maybe.Categorical.html#1432" class="Function">MaybeCat.monad</a> <a id="993" class="Keyword">renaming</a> <a id="1002" class="Symbol">(</a><a id="1003" href="Category.Applicative.Indexed.html#1043" class="Function Operator">_⊛_</a> <a id="1007" class="Symbol">to</a> <a id="1010" class="Function Operator">_&lt;*&gt;_</a><a id="1015" class="Symbol">)</a>

<a id="1018" class="Keyword">open</a> <a id="1023" class="Keyword">import</a> <a id="1030" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>            <a id="1058" class="Keyword">using</a> <a id="1064" class="Symbol">(</a><a id="1065" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a><a id="1068" class="Symbol">;</a> <a id="1070" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a><a id="1072" class="Symbol">)</a>
<a id="1074" class="Keyword">open</a> <a id="1079" class="Keyword">import</a> <a id="1086" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>            <a id="1124" class="Keyword">using</a> <a id="1130" class="Symbol">(</a><a id="1131" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌊_⌋</a><a id="1134" class="Symbol">)</a>
<a id="1136" class="Keyword">open</a> <a id="1141" class="Keyword">import</a> <a id="1148" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1186" class="Keyword">using</a> <a id="1192" class="Symbol">(</a><a id="1193" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a><a id="1196" class="Symbol">;</a> <a id="1198" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="1202" class="Symbol">)</a>

<a id="1205" class="Keyword">open</a> <a id="1210" class="Keyword">import</a> <a id="1217" href="UTxO.Hashing.html" class="Module">UTxO.Hashing</a>
<a id="1230" class="Keyword">open</a> <a id="1235" class="Keyword">import</a> <a id="1242" href="UTxO.Value.html" class="Module">UTxO.Value</a>
<a id="1253" class="Keyword">open</a> <a id="1258" class="Keyword">import</a> <a id="1265" href="UTxO.Types.html" class="Module">UTxO.Types</a>
<a id="1276" class="Keyword">open</a> <a id="1281" class="Keyword">import</a> <a id="1288" href="UTxO.Validity.html" class="Module">UTxO.Validity</a>
<a id="1302" class="Keyword">open</a> <a id="1307" class="Keyword">import</a> <a id="1314" href="StateMachine.Base.html" class="Module">StateMachine.Base</a>

<a id="1333" class="Keyword">open</a> <a id="1338" class="Keyword">import</a> <a id="1345" href="Prelude.Default.html" class="Module">Prelude.Default</a>
<a id="1361" class="Keyword">open</a> <a id="1366" class="Keyword">import</a> <a id="1373" href="UTxO.Defaults.html" class="Module">UTxO.Defaults</a>

<a id="HashedString"></a><a id="1388" href="StateMachine.Examples.GuessingGame.html#1388" class="Function">HashedString</a> <a id="1401" class="Symbol">=</a> <a id="1403" href="UTxO.Hashing.Base.html#201" class="Function">HashId</a>
<a id="ClearString"></a><a id="1410" href="StateMachine.Examples.GuessingGame.html#1410" class="Function">ClearString</a>  <a id="1423" class="Symbol">=</a> <a id="1425" href="Agda.Builtin.String.html#318" class="Postulate">String</a>

<a id="1433" class="Keyword">data</a> <a id="GameState"></a><a id="1438" href="StateMachine.Examples.GuessingGame.html#1438" class="Datatype">GameState</a> <a id="1448" class="Symbol">:</a> <a id="1450" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="1454" class="Keyword">where</a>
  <a id="GameState.Locked"></a><a id="1462" href="StateMachine.Examples.GuessingGame.html#1462" class="InductiveConstructor">Locked</a> <a id="1469" class="Symbol">:</a> <a id="1471" href="StateMachine.Examples.GuessingGame.html#1388" class="Function">HashedString</a> <a id="1484" class="Symbol">→</a> <a id="1486" href="StateMachine.Examples.GuessingGame.html#1438" class="Datatype">GameState</a>

<a id="1497" class="Keyword">data</a> <a id="GameInput"></a><a id="1502" href="StateMachine.Examples.GuessingGame.html#1502" class="Datatype">GameInput</a> <a id="1512" class="Symbol">:</a> <a id="1514" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="1518" class="Keyword">where</a>
  <a id="GameInput.Guess"></a><a id="1526" href="StateMachine.Examples.GuessingGame.html#1526" class="InductiveConstructor">Guess</a> <a id="1532" class="Symbol">:</a> <a id="1534" href="StateMachine.Examples.GuessingGame.html#1410" class="Function">ClearString</a> <a id="1546" class="Symbol">→</a> <a id="1548" href="StateMachine.Examples.GuessingGame.html#1388" class="Function">HashedString</a> <a id="1561" class="Symbol">→</a> <a id="1563" href="StateMachine.Examples.GuessingGame.html#1502" class="Datatype">GameInput</a>

<a id="1574" class="Keyword">instance</a>
  <a id="IsDataᵍˢ"></a><a id="1585" href="StateMachine.Examples.GuessingGame.html#1585" class="Function">IsDataᵍˢ</a> <a id="1594" class="Symbol">:</a> <a id="1596" href="UTxO.Types.html#1155" class="Record">IsData</a> <a id="1603" href="StateMachine.Examples.GuessingGame.html#1438" class="Datatype">GameState</a>
  <a id="1615" href="UTxO.Types.html#1196" class="Field">toData</a>   <a id="1624" class="Symbol">{{</a><a id="1626" href="StateMachine.Examples.GuessingGame.html#1585" class="Function">IsDataᵍˢ</a><a id="1634" class="Symbol">}}</a> <a id="1637" class="Symbol">(</a><a id="1638" href="StateMachine.Examples.GuessingGame.html#1462" class="InductiveConstructor">Locked</a> <a id="1645" href="StateMachine.Examples.GuessingGame.html#1645" class="Bound">hs</a><a id="1647" class="Symbol">)</a> <a id="1649" class="Symbol">=</a> <a id="1651" href="UTxO.Types.html#944" class="InductiveConstructor">H</a> <a id="1653" href="StateMachine.Examples.GuessingGame.html#1645" class="Bound">hs</a>

  <a id="1659" href="UTxO.Types.html#1220" class="Field">fromData</a> <a id="1668" class="Symbol">{{</a><a id="1670" href="StateMachine.Examples.GuessingGame.html#1585" class="Function">IsDataᵍˢ</a><a id="1678" class="Symbol">}}</a> <a id="1681" class="Symbol">(</a><a id="1682" href="UTxO.Types.html#944" class="InductiveConstructor">H</a> <a id="1684" href="StateMachine.Examples.GuessingGame.html#1684" class="Bound">hs</a><a id="1686" class="Symbol">)</a> <a id="1688" class="Symbol">=</a> <a id="1690" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="1695" class="Symbol">(</a><a id="1696" href="StateMachine.Examples.GuessingGame.html#1462" class="InductiveConstructor">Locked</a> <a id="1703" href="StateMachine.Examples.GuessingGame.html#1684" class="Bound">hs</a><a id="1705" class="Symbol">)</a>
  <a id="1709" href="UTxO.Types.html#1220" class="CatchallClause Field">fromData</a><a id="1717" class="CatchallClause"> </a><a id="1718" class="CatchallClause Symbol">{{</a><a id="1720" href="StateMachine.Examples.GuessingGame.html#1585" class="CatchallClause Function">IsDataᵍˢ</a><a id="1728" class="CatchallClause Symbol">}}</a><a id="1730" class="CatchallClause"> </a><a id="1731" class="CatchallClause Symbol">_</a>      <a id="1738" class="Symbol">=</a> <a id="1740" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>

  <a id="1751" href="UTxO.Types.html#1250" class="Field">from∘to</a>  <a id="1760" class="Symbol">{{</a><a id="1762" href="StateMachine.Examples.GuessingGame.html#1585" class="Function">IsDataᵍˢ</a><a id="1770" class="Symbol">}}</a> <a id="1773" class="Symbol">(</a><a id="1774" href="StateMachine.Examples.GuessingGame.html#1462" class="InductiveConstructor">Locked</a> <a id="1781" class="Symbol">_)</a> <a id="1784" class="Symbol">=</a> <a id="1786" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

  <a id="1794" href="UTxO.Types.html#1300" class="Field">from-inj</a> <a id="1803" class="Symbol">{{</a><a id="1805" href="StateMachine.Examples.GuessingGame.html#1585" class="Function">IsDataᵍˢ</a><a id="1813" class="Symbol">}}</a> <a id="1816" class="Symbol">(</a><a id="1817" href="UTxO.Types.html#944" class="InductiveConstructor">H</a> <a id="1819" href="StateMachine.Examples.GuessingGame.html#1819" class="Bound">hs</a><a id="1821" class="Symbol">)</a> <a id="1823" class="DottedPattern Symbol">.(</a><a id="1825" href="StateMachine.Examples.GuessingGame.html#1462" class="DottedPattern InductiveConstructor">Locked</a> <a id="1832" href="StateMachine.Examples.GuessingGame.html#1819" class="DottedPattern Bound">hs</a><a id="1834" class="DottedPattern Symbol">)</a> <a id="1836" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="1841" class="Symbol">=</a> <a id="1843" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
  <a id="1850" href="UTxO.Types.html#1300" class="Field">from-inj</a> <a id="1859" class="Symbol">{{</a><a id="1861" href="StateMachine.Examples.GuessingGame.html#1585" class="Function">IsDataᵍˢ</a><a id="1869" class="Symbol">}}</a> <a id="1872" class="Symbol">(</a><a id="1873" href="UTxO.Types.html#995" class="InductiveConstructor">CONSTR</a> <a id="1880" class="Symbol">_</a> <a id="1882" class="Symbol">_)</a> <a id="1885" class="Symbol">_</a> <a id="1887" class="Symbol">()</a>
  <a id="1892" href="UTxO.Types.html#1300" class="Field">from-inj</a> <a id="1901" class="Symbol">{{</a><a id="1903" href="StateMachine.Examples.GuessingGame.html#1585" class="Function">IsDataᵍˢ</a><a id="1911" class="Symbol">}}</a> <a id="1914" class="Symbol">(</a><a id="1915" href="UTxO.Types.html#968" class="InductiveConstructor">LIST</a> <a id="1920" class="Symbol">_)</a> <a id="1923" class="Symbol">_</a> <a id="1925" class="Symbol">()</a>
  <a id="1930" href="UTxO.Types.html#1300" class="Field">from-inj</a> <a id="1939" class="Symbol">{{</a><a id="1941" href="StateMachine.Examples.GuessingGame.html#1585" class="Function">IsDataᵍˢ</a><a id="1949" class="Symbol">}}</a> <a id="1952" class="Symbol">(</a><a id="1953" href="UTxO.Types.html#925" class="InductiveConstructor">I</a> <a id="1955" class="Symbol">_)</a> <a id="1958" class="Symbol">_</a> <a id="1960" class="Symbol">()</a>
  <a id="1965" href="UTxO.Types.html#1300" class="Field">from-inj</a> <a id="1974" class="Symbol">{{</a><a id="1976" href="StateMachine.Examples.GuessingGame.html#1585" class="Function">IsDataᵍˢ</a><a id="1984" class="Symbol">}}</a> <a id="1987" class="Symbol">(</a><a id="1988" href="UTxO.Types.html#1026" class="InductiveConstructor">MAP</a> <a id="1992" class="Symbol">_)</a> <a id="1995" class="Symbol">_</a> <a id="1997" class="Symbol">()</a>

  <a id="IsDataᵍⁱ"></a><a id="2003" href="StateMachine.Examples.GuessingGame.html#2003" class="Function">IsDataᵍⁱ</a> <a id="2012" class="Symbol">:</a> <a id="2014" href="UTxO.Types.html#1155" class="Record">IsData</a> <a id="2021" href="StateMachine.Examples.GuessingGame.html#1502" class="Datatype">GameInput</a>
  <a id="2033" href="UTxO.Types.html#1196" class="Field">toData</a>   <a id="2042" class="Symbol">{{</a><a id="2044" href="StateMachine.Examples.GuessingGame.html#2003" class="Function">IsDataᵍⁱ</a><a id="2052" class="Symbol">}}</a> <a id="2055" class="Symbol">(</a><a id="2056" href="StateMachine.Examples.GuessingGame.html#1526" class="InductiveConstructor">Guess</a> <a id="2062" href="StateMachine.Examples.GuessingGame.html#2062" class="Bound">cs</a> <a id="2065" href="StateMachine.Examples.GuessingGame.html#2065" class="Bound">hs</a><a id="2067" class="Symbol">)</a> <a id="2069" class="Symbol">=</a> <a id="2071" href="UTxO.Types.html#968" class="InductiveConstructor">LIST</a> <a id="2076" class="Symbol">(</a><a id="2077" href="UTxO.Types.html#1196" class="Field">toData</a> <a id="2084" href="StateMachine.Examples.GuessingGame.html#2062" class="Bound">cs</a> <a id="2087" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2089" href="UTxO.Types.html#944" class="InductiveConstructor">H</a> <a id="2091" href="StateMachine.Examples.GuessingGame.html#2065" class="Bound">hs</a> <a id="2094" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2096" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="2098" class="Symbol">)</a>

  <a id="2103" href="UTxO.Types.html#1220" class="Field">fromData</a> <a id="2112" class="Symbol">{{</a><a id="2114" href="StateMachine.Examples.GuessingGame.html#2003" class="Function">IsDataᵍⁱ</a><a id="2122" class="Symbol">}}</a> <a id="2125" class="Symbol">(</a><a id="2126" href="UTxO.Types.html#968" class="InductiveConstructor">LIST</a> <a id="2131" class="Symbol">(</a><a id="2132" href="StateMachine.Examples.GuessingGame.html#2132" class="Bound">d</a> <a id="2134" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2136" href="UTxO.Types.html#944" class="InductiveConstructor">H</a> <a id="2138" href="StateMachine.Examples.GuessingGame.html#2138" class="Bound">hs</a> <a id="2141" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2143" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="2145" class="Symbol">))</a> <a id="2148" class="Symbol">=</a> <a id="2150" href="Function.Base.html#1563" class="Function">flip</a> <a id="2155" href="StateMachine.Examples.GuessingGame.html#1526" class="InductiveConstructor">Guess</a> <a id="2161" href="StateMachine.Examples.GuessingGame.html#2138" class="Bound">hs</a> <a id="2164" href="Category.Functor.html#617" class="Function Operator">&lt;$&gt;</a> <a id="2168" href="UTxO.Types.html#1220" class="Field">fromData</a> <a id="2177" href="StateMachine.Examples.GuessingGame.html#2132" class="Bound">d</a>
  <a id="2181" href="UTxO.Types.html#1220" class="CatchallClause Field">fromData</a><a id="2189" class="CatchallClause"> </a><a id="2190" class="CatchallClause Symbol">{{</a><a id="2192" href="StateMachine.Examples.GuessingGame.html#2003" class="CatchallClause Function">IsDataᵍⁱ</a><a id="2200" class="CatchallClause Symbol">}}</a><a id="2202" class="CatchallClause"> </a><a id="2203" class="CatchallClause Symbol">_</a>                      <a id="2226" class="Symbol">=</a> <a id="2228" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>

  <a id="2239" href="UTxO.Types.html#1250" class="Field">from∘to</a>  <a id="2248" class="Symbol">{{</a><a id="2250" href="StateMachine.Examples.GuessingGame.html#2003" class="Function">IsDataᵍⁱ</a><a id="2258" class="Symbol">}}</a> <a id="2261" class="Symbol">(</a><a id="2262" href="StateMachine.Examples.GuessingGame.html#1526" class="InductiveConstructor">Guess</a> <a id="2268" href="StateMachine.Examples.GuessingGame.html#2268" class="Bound">cs</a> <a id="2271" href="StateMachine.Examples.GuessingGame.html#2271" class="Bound">hs</a><a id="2273" class="Symbol">)</a> <a id="2275" class="Keyword">rewrite</a> <a id="2283" href="UTxO.Types.html#1250" class="Field">from∘to</a> <a id="2291" href="StateMachine.Examples.GuessingGame.html#2268" class="Bound">cs</a> <a id="2294" class="Symbol">=</a> <a id="2296" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

  <a id="2304" href="UTxO.Types.html#1300" class="Field">from-inj</a> <a id="2313" class="Symbol">{{</a><a id="2315" href="StateMachine.Examples.GuessingGame.html#2003" class="Function">IsDataᵍⁱ</a><a id="2323" class="Symbol">}}</a> <a id="2326" class="Symbol">(</a><a id="2327" href="UTxO.Types.html#968" class="InductiveConstructor">LIST</a> <a id="2332" href="StateMachine.Examples.GuessingGame.html#2332" class="Bound">xs</a><a id="2334" class="Symbol">)</a> <a id="2336" class="Symbol">(</a><a id="2337" href="StateMachine.Examples.GuessingGame.html#1526" class="InductiveConstructor">Guess</a> <a id="2343" href="StateMachine.Examples.GuessingGame.html#2343" class="Bound">cs</a> <a id="2346" href="StateMachine.Examples.GuessingGame.html#2346" class="Bound">hs</a><a id="2348" class="Symbol">)</a> <a id="2350" href="StateMachine.Examples.GuessingGame.html#2350" class="Bound">p</a> <a id="2352" class="Symbol">=</a> <a id="2354" class="Hole">{!!}</a>
  <a id="2361" href="UTxO.Types.html#1300" class="Field">from-inj</a> <a id="2370" class="Symbol">{{</a><a id="2372" href="StateMachine.Examples.GuessingGame.html#2003" class="Function">IsDataᵍⁱ</a><a id="2380" class="Symbol">}}</a> <a id="2383" class="Symbol">(</a><a id="2384" href="UTxO.Types.html#995" class="InductiveConstructor">CONSTR</a> <a id="2391" class="Symbol">_</a> <a id="2393" class="Symbol">_)</a> <a id="2396" class="Symbol">_</a> <a id="2398" class="Symbol">()</a>
  <a id="2403" href="UTxO.Types.html#1300" class="Field">from-inj</a> <a id="2412" class="Symbol">{{</a><a id="2414" href="StateMachine.Examples.GuessingGame.html#2003" class="Function">IsDataᵍⁱ</a><a id="2422" class="Symbol">}}</a> <a id="2425" class="Symbol">(</a><a id="2426" href="UTxO.Types.html#944" class="InductiveConstructor">H</a> <a id="2428" class="Symbol">_)</a> <a id="2431" class="Symbol">_</a> <a id="2433" class="Symbol">()</a>
  <a id="2438" href="UTxO.Types.html#1300" class="Field">from-inj</a> <a id="2447" class="Symbol">{{</a><a id="2449" href="StateMachine.Examples.GuessingGame.html#2003" class="Function">IsDataᵍⁱ</a><a id="2457" class="Symbol">}}</a> <a id="2460" class="Symbol">(</a><a id="2461" href="UTxO.Types.html#925" class="InductiveConstructor">I</a> <a id="2463" class="Symbol">_)</a> <a id="2466" class="Symbol">_</a> <a id="2468" class="Symbol">()</a>
  <a id="2473" href="UTxO.Types.html#1300" class="Field">from-inj</a> <a id="2482" class="Symbol">{{</a><a id="2484" href="StateMachine.Examples.GuessingGame.html#2003" class="Function">IsDataᵍⁱ</a><a id="2492" class="Symbol">}}</a> <a id="2495" class="Symbol">(</a><a id="2496" href="UTxO.Types.html#1026" class="InductiveConstructor">MAP</a> <a id="2500" class="Symbol">_)</a> <a id="2503" class="Symbol">_</a> <a id="2505" class="Symbol">()</a>

<a id="GameStateMachine"></a><a id="2509" href="StateMachine.Examples.GuessingGame.html#2509" class="Function">GameStateMachine</a> <a id="2526" class="Symbol">:</a> <a id="2528" href="StateMachine.Base.html#1973" class="Record">StateMachine</a> <a id="2541" href="StateMachine.Examples.GuessingGame.html#1438" class="Datatype">GameState</a> <a id="2551" href="StateMachine.Examples.GuessingGame.html#1502" class="Datatype">GameInput</a>
<a id="2561" href="StateMachine.Base.html#2080" class="Field">isInitial</a> <a id="2571" href="StateMachine.Examples.GuessingGame.html#2509" class="Function">GameStateMachine</a> <a id="2588" class="Symbol">=</a> <a id="2590" href="Function.Base.html#645" class="Function">const</a> <a id="2596" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a>
<a id="2601" href="StateMachine.Base.html#2105" class="Field">step</a>      <a id="2611" href="StateMachine.Examples.GuessingGame.html#2509" class="Function">GameStateMachine</a> <a id="2628" class="Symbol">(</a><a id="2629" href="StateMachine.Examples.GuessingGame.html#1462" class="InductiveConstructor">Locked</a> <a id="2636" href="StateMachine.Examples.GuessingGame.html#2636" class="Bound">currentSecret</a><a id="2649" class="Symbol">)</a> <a id="2651" class="Symbol">(</a><a id="2652" href="StateMachine.Examples.GuessingGame.html#1526" class="InductiveConstructor">Guess</a> <a id="2658" href="StateMachine.Examples.GuessingGame.html#2658" class="Bound">theGuess</a> <a id="2667" href="StateMachine.Examples.GuessingGame.html#2667" class="Bound">nextSecret</a><a id="2677" class="Symbol">)</a> <a id="2679" class="Symbol">=</a>
  <a id="2683" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="2686" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌊</a> <a id="2688" class="Symbol">(</a><a id="2689" href="StateMachine.Examples.GuessingGame.html#2658" class="Bound">theGuess</a> <a id="2698" href="UTxO.Hashing.Base.html#1057" class="Function Operator">♯ₛₜᵣ</a><a id="2702" class="Symbol">)</a> <a id="2704" href="StateMachine.Examples.GuessingGame.html#668" class="Function Operator">≟ℕ</a> <a id="2707" href="StateMachine.Examples.GuessingGame.html#2636" class="Bound">currentSecret</a> <a id="2721" href="Relation.Nullary.Decidable.Core.html#1321" class="Function Operator">⌋</a> <a id="2723" href="Data.Bool.Base.html#1292" class="Function Operator">then</a>
    <a id="2732" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="2737" class="Symbol">(</a><a id="2738" href="StateMachine.Examples.GuessingGame.html#1462" class="InductiveConstructor">Locked</a> <a id="2745" href="StateMachine.Examples.GuessingGame.html#2667" class="Bound">nextSecret</a> <a id="2756" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2758" href="Prelude.Default.html#356" class="Field">def</a><a id="2761" class="Symbol">)</a>
  <a id="2765" href="Data.Bool.Base.html#1292" class="Function Operator">else</a>
    <a id="2774" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>
<a id="2782" href="StateMachine.Base.html#2155" class="Field">origin</a>    <a id="2792" href="StateMachine.Examples.GuessingGame.html#2509" class="Function">GameStateMachine</a> <a id="2809" class="Symbol">=</a> <a id="2811" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>


<a id="2821" class="Comment">-- ** Example ledger.</a>

<a id="2844" class="Keyword">open</a> <a id="2849" href="StateMachine.Base.html#2219" class="Module">CEM</a> <a id="2853" class="Symbol">{</a><a id="2854" class="Argument">sm</a> <a id="2857" class="Symbol">=</a> <a id="2859" href="StateMachine.Examples.GuessingGame.html#2509" class="Function">GameStateMachine</a><a id="2875" class="Symbol">}</a>

<a id="2878" class="Comment">-- 1) game states</a>

<a id="st₁"></a><a id="2897" href="StateMachine.Examples.GuessingGame.html#2897" class="Function">st₁</a> <a id="2901" class="Symbol">=</a> <a id="2903" href="StateMachine.Examples.GuessingGame.html#1462" class="InductiveConstructor">Locked</a> <a id="2910" class="Symbol">(</a><a id="2911" class="String">&quot;0&quot;</a> <a id="2915" href="UTxO.Hashing.Base.html#1057" class="Function Operator">♯ₛₜᵣ</a><a id="2919" class="Symbol">)</a>
  <a id="2923" class="Comment">--&gt; Guess &quot;0&quot; &quot;1&quot;</a>
<a id="st₂"></a><a id="2941" href="StateMachine.Examples.GuessingGame.html#2941" class="Function">st₂</a> <a id="2945" class="Symbol">=</a> <a id="2947" href="StateMachine.Examples.GuessingGame.html#1462" class="InductiveConstructor">Locked</a> <a id="2954" class="Symbol">(</a><a id="2955" class="String">&quot;1&quot;</a> <a id="2959" href="UTxO.Hashing.Base.html#1057" class="Function Operator">♯ₛₜᵣ</a><a id="2963" class="Symbol">)</a>

<a id="2966" class="Comment">-- 2) transactions</a>

<a id="t₁"></a><a id="2986" href="StateMachine.Examples.GuessingGame.html#2986" class="Function">t₁</a> <a id="2989" class="Symbol">:</a> <a id="2991" href="UTxO.Types.html#7568" class="Record">Tx</a>
<a id="2994" href="StateMachine.Examples.GuessingGame.html#2986" class="Function">t₁</a> <a id="2997" class="Symbol">=</a> <a id="2999" class="Keyword">record</a> <a id="3006" class="Symbol">(</a><a id="3007" href="StateMachine.Base.html#4178" class="Function">withOutputs</a> <a id="3019" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="3021" href="StateMachine.Examples.GuessingGame.html#2897" class="Function">st₁</a> <a id="3025" href="Data.List.Base.html#5034" class="Function Operator">]</a><a id="3026" class="Symbol">)</a>
  <a id="3030" class="Symbol">{</a> <a id="3032" href="UTxO.Types.html#7735" class="Field">forge</a>    <a id="3041" class="Symbol">=</a> <a id="3043" href="StateMachine.Base.html#3185" class="Function">threadₛₘ</a>
  <a id="3054" class="Symbol">;</a> <a id="3056" href="UTxO.Types.html#7762" class="Field">policies</a> <a id="3065" class="Symbol">=</a> <a id="3067" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="3069" href="StateMachine.Base.html#2583" class="Function">policyₛₘ</a> <a id="3078" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="3080" class="Symbol">}</a>

<a id="t₂"></a><a id="3083" href="StateMachine.Examples.GuessingGame.html#3083" class="Function">t₂</a> <a id="3086" class="Symbol">:</a> <a id="3088" href="UTxO.Types.html#7568" class="Record">Tx</a>
<a id="3091" href="StateMachine.Examples.GuessingGame.html#3083" class="Function">t₂</a> <a id="3094" class="Symbol">=</a> <a id="3096" class="Keyword">record</a> <a id="3103" class="Symbol">(</a><a id="3104" href="StateMachine.Base.html#4178" class="Function">withOutputs</a> <a id="3116" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="3118" href="StateMachine.Examples.GuessingGame.html#2941" class="Function">st₂</a> <a id="3122" href="Data.List.Base.html#5034" class="Function Operator">]</a><a id="3123" class="Symbol">)</a>
  <a id="3127" class="Symbol">{</a> <a id="3129" href="UTxO.Types.html#7595" class="Field">inputs</a>  <a id="3137" class="Symbol">=</a> <a id="3139" href="Data.List.Base.html#5034" class="Function Operator">[</a> <a id="3141" class="Symbol">(</a><a id="3142" href="StateMachine.Examples.GuessingGame.html#2986" class="Function">t₁</a> <a id="3145" href="UTxO.Hashing.Types.html#1170" class="Function Operator">♯ₜₓ</a><a id="3148" class="Symbol">)</a> <a id="3150" href="UTxO.Types.html#4242" class="InductiveConstructor Operator">indexed-at</a> <a id="3161" class="Number">0</a> <a id="3163" href="StateMachine.Base.html#3825" class="Function Operator">←—</a> <a id="3166" class="Symbol">(</a><a id="3167" href="StateMachine.Examples.GuessingGame.html#1526" class="InductiveConstructor">Guess</a> <a id="3173" class="String">&quot;0&quot;</a> <a id="3177" class="Symbol">(</a><a id="3178" class="String">&quot;1&quot;</a> <a id="3182" href="UTxO.Hashing.Base.html#1057" class="Function Operator">♯ₛₜᵣ</a><a id="3186" class="Symbol">)</a> <a id="3188" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3190" href="StateMachine.Examples.GuessingGame.html#2897" class="Function">st₁</a><a id="3193" class="Symbol">)</a> <a id="3195" href="Data.List.Base.html#5034" class="Function Operator">]</a> <a id="3197" class="Symbol">}</a>

<a id="3200" class="Comment">-- 3) validate</a>

<a id="3216" class="Comment">{-
-- *** takes around 1 hour to type-check...
-- T0D0: profile to debug performance

postulate ℂ≡ : policyₛₘ ♯ ≡ 0
{-# REWRITE ℂ≡ #-}

postulate 𝕍≡ : validatorₛₘ ♯ ≡ 1
{-# REWRITE 𝕍≡ #-}

ex-play : ValidLedger (t₂ ∷ t₁ ∷ [])
ex-play = ∙ ⊕ t₁ ⊕ t₂
-}</a>
</pre></body></html>