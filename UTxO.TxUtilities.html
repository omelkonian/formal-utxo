<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>UTxO.TxUtilities</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-utxo/tree/master/UTxO/TxUtilities.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="UTxO.TxUtilities.html" class="Module">UTxO.TxUtilities</a> <a id="25" class="Keyword">where</a>

<a id="32" class="Keyword">open</a> <a id="37" class="Keyword">import</a> <a id="44" href="Data.List.Properties.html" class="Module">Data.List.Properties</a>
<a id="65" class="Keyword">open</a> <a id="70" class="Keyword">import</a> <a id="77" href="Data.List.Membership.Propositional.Properties.html" class="Module">Data.List.Membership.Propositional.Properties</a> <a id="123" class="Keyword">using</a> <a id="129" class="Symbol">(</a><a id="130" href="Data.List.Membership.Propositional.Properties.html#4143" class="Function">∈-++⁻</a><a id="135" class="Symbol">;</a> <a id="137" href="Data.List.Membership.Propositional.Properties.html#8622" class="Function">∈-filter⁻</a><a id="146" class="Symbol">)</a>

<a id="149" class="Keyword">open</a> <a id="154" class="Keyword">import</a> <a id="161" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="174" class="Keyword">open</a> <a id="179" class="Keyword">import</a> <a id="186" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="200" class="Keyword">open</a> <a id="205" class="Keyword">import</a> <a id="212" href="Prelude.Lists.Postulates.html" class="Module">Prelude.Lists.Postulates</a>
<a id="237" class="Keyword">open</a> <a id="242" class="Keyword">import</a> <a id="249" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="263" class="Keyword">open</a> <a id="268" class="Keyword">import</a> <a id="275" href="Prelude.Sets.html" class="Module">Prelude.Sets</a>
<a id="288" class="Keyword">open</a> <a id="293" class="Keyword">import</a> <a id="300" href="Prelude.Membership.html" class="Module">Prelude.Membership</a> <a id="319" class="Keyword">hiding</a> <a id="326" class="Symbol">(</a><a id="327" href="Prelude.Membership.html#428" class="Field Operator">_∈_</a><a id="330" class="Symbol">)</a>
<a id="332" class="Keyword">open</a> <a id="337" href="Prelude.Init.html#7133" class="Module">L.Mem</a> <a id="343" class="Keyword">using</a> <a id="349" class="Symbol">(</a><a id="350" href="Data.List.Membership.Setoid.html#896" class="Function Operator">_∈_</a><a id="353" class="Symbol">)</a>
<a id="355" class="Keyword">open</a> <a id="360" class="Keyword">import</a> <a id="367" href="Prelude.ToN.html" class="Module">Prelude.ToN</a>
<a id="379" class="Keyword">open</a> <a id="384" class="Keyword">import</a> <a id="391" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="407" class="Keyword">open</a> <a id="412" class="Keyword">import</a> <a id="419" href="Prelude.Bifunctor.html" class="Module">Prelude.Bifunctor</a>
<a id="437" class="Keyword">open</a> <a id="442" class="Keyword">import</a> <a id="449" href="Prelude.Monad.html" class="Module">Prelude.Monad</a>

<a id="464" class="Keyword">open</a> <a id="469" class="Keyword">import</a> <a id="476" href="UTxO.Hashing.html" class="Module">UTxO.Hashing</a>
<a id="489" class="Keyword">open</a> <a id="494" class="Keyword">import</a> <a id="501" href="UTxO.Value.html" class="Module">UTxO.Value</a>
<a id="512" class="Keyword">open</a> <a id="517" class="Keyword">import</a> <a id="524" href="UTxO.Types.html" class="Module">UTxO.Types</a>

<a id="536" class="Keyword">record</a> <a id="UTXO"></a><a id="543" href="UTxO.TxUtilities.html#543" class="Record">UTXO</a> <a id="548" class="Symbol">:</a> <a id="550" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="554" class="Keyword">where</a>
  <a id="562" class="Keyword">field</a>
    <a id="UTXO.outRef"></a><a id="572" href="UTxO.TxUtilities.html#572" class="Field">outRef</a>   <a id="581" class="Symbol">:</a> <a id="583" href="UTxO.Types.html#4204" class="Record">TxOutputRef</a>
    <a id="UTXO.out"></a><a id="599" href="UTxO.TxUtilities.html#599" class="Field">out</a>      <a id="608" class="Symbol">:</a> <a id="610" href="UTxO.Types.html#4814" class="Record">TxOutput</a>
    <a id="UTXO.prevTx"></a><a id="623" href="UTxO.TxUtilities.html#623" class="Field">prevTx</a>   <a id="632" class="Symbol">:</a> <a id="634" href="UTxO.Types.html#7568" class="Record">Tx</a>

<a id="638" class="Keyword">open</a> <a id="643" href="UTxO.TxUtilities.html#543" class="Module">UTXO</a> <a id="648" class="Keyword">public</a>

<a id="mkUtxo"></a><a id="656" href="UTxO.TxUtilities.html#656" class="Function">mkUtxo</a> <a id="663" class="Symbol">:</a> <a id="665" class="Symbol">∀</a> <a id="667" class="Symbol">{</a><a id="668" href="UTxO.TxUtilities.html#668" class="Bound">out</a><a id="671" class="Symbol">}</a> <a id="673" href="UTxO.TxUtilities.html#673" class="Bound">tx</a> <a id="676" class="Symbol">→</a> <a id="678" href="UTxO.TxUtilities.html#668" class="Bound">out</a> <a id="682" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="684" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="692" href="UTxO.TxUtilities.html#673" class="Bound">tx</a> <a id="695" class="Symbol">→</a> <a id="697" href="UTxO.TxUtilities.html#543" class="Record">UTXO</a>
<a id="702" href="UTxO.TxUtilities.html#572" class="Field">outRef</a> <a id="709" class="Symbol">(</a><a id="710" href="UTxO.TxUtilities.html#656" class="Function">mkUtxo</a> <a id="717" href="UTxO.TxUtilities.html#717" class="Bound">tx</a> <a id="720" href="UTxO.TxUtilities.html#720" class="Bound">out∈</a><a id="724" class="Symbol">)</a>   <a id="728" class="Symbol">=</a> <a id="730" class="Symbol">(</a><a id="731" href="UTxO.TxUtilities.html#717" class="Bound">tx</a> <a id="734" href="UTxO.Hashing.Types.html#1170" class="Function Operator">♯ₜₓ</a><a id="737" class="Symbol">)</a> <a id="739" href="UTxO.Types.html#4242" class="InductiveConstructor Operator">indexed-at</a> <a id="750" href="Prelude.ToN.html#139" class="Field">toℕ</a> <a id="754" class="Symbol">(</a><a id="755" href="Data.List.Relation.Unary.Any.html#1826" class="Function">L.Any.index</a> <a id="767" href="UTxO.TxUtilities.html#720" class="Bound">out∈</a><a id="771" class="Symbol">)</a>
<a id="773" href="UTxO.TxUtilities.html#599" class="Field">out</a>    <a id="780" class="Symbol">(</a><a id="781" href="UTxO.TxUtilities.html#656" class="Function">mkUtxo</a> <a id="788" class="Symbol">{</a><a id="789" href="UTxO.TxUtilities.html#789" class="Bound">out</a><a id="792" class="Symbol">}</a> <a id="794" class="Symbol">_</a> <a id="796" class="Symbol">_)</a> <a id="799" class="Symbol">=</a> <a id="801" href="UTxO.TxUtilities.html#789" class="Bound">out</a>
<a id="805" href="UTxO.TxUtilities.html#623" class="Field">prevTx</a> <a id="812" class="Symbol">(</a><a id="813" href="UTxO.TxUtilities.html#656" class="Function">mkUtxo</a> <a id="820" href="UTxO.TxUtilities.html#820" class="Bound">tx</a> <a id="823" class="Symbol">_</a> <a id="825" class="Symbol">)</a>     <a id="831" class="Symbol">=</a> <a id="833" href="UTxO.TxUtilities.html#820" class="Bound">tx</a>

<a id="utxo"></a><a id="837" href="UTxO.TxUtilities.html#837" class="Function">utxo</a> <a id="842" class="Symbol">:</a> <a id="844" href="UTxO.Types.html#7888" class="Function">Ledger</a> <a id="851" class="Symbol">→</a> <a id="853" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="858" href="UTxO.TxUtilities.html#543" class="Record">UTXO</a>
<a id="863" href="UTxO.TxUtilities.html#837" class="Function">utxo</a> <a id="868" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>       <a id="877" class="Symbol">=</a> <a id="879" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>
<a id="882" href="UTxO.TxUtilities.html#837" class="Function">utxo</a> <a id="887" class="Symbol">(</a><a id="888" href="UTxO.TxUtilities.html#888" class="Bound">tx</a> <a id="891" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="893" href="UTxO.TxUtilities.html#893" class="Bound">l</a><a id="894" class="Symbol">)</a> <a id="896" class="Symbol">=</a> <a id="898" href="Data.List.Base.html#8101" class="Function">filter</a> <a id="905" class="Symbol">((</a><a id="907" href="Prelude.Membership.html#613" class="Function Operator">_∉?</a> <a id="911" href="UTxO.Types.html#8024" class="Function">outputRefs</a> <a id="922" href="UTxO.TxUtilities.html#888" class="Bound">tx</a><a id="924" class="Symbol">)</a> <a id="926" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="928" href="UTxO.TxUtilities.html#572" class="Field">outRef</a><a id="934" class="Symbol">)</a> <a id="936" class="Symbol">(</a><a id="937" href="UTxO.TxUtilities.html#837" class="Function">utxo</a> <a id="942" href="UTxO.TxUtilities.html#893" class="Bound">l</a><a id="943" class="Symbol">)</a>
             <a id="958" href="Data.List.Base.html#1819" class="Function Operator">++</a> <a id="961" href="Prelude.Membership.html#1363" class="Field">mapWith∈</a> <a id="970" class="Symbol">(</a><a id="971" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="979" href="UTxO.TxUtilities.html#888" class="Bound">tx</a><a id="981" class="Symbol">)</a> <a id="983" class="Symbol">(</a><a id="984" href="UTxO.TxUtilities.html#656" class="Function">mkUtxo</a> <a id="991" href="UTxO.TxUtilities.html#888" class="Bound">tx</a><a id="993" class="Symbol">)</a>

<a id="996" class="Keyword">open</a> <a id="1001" href="Relation.Binary.PropositionalEquality.Core.html#2717" class="Module">≡-Reasoning</a>

<a id="map-out≡"></a><a id="1014" href="UTxO.TxUtilities.html#1014" class="Function">map-out≡</a> <a id="1023" class="Symbol">:</a> <a id="1025" class="Symbol">∀</a> <a id="1027" href="UTxO.TxUtilities.html#1027" class="Bound">tx</a> <a id="1030" class="Symbol">→</a> <a id="1032" href="Data.List.Base.html#1553" class="Function">map</a> <a id="1036" href="UTxO.TxUtilities.html#599" class="Field">out</a> <a id="1040" class="Symbol">(</a><a id="1041" href="Prelude.Membership.html#1363" class="Field">mapWith∈</a> <a id="1050" class="Symbol">(</a><a id="1051" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="1059" href="UTxO.TxUtilities.html#1027" class="Bound">tx</a><a id="1061" class="Symbol">)</a> <a id="1063" class="Symbol">(</a><a id="1064" href="UTxO.TxUtilities.html#656" class="Function">mkUtxo</a> <a id="1071" href="UTxO.TxUtilities.html#1027" class="Bound">tx</a><a id="1073" class="Symbol">))</a> <a id="1076" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1078" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="1086" href="UTxO.TxUtilities.html#1027" class="Bound">tx</a>
<a id="1089" href="UTxO.TxUtilities.html#1014" class="Function">map-out≡</a> <a id="1098" href="UTxO.TxUtilities.html#1098" class="Bound">tx</a> <a id="1101" class="Symbol">=</a>
  <a id="1105" href="Relation.Binary.PropositionalEquality.Core.html#2815" class="Function Operator">begin</a> <a id="1111" href="Data.List.Base.html#1553" class="Function">map</a> <a id="1115" href="UTxO.TxUtilities.html#599" class="Field">out</a> <a id="1119" class="Symbol">(</a><a id="1120" href="Prelude.Membership.html#1363" class="Field">mapWith∈</a> <a id="1129" class="Symbol">(</a><a id="1130" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="1138" href="UTxO.TxUtilities.html#1098" class="Bound">tx</a><a id="1140" class="Symbol">)</a> <a id="1142" class="Symbol">(</a><a id="1143" href="UTxO.TxUtilities.html#656" class="Function">mkUtxo</a> <a id="1150" href="UTxO.TxUtilities.html#1098" class="Bound">tx</a><a id="1152" class="Symbol">))</a> <a id="1155" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="1158" href="Prelude.Lists.Membership.html#5036" class="Function">map∘mapWith∈</a> <a id="1171" href="UTxO.TxUtilities.html#599" class="Field">out</a> <a id="1175" class="Symbol">(</a><a id="1176" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="1184" href="UTxO.TxUtilities.html#1098" class="Bound">tx</a><a id="1186" class="Symbol">)</a> <a id="1188" class="Symbol">(</a><a id="1189" href="UTxO.TxUtilities.html#656" class="Function">mkUtxo</a> <a id="1196" href="UTxO.TxUtilities.html#1098" class="Bound">tx</a><a id="1198" class="Symbol">)</a> <a id="1200" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
        <a id="1210" href="Prelude.Membership.html#1363" class="Field">mapWith∈</a> <a id="1219" class="Symbol">(</a><a id="1220" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="1228" href="UTxO.TxUtilities.html#1098" class="Bound">tx</a><a id="1230" class="Symbol">)</a> <a id="1232" class="Symbol">(</a><a id="1233" href="UTxO.TxUtilities.html#599" class="Field">out</a> <a id="1237" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1239" href="UTxO.TxUtilities.html#656" class="Function">mkUtxo</a> <a id="1246" href="UTxO.TxUtilities.html#1098" class="Bound">tx</a><a id="1248" class="Symbol">)</a>     <a id="1254" href="Relation.Binary.PropositionalEquality.Core.html#2873" class="Function Operator">≡⟨⟩</a>
        <a id="1266" href="Prelude.Membership.html#1363" class="Field">mapWith∈</a> <a id="1275" class="Symbol">(</a><a id="1276" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="1284" href="UTxO.TxUtilities.html#1098" class="Bound">tx</a><a id="1286" class="Symbol">)</a> <a id="1288" class="Symbol">(λ</a> <a id="1291" class="Symbol">{</a><a id="1292" href="UTxO.TxUtilities.html#1292" class="Bound">o</a><a id="1293" class="Symbol">}</a> <a id="1295" href="UTxO.TxUtilities.html#1295" class="Bound">_</a> <a id="1297" class="Symbol">→</a> <a id="1299" href="UTxO.TxUtilities.html#1292" class="Bound">o</a><a id="1300" class="Symbol">)</a>         <a id="1310" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="1313" href="Prelude.Lists.Postulates.html#3168" class="Postulate">mapWith∈-id</a> <a id="1325" class="Symbol">{</a><a id="1326" class="Argument">xs</a> <a id="1329" class="Symbol">=</a> <a id="1331" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="1339" href="UTxO.TxUtilities.html#1098" class="Bound">tx</a><a id="1341" class="Symbol">}</a> <a id="1343" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
        <a id="1353" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="1361" href="UTxO.TxUtilities.html#1098" class="Bound">tx</a>                                  <a id="1397" href="Relation.Binary.PropositionalEquality.Core.html#3114" class="Function Operator">∎</a>

<a id="∑utxo≥∑out"></a><a id="1400" href="UTxO.TxUtilities.html#1400" class="Function">∑utxo≥∑out</a> <a id="1411" class="Symbol">:</a> <a id="1413" class="Symbol">∀</a> <a id="1415" href="UTxO.TxUtilities.html#1415" class="Bound">tx</a> <a id="1418" href="UTxO.TxUtilities.html#1418" class="Bound">l</a> <a id="1420" class="Symbol">→</a> <a id="1422" href="Data.Bool.Base.html#1460" class="Function">T</a> <a id="1424" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1426" href="UTxO.Value.html#2582" class="Function">∑</a> <a id="1428" class="Symbol">(</a><a id="1429" href="UTxO.TxUtilities.html#837" class="Function">utxo</a> <a id="1434" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1436" href="UTxO.TxUtilities.html#1415" class="Bound">tx</a> <a id="1439" class="InductiveConstructor Operator">∷</a> <a id="1441" href="UTxO.TxUtilities.html#1418" class="Bound">l</a><a id="1442" class="Symbol">)</a> <a id="1444" class="Symbol">(</a><a id="1445" href="UTxO.Types.html#4906" class="Field">value</a> <a id="1451" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1453" href="UTxO.TxUtilities.html#599" class="Field">out</a><a id="1456" class="Symbol">)</a> <a id="1458" href="UTxO.Value.html#2341" class="Function Operator">≥ᶜ</a> <a id="1461" href="UTxO.Value.html#2582" class="Function">∑</a> <a id="1463" class="Symbol">(</a><a id="1464" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="1472" href="UTxO.TxUtilities.html#1415" class="Bound">tx</a><a id="1474" class="Symbol">)</a> <a id="1476" href="UTxO.Types.html#4906" class="Field">value</a>
<a id="1482" href="UTxO.TxUtilities.html#1400" class="Function">∑utxo≥∑out</a> <a id="1493" href="UTxO.TxUtilities.html#1493" class="Bound">tx</a> <a id="1496" href="UTxO.TxUtilities.html#1496" class="Bound">l</a>
  <a id="1500" class="Keyword">rewrite</a> <a id="1508" href="UTxO.Value.html#4254" class="Postulate">∑-++</a> <a id="1513" class="Symbol">{</a><a id="1514" class="Argument">xs</a> <a id="1517" class="Symbol">=</a> <a id="1519" href="Data.List.Base.html#8101" class="Function">filter</a> <a id="1526" class="Symbol">((</a><a id="1528" href="Prelude.Membership.html#613" class="Function Operator">_∉?</a> <a id="1532" href="UTxO.Types.html#8024" class="Function">outputRefs</a> <a id="1543" href="UTxO.TxUtilities.html#1493" class="Bound">tx</a><a id="1545" class="Symbol">)</a> <a id="1547" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1549" href="UTxO.TxUtilities.html#572" class="Field">outRef</a><a id="1555" class="Symbol">)</a> <a id="1557" class="Symbol">(</a><a id="1558" href="UTxO.TxUtilities.html#837" class="Function">utxo</a> <a id="1563" href="UTxO.TxUtilities.html#1496" class="Bound">l</a><a id="1564" class="Symbol">)}</a>
               <a id="1582" class="Symbol">{</a><a id="1583" class="Argument">ys</a> <a id="1586" class="Symbol">=</a> <a id="1588" href="Prelude.Membership.html#1363" class="Field">mapWith∈</a> <a id="1597" class="Symbol">(</a><a id="1598" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="1606" href="UTxO.TxUtilities.html#1493" class="Bound">tx</a><a id="1608" class="Symbol">)</a> <a id="1610" class="Symbol">(</a><a id="1611" href="UTxO.TxUtilities.html#656" class="Function">mkUtxo</a> <a id="1618" href="UTxO.TxUtilities.html#1493" class="Bound">tx</a><a id="1620" class="Symbol">)}</a> <a id="1623" class="Symbol">{</a><a id="1624" class="Argument">fv</a> <a id="1627" class="Symbol">=</a> <a id="1629" href="UTxO.Types.html#4906" class="Field">value</a> <a id="1635" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1637" href="UTxO.TxUtilities.html#599" class="Field">out</a><a id="1640" class="Symbol">}</a>
        <a id="1650" class="Symbol">=</a> <a id="1652" href="UTxO.Value.html#4138" class="Postulate">≥ᶜ-+ᶜ</a> <a id="1658" class="Symbol">{</a><a id="1659" class="Argument">x</a> <a id="1661" class="Symbol">=</a> <a id="1663" href="UTxO.TxUtilities.html#1708" class="Function">x</a><a id="1664" class="Symbol">}</a> <a id="1666" class="Symbol">{</a><a id="1667" class="Argument">y</a> <a id="1669" class="Symbol">=</a> <a id="1671" href="UTxO.TxUtilities.html#1781" class="Function">y</a><a id="1672" class="Symbol">}</a> <a id="1674" class="Symbol">{</a><a id="1675" class="Argument">z</a> <a id="1677" class="Symbol">=</a> <a id="1679" href="UTxO.TxUtilities.html#1841" class="Function">z</a><a id="1680" class="Symbol">}</a> <a id="1682" class="Symbol">(</a><a id="1683" href="UTxO.Value.html#7198" class="Function">≥ᶜ-refl′</a> <a id="1692" href="UTxO.TxUtilities.html#1870" class="Function">∑≡</a><a id="1694" class="Symbol">)</a>
  <a id="1698" class="Keyword">where</a>
    <a id="1708" href="UTxO.TxUtilities.html#1708" class="Function">x</a> <a id="1710" class="Symbol">=</a> <a id="1712" href="UTxO.Value.html#2582" class="Function">∑</a> <a id="1714" class="Symbol">(</a><a id="1715" href="Data.List.Base.html#8101" class="Function">filter</a> <a id="1722" class="Symbol">((</a><a id="1724" href="Prelude.Membership.html#613" class="Function Operator">_∉?</a> <a id="1728" href="UTxO.Types.html#8024" class="Function">outputRefs</a> <a id="1739" href="UTxO.TxUtilities.html#1493" class="Bound">tx</a><a id="1741" class="Symbol">)</a> <a id="1743" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1745" href="UTxO.TxUtilities.html#572" class="Field">outRef</a><a id="1751" class="Symbol">)</a> <a id="1753" class="Symbol">(</a><a id="1754" href="UTxO.TxUtilities.html#837" class="Function">utxo</a> <a id="1759" href="UTxO.TxUtilities.html#1496" class="Bound">l</a><a id="1760" class="Symbol">))</a> <a id="1763" class="Symbol">(</a><a id="1764" href="UTxO.Types.html#4906" class="Field">value</a> <a id="1770" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1772" href="UTxO.TxUtilities.html#599" class="Field">out</a><a id="1775" class="Symbol">)</a>
    <a id="1781" href="UTxO.TxUtilities.html#1781" class="Function">y</a> <a id="1783" class="Symbol">=</a> <a id="1785" href="UTxO.Value.html#2582" class="Function">∑</a> <a id="1787" class="Symbol">(</a><a id="1788" href="Prelude.Membership.html#1363" class="Field">mapWith∈</a> <a id="1797" class="Symbol">(</a><a id="1798" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="1806" href="UTxO.TxUtilities.html#1493" class="Bound">tx</a><a id="1808" class="Symbol">)</a> <a id="1810" class="Symbol">(</a><a id="1811" href="UTxO.TxUtilities.html#656" class="Function">mkUtxo</a> <a id="1818" href="UTxO.TxUtilities.html#1493" class="Bound">tx</a><a id="1820" class="Symbol">))</a> <a id="1823" class="Symbol">(</a><a id="1824" href="UTxO.Types.html#4906" class="Field">value</a> <a id="1830" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1832" href="UTxO.TxUtilities.html#599" class="Field">out</a><a id="1835" class="Symbol">)</a>
    <a id="1841" href="UTxO.TxUtilities.html#1841" class="Function">z</a> <a id="1843" class="Symbol">=</a> <a id="1845" href="UTxO.Value.html#2582" class="Function">∑</a> <a id="1847" class="Symbol">(</a><a id="1848" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="1856" href="UTxO.TxUtilities.html#1493" class="Bound">tx</a><a id="1858" class="Symbol">)</a> <a id="1860" href="UTxO.Types.html#4906" class="Field">value</a>
    <a id="1870" href="UTxO.TxUtilities.html#1870" class="Function">∑≡</a> <a id="1873" class="Symbol">:</a> <a id="1875" href="UTxO.TxUtilities.html#1781" class="Function">y</a> <a id="1877" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1879" href="UTxO.TxUtilities.html#1841" class="Function">z</a>
    <a id="1885" href="UTxO.TxUtilities.html#1870" class="Function">∑≡</a> <a id="1888" class="Keyword">rewrite</a> <a id="1896" href="Data.List.Properties.html#3777" class="Function">map-compose</a> <a id="1908" class="Symbol">{</a><a id="1909" class="Argument">g</a> <a id="1911" class="Symbol">=</a> <a id="1913" href="UTxO.Types.html#4906" class="Field">value</a><a id="1918" class="Symbol">}</a> <a id="1920" class="Symbol">{</a><a id="1921" class="Argument">f</a> <a id="1923" class="Symbol">=</a> <a id="1925" href="UTxO.TxUtilities.html#599" class="Field">out</a><a id="1928" class="Symbol">}</a> <a id="1930" class="Symbol">(</a><a id="1931" href="Prelude.Membership.html#1363" class="Field">mapWith∈</a> <a id="1940" class="Symbol">(</a><a id="1941" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="1949" href="UTxO.TxUtilities.html#1493" class="Bound">tx</a><a id="1951" class="Symbol">)</a> <a id="1953" class="Symbol">(</a><a id="1954" href="UTxO.TxUtilities.html#656" class="Function">mkUtxo</a> <a id="1961" href="UTxO.TxUtilities.html#1493" class="Bound">tx</a><a id="1963" class="Symbol">))</a>
             <a id="1979" class="Symbol">|</a> <a id="1981" href="UTxO.TxUtilities.html#1014" class="Function">map-out≡</a> <a id="1990" href="UTxO.TxUtilities.html#1493" class="Bound">tx</a>
             <a id="2006" class="Symbol">=</a> <a id="2008" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="∈utxo⇒outRef≡"></a><a id="2014" href="UTxO.TxUtilities.html#2014" class="Function">∈utxo⇒outRef≡</a> <a id="2028" class="Symbol">:</a> <a id="2030" class="Symbol">∀</a> <a id="2032" class="Symbol">{</a><a id="2033" href="UTxO.TxUtilities.html#2033" class="Bound">u</a> <a id="2035" href="UTxO.TxUtilities.html#2035" class="Bound">l</a><a id="2036" class="Symbol">}</a>
  <a id="2040" class="Symbol">→</a> <a id="2042" href="UTxO.TxUtilities.html#2033" class="Bound">u</a> <a id="2044" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="2046" href="UTxO.TxUtilities.html#837" class="Function">utxo</a> <a id="2051" href="UTxO.TxUtilities.html#2035" class="Bound">l</a>
  <a id="2055" class="Symbol">→</a> <a id="2057" href="UTxO.TxUtilities.html#623" class="Field">prevTx</a> <a id="2064" href="UTxO.TxUtilities.html#2033" class="Bound">u</a> <a id="2066" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="2068" href="UTxO.TxUtilities.html#2035" class="Bound">l</a>
  <a id="2072" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2074" href="Data.Product.html#925" class="Function">Σ[</a> <a id="2077" href="UTxO.TxUtilities.html#2077" class="Bound">out∈</a> <a id="2082" href="Data.Product.html#925" class="Function">∈</a> <a id="2084" class="Symbol">(</a><a id="2085" href="UTxO.TxUtilities.html#599" class="Field">out</a> <a id="2089" href="UTxO.TxUtilities.html#2033" class="Bound">u</a> <a id="2091" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="2093" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="2101" class="Symbol">(</a><a id="2102" href="UTxO.TxUtilities.html#623" class="Field">prevTx</a> <a id="2109" href="UTxO.TxUtilities.html#2033" class="Bound">u</a><a id="2110" class="Symbol">))</a> <a id="2113" href="Data.Product.html#925" class="Function">]</a>
      <a id="2121" href="UTxO.TxUtilities.html#572" class="Field">outRef</a> <a id="2128" href="UTxO.TxUtilities.html#2033" class="Bound">u</a> <a id="2130" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="2132" class="Symbol">((</a><a id="2134" href="UTxO.TxUtilities.html#623" class="Field">prevTx</a> <a id="2141" href="UTxO.TxUtilities.html#2033" class="Bound">u</a><a id="2142" class="Symbol">)</a> <a id="2144" href="UTxO.Hashing.Types.html#1170" class="Function Operator">♯ₜₓ</a><a id="2147" class="Symbol">)</a> <a id="2149" href="UTxO.Types.html#4242" class="InductiveConstructor Operator">indexed-at</a> <a id="2160" href="Prelude.ToN.html#139" class="Field">toℕ</a> <a id="2164" class="Symbol">(</a><a id="2165" href="Data.List.Relation.Unary.Any.html#1826" class="Function">L.Any.index</a> <a id="2177" href="UTxO.TxUtilities.html#2077" class="Bound">out∈</a><a id="2181" class="Symbol">)</a>
<a id="2183" href="UTxO.TxUtilities.html#2014" class="Function">∈utxo⇒outRef≡</a> <a id="2197" class="Symbol">{</a><a id="2198" class="Argument">l</a> <a id="2200" class="Symbol">=</a> <a id="2202" href="UTxO.TxUtilities.html#2202" class="Bound">tx</a> <a id="2205" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2207" href="UTxO.TxUtilities.html#2207" class="Bound">l</a><a id="2208" class="Symbol">}</a> <a id="2210" href="UTxO.TxUtilities.html#2210" class="Bound">u∈</a>
  <a id="2215" class="Keyword">with</a> <a id="2220" href="Data.List.Membership.Propositional.Properties.html#4143" class="Function">∈-++⁻</a> <a id="2226" class="Symbol">(</a><a id="2227" href="Data.List.Base.html#8101" class="Function">filter</a> <a id="2234" class="Symbol">((</a><a id="2236" href="Prelude.Membership.html#613" class="Function Operator">_∉?</a> <a id="2240" href="UTxO.Types.html#8024" class="Function">outputRefs</a> <a id="2251" href="UTxO.TxUtilities.html#2202" class="Bound">tx</a><a id="2253" class="Symbol">)</a> <a id="2255" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2257" href="UTxO.TxUtilities.html#572" class="Field">outRef</a><a id="2263" class="Symbol">)</a> <a id="2265" class="Symbol">(</a><a id="2266" href="UTxO.TxUtilities.html#837" class="Function">utxo</a> <a id="2271" href="UTxO.TxUtilities.html#2207" class="Bound">l</a><a id="2272" class="Symbol">))</a> <a id="2275" href="UTxO.TxUtilities.html#2210" class="Bound">u∈</a>
<a id="2278" class="Symbol">...</a> <a id="2282" class="Symbol">|</a> <a id="2284" href="Data.Sum.Base.html#793" class="InductiveConstructor">inj₁</a> <a id="2289" href="UTxO.TxUtilities.html#2289" class="Bound">u∈ˡ</a> <a id="2293" class="Symbol">=</a> <a id="2295" href="Prelude.Bifunctor.html#930" class="Function">map₁</a> <a id="2300" href="Data.List.Relation.Unary.Any.html#1281" class="InductiveConstructor">there</a> <a id="2306" class="Symbol">(</a><a id="2307" href="UTxO.TxUtilities.html#2014" class="Function">∈utxo⇒outRef≡</a> <a id="2321" class="Symbol">(</a><a id="2322" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a> <a id="2328" class="Symbol">(</a><a id="2329" href="Data.List.Membership.Propositional.Properties.html#8622" class="Function">∈-filter⁻</a> <a id="2339" class="Symbol">((</a><a id="2341" href="Prelude.Membership.html#613" class="Function Operator">_∉?</a> <a id="2345" href="UTxO.Types.html#8024" class="Function">outputRefs</a> <a id="2356" class="Bound">tx</a><a id="2358" class="Symbol">)</a> <a id="2360" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2362" href="UTxO.TxUtilities.html#572" class="Field">outRef</a><a id="2368" class="Symbol">)</a> <a id="2370" href="UTxO.TxUtilities.html#2289" class="Bound">u∈ˡ</a><a id="2373" class="Symbol">)))</a>
<a id="2377" class="Symbol">...</a> <a id="2381" class="Symbol">|</a> <a id="2383" href="Data.Sum.Base.html#818" class="InductiveConstructor">inj₂</a> <a id="2388" href="UTxO.TxUtilities.html#2388" class="Bound">u∈ʳ</a> <a id="2392" class="Symbol">=</a> <a id="2394" class="Symbol">(</a><a id="2395" href="Prelude.Lists.Membership.html#4738" class="Function">mapWith∈-∀</a> <a id="2406" class="Symbol">{</a><a id="2407" class="Argument">P</a> <a id="2409" class="Symbol">=</a> <a id="2411" class="Symbol">λ</a> <a id="2413" href="UTxO.TxUtilities.html#2413" class="Bound">u</a> <a id="2415" class="Symbol">→</a> <a id="2417" href="UTxO.TxUtilities.html#623" class="Field">prevTx</a> <a id="2424" href="UTxO.TxUtilities.html#2413" class="Bound">u</a> <a id="2426" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="2428" class="Symbol">(</a><a id="2429" class="Bound">tx</a> <a id="2432" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2434" class="Bound">l</a><a id="2435" class="Symbol">)</a>
                                      <a id="2475" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2477" href="Data.Product.html#925" class="Function">Σ[</a> <a id="2480" href="UTxO.TxUtilities.html#2480" class="Bound">out∈</a> <a id="2485" href="Data.Product.html#925" class="Function">∈</a> <a id="2487" class="Symbol">(</a><a id="2488" href="UTxO.TxUtilities.html#599" class="Field">out</a> <a id="2492" href="UTxO.TxUtilities.html#2413" class="Bound">u</a> <a id="2494" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="2496" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="2504" class="Symbol">(</a><a id="2505" href="UTxO.TxUtilities.html#623" class="Field">prevTx</a> <a id="2512" href="UTxO.TxUtilities.html#2413" class="Bound">u</a><a id="2513" class="Symbol">))</a> <a id="2516" href="Data.Product.html#925" class="Function">]</a>
                                          <a id="2560" href="UTxO.TxUtilities.html#572" class="Field">outRef</a> <a id="2567" href="UTxO.TxUtilities.html#2413" class="Bound">u</a> <a id="2569" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="2571" class="Symbol">((</a><a id="2573" href="UTxO.TxUtilities.html#623" class="Field">prevTx</a> <a id="2580" href="UTxO.TxUtilities.html#2413" class="Bound">u</a><a id="2581" class="Symbol">)</a> <a id="2583" href="UTxO.Hashing.Types.html#1170" class="Function Operator">♯ₜₓ</a><a id="2586" class="Symbol">)</a> <a id="2588" href="UTxO.Types.html#4242" class="InductiveConstructor Operator">indexed-at</a> <a id="2599" href="Prelude.ToN.html#139" class="Field">toℕ</a> <a id="2603" class="Symbol">(</a><a id="2604" href="Data.List.Relation.Unary.Any.html#1826" class="Function">L.Any.index</a> <a id="2616" href="UTxO.TxUtilities.html#2480" class="Bound">out∈</a><a id="2620" class="Symbol">)}</a>
                             <a id="2652" class="Symbol">(λ</a> <a id="2655" href="UTxO.TxUtilities.html#2655" class="Bound">x∈</a> <a id="2658" class="Symbol">→</a> <a id="2660" href="Data.List.Relation.Unary.Any.html#1228" class="InductiveConstructor">here</a> <a id="2665" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="2670" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2672" href="UTxO.TxUtilities.html#2655" class="Bound">x∈</a> <a id="2675" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2677" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="2681" class="Symbol">))</a>
                             <a id="2713" href="UTxO.TxUtilities.html#2388" class="Bound">u∈ʳ</a>


<a id="2719" class="Comment">--------------------------------------------------------------------------------------</a>
<a id="2806" class="Comment">-- Pending transactions (i.e. parts of the transaction being passed to a validator).</a>

<a id="2892" class="Comment">-- auxiliary functions (from spec)</a>

<a id="_⟨_⟩"></a><a id="2928" href="UTxO.TxUtilities.html#2928" class="Function Operator">_⟨_⟩</a> <a id="2933" class="Symbol">:</a> <a id="2935" href="UTxO.Types.html#7888" class="Function">Ledger</a> <a id="2942" class="Symbol">→</a> <a id="2944" href="UTxO.Types.html#4204" class="Record">TxOutputRef</a> <a id="2956" class="Symbol">→</a> <a id="2958" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="2964" href="UTxO.Types.html#7568" class="Record">Tx</a>
<a id="2967" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2970" href="UTxO.TxUtilities.html#2928" class="Function Operator">⟨</a> <a id="2972" href="UTxO.TxUtilities.html#2972" class="Bound">or</a> <a id="2975" href="UTxO.TxUtilities.html#2928" class="Function Operator">⟩</a> <a id="2977" class="Symbol">=</a> <a id="2979" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>
<a id="2987" class="Symbol">(</a><a id="2988" href="UTxO.TxUtilities.html#2988" class="Bound">tx</a> <a id="2991" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2993" href="UTxO.TxUtilities.html#2993" class="Bound">l</a><a id="2994" class="Symbol">)</a> <a id="2996" href="UTxO.TxUtilities.html#2928" class="Function Operator">⟨</a> <a id="2998" href="UTxO.TxUtilities.html#2998" class="Bound">or</a> <a id="3001" href="UTxO.TxUtilities.html#2928" class="Function Operator">⟩</a>
  <a id="3005" class="Keyword">with</a> <a id="3010" href="UTxO.Types.html#4267" class="Field">hid</a> <a id="3014" href="UTxO.TxUtilities.html#2998" class="Bound">or</a> <a id="3017" href="Prelude.DecEq.Core.html#190" class="Field Operator">≟</a> <a id="3019" href="UTxO.TxUtilities.html#2988" class="Bound">tx</a> <a id="3022" href="UTxO.Hashing.Types.html#1170" class="Function Operator">♯ₜₓ</a>
<a id="3026" class="Symbol">...</a> <a id="3030" class="Symbol">|</a> <a id="3032" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="3036" class="Symbol">_</a> <a id="3038" class="Symbol">=</a> <a id="3040" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="3045" class="Bound">tx</a>
<a id="3048" class="Symbol">...</a> <a id="3052" class="Symbol">|</a> <a id="3054" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a>  <a id="3058" class="Symbol">_</a> <a id="3060" class="Symbol">=</a> <a id="3062" class="Bound">l</a> <a id="3064" href="UTxO.TxUtilities.html#2928" class="Function Operator">⟨</a> <a id="3066" class="Bound">or</a> <a id="3069" href="UTxO.TxUtilities.html#2928" class="Function Operator">⟩</a>

<a id="⟨⟩≡just"></a><a id="3072" href="UTxO.TxUtilities.html#3072" class="Function">⟨⟩≡just</a> <a id="3080" class="Symbol">:</a> <a id="3082" class="Symbol">∀</a> <a id="3084" class="Symbol">{</a><a id="3085" href="UTxO.TxUtilities.html#3085" class="Bound">l</a> <a id="3087" href="UTxO.TxUtilities.html#3087" class="Bound">or</a> <a id="3090" href="UTxO.TxUtilities.html#3090" class="Bound">tx</a><a id="3092" class="Symbol">}</a>
  <a id="3096" class="Symbol">→</a> <a id="3098" href="UTxO.TxUtilities.html#3085" class="Bound">l</a> <a id="3100" href="UTxO.TxUtilities.html#2928" class="Function Operator">⟨</a> <a id="3102" href="UTxO.TxUtilities.html#3087" class="Bound">or</a> <a id="3105" href="UTxO.TxUtilities.html#2928" class="Function Operator">⟩</a> <a id="3107" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3109" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="3114" href="UTxO.TxUtilities.html#3090" class="Bound">tx</a>
  <a id="3119" class="Symbol">→</a> <a id="3121" href="UTxO.Types.html#4267" class="Field">hid</a> <a id="3125" href="UTxO.TxUtilities.html#3087" class="Bound">or</a> <a id="3128" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3130" href="UTxO.TxUtilities.html#3090" class="Bound">tx</a> <a id="3133" href="UTxO.Hashing.Types.html#1170" class="Function Operator">♯ₜₓ</a>
<a id="3137" href="UTxO.TxUtilities.html#3072" class="Function">⟨⟩≡just</a> <a id="3145" class="Symbol">{</a><a id="3146" class="Argument">l</a> <a id="3148" class="Symbol">=</a> <a id="3150" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="3152" class="Symbol">}</a>              <a id="3167" class="Symbol">()</a>
<a id="3170" href="UTxO.TxUtilities.html#3072" class="Function">⟨⟩≡just</a> <a id="3178" class="Symbol">{</a><a id="3179" class="Argument">l</a> <a id="3181" class="Symbol">=</a> <a id="3183" href="UTxO.TxUtilities.html#3183" class="Bound">tx′</a> <a id="3187" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3189" href="UTxO.TxUtilities.html#3189" class="Bound">l</a><a id="3190" class="Symbol">}{</a><a id="3192" href="UTxO.TxUtilities.html#3192" class="Bound">or</a><a id="3194" class="Symbol">}{</a><a id="3196" href="UTxO.TxUtilities.html#3196" class="Bound">tx</a><a id="3198" class="Symbol">}</a> <a id="3200" href="UTxO.TxUtilities.html#3200" class="Bound">eq</a>
  <a id="3205" class="Keyword">with</a> <a id="3210" href="UTxO.Types.html#4267" class="Field">hid</a> <a id="3214" href="UTxO.TxUtilities.html#3192" class="Bound">or</a> <a id="3217" href="Prelude.DecEq.Core.html#190" class="Field Operator">≟</a> <a id="3219" href="UTxO.TxUtilities.html#3183" class="Bound">tx′</a> <a id="3223" href="UTxO.Hashing.Types.html#1170" class="Function Operator">♯ₜₓ</a> <a id="3227" class="Symbol">|</a> <a id="3229" href="UTxO.TxUtilities.html#3200" class="Bound">eq</a>
<a id="3232" class="Symbol">...</a> <a id="3236" class="Symbol">|</a> <a id="3238" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="3242" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="3247" class="Symbol">|</a> <a id="3249" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="3254" class="Symbol">=</a> <a id="3256" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
<a id="3261" class="Symbol">...</a> <a id="3265" class="Symbol">|</a> <a id="3267" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a>  <a id="3271" class="Symbol">_</a>    <a id="3276" class="Symbol">|</a> <a id="3278" href="UTxO.TxUtilities.html#3278" class="Bound">eq′</a>  <a id="3283" class="Symbol">=</a> <a id="3285" href="UTxO.TxUtilities.html#3072" class="Function">⟨⟩≡just</a> <a id="3293" class="Symbol">{</a><a id="3294" class="Bound">l</a><a id="3295" class="Symbol">}{</a><a id="3297" class="Bound">or</a><a id="3299" class="Symbol">}{</a><a id="3301" class="Bound">tx</a><a id="3303" class="Symbol">}</a> <a id="3305" href="UTxO.TxUtilities.html#3278" class="Bound">eq′</a>

<a id="utxo-outRef↔prevTx"></a><a id="3310" href="UTxO.TxUtilities.html#3310" class="Function">utxo-outRef↔prevTx</a> <a id="3329" class="Symbol">:</a> <a id="3331" class="Symbol">∀</a> <a id="3333" class="Symbol">{</a><a id="3334" href="UTxO.TxUtilities.html#3334" class="Bound">u</a> <a id="3336" href="UTxO.TxUtilities.html#3336" class="Bound">l</a><a id="3337" class="Symbol">}</a>
  <a id="3341" class="Symbol">→</a> <a id="3343" href="UTxO.TxUtilities.html#3334" class="Bound">u</a> <a id="3345" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="3347" href="UTxO.TxUtilities.html#837" class="Function">utxo</a> <a id="3352" href="UTxO.TxUtilities.html#3336" class="Bound">l</a>
  <a id="3356" class="Symbol">→</a> <a id="3358" href="UTxO.Types.html#4267" class="Field">hid</a> <a id="3362" class="Symbol">(</a><a id="3363" href="UTxO.TxUtilities.html#572" class="Field">outRef</a> <a id="3370" href="UTxO.TxUtilities.html#3334" class="Bound">u</a><a id="3371" class="Symbol">)</a> <a id="3373" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3375" href="UTxO.TxUtilities.html#623" class="Field">prevTx</a> <a id="3382" href="UTxO.TxUtilities.html#3334" class="Bound">u</a> <a id="3384" href="UTxO.Hashing.Types.html#1170" class="Function Operator">♯ₜₓ</a>
<a id="3388" href="UTxO.TxUtilities.html#3310" class="Function">utxo-outRef↔prevTx</a> <a id="3407" class="Symbol">{</a><a id="3408" href="UTxO.TxUtilities.html#3408" class="Bound">u</a><a id="3409" class="Symbol">}</a> <a id="3411" class="Symbol">{</a><a id="3412" href="UTxO.TxUtilities.html#3412" class="Bound">l</a><a id="3413" class="Symbol">}</a> <a id="3415" href="UTxO.TxUtilities.html#3415" class="Bound">u∈</a>
  <a id="3420" class="Keyword">rewrite</a> <a id="3428" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a> <a id="3434" class="Symbol">(</a><a id="3435" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a> <a id="3441" class="Symbol">(</a><a id="3442" href="UTxO.TxUtilities.html#2014" class="Function">∈utxo⇒outRef≡</a> <a id="3456" class="Symbol">{</a><a id="3457" href="UTxO.TxUtilities.html#3408" class="Bound">u</a><a id="3458" class="Symbol">}</a> <a id="3460" class="Symbol">{</a><a id="3461" href="UTxO.TxUtilities.html#3412" class="Bound">l</a><a id="3462" class="Symbol">}</a> <a id="3464" href="UTxO.TxUtilities.html#3415" class="Bound">u∈</a><a id="3466" class="Symbol">))</a>
        <a id="3477" class="Symbol">=</a> <a id="3479" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="utxo-∈ʳ"></a><a id="3485" href="UTxO.TxUtilities.html#3485" class="Function">utxo-∈ʳ</a> <a id="3493" class="Symbol">:</a> <a id="3495" class="Symbol">∀</a> <a id="3497" class="Symbol">{</a><a id="3498" href="UTxO.TxUtilities.html#3498" class="Bound">u</a> <a id="3500" href="UTxO.TxUtilities.html#3500" class="Bound">tx</a><a id="3502" class="Symbol">}</a>
  <a id="3506" class="Symbol">→</a> <a id="3508" href="UTxO.TxUtilities.html#3498" class="Bound">u</a> <a id="3510" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="3512" href="Prelude.Membership.html#1363" class="Field">mapWith∈</a> <a id="3521" class="Symbol">(</a><a id="3522" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="3530" href="UTxO.TxUtilities.html#3500" class="Bound">tx</a><a id="3532" class="Symbol">)</a> <a id="3534" class="Symbol">(</a><a id="3535" href="UTxO.TxUtilities.html#656" class="Function">mkUtxo</a> <a id="3542" href="UTxO.TxUtilities.html#3500" class="Bound">tx</a><a id="3544" class="Symbol">)</a>
  <a id="3548" class="Symbol">→</a> <a id="3550" href="UTxO.TxUtilities.html#3500" class="Bound">tx</a> <a id="3553" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3555" href="UTxO.TxUtilities.html#623" class="Field">prevTx</a> <a id="3562" href="UTxO.TxUtilities.html#3498" class="Bound">u</a>
<a id="3564" href="UTxO.TxUtilities.html#3485" class="Function">utxo-∈ʳ</a> <a id="3572" class="Symbol">{</a><a id="3573" href="UTxO.TxUtilities.html#3573" class="Bound">u</a><a id="3574" class="Symbol">}</a> <a id="3576" class="Symbol">{</a><a id="3577" href="UTxO.TxUtilities.html#3577" class="Bound">tx</a><a id="3579" class="Symbol">}</a> <a id="3581" class="Symbol">=</a> <a id="3583" href="Prelude.Lists.Membership.html#4738" class="Function">mapWith∈-∀</a> <a id="3594" class="Symbol">{</a><a id="3595" class="Argument">P</a> <a id="3597" class="Symbol">=</a> <a id="3599" class="Symbol">(</a><a id="3600" href="UTxO.TxUtilities.html#3577" class="Bound">tx</a> <a id="3603" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡_</a><a id="3605" class="Symbol">)</a> <a id="3607" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3609" href="UTxO.TxUtilities.html#623" class="Field">prevTx</a><a id="3615" class="Symbol">}</a> <a id="3617" class="Symbol">λ</a> <a id="3619" href="UTxO.TxUtilities.html#3619" class="Bound">_</a> <a id="3621" class="Symbol">→</a> <a id="3623" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="utxo-≢"></a><a id="3629" href="UTxO.TxUtilities.html#3629" class="Function">utxo-≢</a> <a id="3636" class="Symbol">:</a> <a id="3638" class="Symbol">∀</a> <a id="3640" class="Symbol">{</a><a id="3641" href="UTxO.TxUtilities.html#3641" class="Bound">l</a> <a id="3643" href="UTxO.TxUtilities.html#3643" class="Bound">u</a> <a id="3645" href="UTxO.TxUtilities.html#3645" class="Bound">tx</a><a id="3647" class="Symbol">}</a>
  <a id="3651" class="Symbol">→</a> <a id="3653" href="UTxO.TxUtilities.html#3643" class="Bound">u</a> <a id="3655" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="3657" href="UTxO.TxUtilities.html#837" class="Function">utxo</a> <a id="3662" class="Symbol">(</a><a id="3663" href="UTxO.TxUtilities.html#3645" class="Bound">tx</a> <a id="3666" class="InductiveConstructor Operator">∷</a> <a id="3668" href="UTxO.TxUtilities.html#3641" class="Bound">l</a><a id="3669" class="Symbol">)</a>
  <a id="3673" class="Symbol">→</a> <a id="3675" href="UTxO.Types.html#4267" class="Field">hid</a> <a id="3679" class="Symbol">(</a><a id="3680" href="UTxO.TxUtilities.html#572" class="Field">outRef</a> <a id="3687" href="UTxO.TxUtilities.html#3643" class="Bound">u</a><a id="3688" class="Symbol">)</a> <a id="3690" href="Relation.Binary.PropositionalEquality.Core.html#839" class="Function Operator">≢</a> <a id="3692" href="UTxO.TxUtilities.html#3645" class="Bound">tx</a> <a id="3695" href="UTxO.Hashing.Types.html#1170" class="Function Operator">♯ₜₓ</a>
  <a id="3701" class="Symbol">→</a> <a id="3703" href="UTxO.TxUtilities.html#3643" class="Bound">u</a> <a id="3705" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="3707" href="UTxO.TxUtilities.html#837" class="Function">utxo</a> <a id="3712" href="UTxO.TxUtilities.html#3641" class="Bound">l</a>
<a id="3714" href="UTxO.TxUtilities.html#3629" class="Function">utxo-≢</a> <a id="3721" class="Symbol">{</a><a id="3722" href="UTxO.TxUtilities.html#3722" class="Bound">l</a><a id="3723" class="Symbol">}</a> <a id="3725" class="Symbol">{</a><a id="3726" href="UTxO.TxUtilities.html#3726" class="Bound">u</a><a id="3727" class="Symbol">}</a> <a id="3729" class="Symbol">{</a><a id="3730" href="UTxO.TxUtilities.html#3730" class="Bound">tx</a><a id="3732" class="Symbol">}</a> <a id="3734" href="UTxO.TxUtilities.html#3734" class="Bound">u∈</a> <a id="3737" href="UTxO.TxUtilities.html#3737" class="Bound">¬p</a>
  <a id="3742" class="Keyword">with</a> <a id="3747" href="Data.List.Membership.Propositional.Properties.html#4143" class="Function">∈-++⁻</a> <a id="3753" class="Symbol">(</a><a id="3754" href="Data.List.Base.html#8101" class="Function">filter</a> <a id="3761" class="Symbol">((</a><a id="3763" href="Prelude.Membership.html#613" class="Function Operator">_∉?</a> <a id="3767" href="UTxO.Types.html#8024" class="Function">outputRefs</a> <a id="3778" href="UTxO.TxUtilities.html#3730" class="Bound">tx</a><a id="3780" class="Symbol">)</a> <a id="3782" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3784" href="UTxO.TxUtilities.html#572" class="Field">outRef</a><a id="3790" class="Symbol">)</a> <a id="3792" class="Symbol">(</a><a id="3793" href="UTxO.TxUtilities.html#837" class="Function">utxo</a> <a id="3798" href="UTxO.TxUtilities.html#3722" class="Bound">l</a><a id="3799" class="Symbol">))</a> <a id="3802" href="UTxO.TxUtilities.html#3734" class="Bound">u∈</a>
<a id="3805" class="Symbol">...</a> <a id="3809" class="Symbol">|</a> <a id="3811" href="Data.Sum.Base.html#793" class="InductiveConstructor">inj₁</a> <a id="3816" href="UTxO.TxUtilities.html#3816" class="Bound">u∈ˡ</a>
    <a id="3824" class="Symbol">=</a> <a id="3826" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a> <a id="3832" class="Symbol">(</a><a id="3833" href="Data.List.Membership.Propositional.Properties.html#8622" class="Function">∈-filter⁻</a> <a id="3843" class="Symbol">((</a><a id="3845" href="Prelude.Membership.html#613" class="Function Operator">_∉?</a> <a id="3849" href="UTxO.Types.html#8024" class="Function">outputRefs</a> <a id="3860" class="Bound">tx</a><a id="3862" class="Symbol">)</a> <a id="3864" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="3866" href="UTxO.TxUtilities.html#572" class="Field">outRef</a><a id="3872" class="Symbol">)</a> <a id="3874" class="Symbol">{</a><a id="3875" class="Argument">v</a> <a id="3877" class="Symbol">=</a> <a id="3879" class="Bound">u</a><a id="3880" class="Symbol">}</a> <a id="3882" class="Symbol">{</a><a id="3883" class="Argument">xs</a> <a id="3886" class="Symbol">=</a> <a id="3888" href="UTxO.TxUtilities.html#837" class="Function">utxo</a> <a id="3893" class="Bound">l</a><a id="3894" class="Symbol">}</a> <a id="3896" href="UTxO.TxUtilities.html#3816" class="Bound">u∈ˡ</a><a id="3899" class="Symbol">)</a>
<a id="3901" class="Symbol">...</a> <a id="3905" class="Symbol">|</a> <a id="3907" href="Data.Sum.Base.html#818" class="InductiveConstructor">inj₂</a> <a id="3912" href="UTxO.TxUtilities.html#3912" class="Bound">u∈ʳ</a>
    <a id="3920" class="Symbol">=</a> <a id="3922" href="Data.Empty.html#637" class="Function">⊥-elim</a> <a id="3929" class="Symbol">(</a><a id="3930" class="Bound">¬p</a> <a id="3933" class="Symbol">(</a><a id="3934" href="Relation.Binary.PropositionalEquality.Core.html#1738" class="Function">trans</a> <a id="3940" class="Symbol">(</a><a id="3941" href="UTxO.TxUtilities.html#3310" class="Function">utxo-outRef↔prevTx</a> <a id="3960" class="Symbol">{</a><a id="3961" class="Bound">u</a><a id="3962" class="Symbol">}</a> <a id="3964" class="Symbol">{</a><a id="3965" class="Bound">tx</a> <a id="3968" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3970" class="Bound">l</a><a id="3971" class="Symbol">}</a> <a id="3973" class="Bound">u∈</a><a id="3975" class="Symbol">)</a> <a id="3977" class="Symbol">(</a><a id="3978" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a> <a id="3982" class="Symbol">(</a><a id="3983" href="Relation.Binary.PropositionalEquality.Core.html#1139" class="Function">cong</a> <a id="3988" href="UTxO.Hashing.Types.html#1170" class="Function Operator">_♯ₜₓ</a> <a id="3993" class="Symbol">(</a><a id="3994" href="UTxO.TxUtilities.html#3485" class="Function">utxo-∈ʳ</a> <a id="4002" class="Symbol">{</a><a id="4003" class="Bound">u</a><a id="4004" class="Symbol">}</a> <a id="4006" class="Symbol">{</a><a id="4007" class="Bound">tx</a><a id="4009" class="Symbol">}</a> <a id="4011" href="UTxO.TxUtilities.html#3912" class="Bound">u∈ʳ</a><a id="4014" class="Symbol">)))))</a>

<a id="utxo-[]"></a><a id="4021" href="UTxO.TxUtilities.html#4021" class="Function">utxo-[]</a> <a id="4029" class="Symbol">:</a> <a id="4031" class="Symbol">∀</a> <a id="4033" class="Symbol">{</a><a id="4034" href="UTxO.TxUtilities.html#4034" class="Bound">l</a> <a id="4036" href="UTxO.TxUtilities.html#4036" class="Bound">u</a><a id="4037" class="Symbol">}</a>
  <a id="4041" class="Symbol">→</a> <a id="4043" href="UTxO.TxUtilities.html#4036" class="Bound">u</a> <a id="4045" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="4047" href="UTxO.TxUtilities.html#837" class="Function">utxo</a> <a id="4052" href="UTxO.TxUtilities.html#4034" class="Bound">l</a>
  <a id="4056" class="Symbol">→</a> <a id="4058" href="UTxO.TxUtilities.html#4034" class="Bound">l</a> <a id="4060" href="UTxO.TxUtilities.html#2928" class="Function Operator">⟨</a> <a id="4062" href="UTxO.TxUtilities.html#572" class="Field">outRef</a> <a id="4069" href="UTxO.TxUtilities.html#4036" class="Bound">u</a> <a id="4071" href="UTxO.TxUtilities.html#2928" class="Function Operator">⟩</a> <a id="4073" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4075" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="4080" class="Symbol">(</a><a id="4081" href="UTxO.TxUtilities.html#623" class="Field">prevTx</a> <a id="4088" href="UTxO.TxUtilities.html#4036" class="Bound">u</a><a id="4089" class="Symbol">)</a>
<a id="4091" href="UTxO.TxUtilities.html#4021" class="Function">utxo-[]</a> <a id="4099" class="Symbol">{</a><a id="4100" class="Argument">l</a> <a id="4102" class="Symbol">=</a> <a id="4104" href="UTxO.TxUtilities.html#4104" class="Bound">tx</a> <a id="4107" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="4109" href="UTxO.TxUtilities.html#4109" class="Bound">l</a><a id="4110" class="Symbol">}</a> <a id="4112" class="Symbol">{</a><a id="4113" href="UTxO.TxUtilities.html#4113" class="Bound">u</a><a id="4114" class="Symbol">}</a> <a id="4116" href="UTxO.TxUtilities.html#4116" class="Bound">u∈</a>
  <a id="4121" class="Keyword">with</a> <a id="4126" href="UTxO.Types.html#4267" class="Field">hid</a> <a id="4130" class="Symbol">(</a><a id="4131" href="UTxO.TxUtilities.html#572" class="Field">outRef</a> <a id="4138" href="UTxO.TxUtilities.html#4113" class="Bound">u</a><a id="4139" class="Symbol">)</a> <a id="4141" href="Prelude.DecEq.Core.html#190" class="Field Operator">≟</a> <a id="4143" href="UTxO.TxUtilities.html#4104" class="Bound">tx</a> <a id="4146" href="UTxO.Hashing.Types.html#1170" class="Function Operator">♯ₜₓ</a>
<a id="4150" class="Symbol">...</a> <a id="4154" class="Symbol">|</a> <a id="4156" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="4160" href="UTxO.TxUtilities.html#4160" class="Bound">p</a>
  <a id="4164" class="Keyword">rewrite</a> <a id="4172" href="UTxO.Hashing.Types.html#1690" class="Postulate">injective♯ₜₓ</a> <a id="4185" class="Symbol">{</a><a id="4186" class="Argument">x</a> <a id="4188" class="Symbol">=</a> <a id="4190" href="UTxO.TxUtilities.html#623" class="Field">prevTx</a> <a id="4197" class="Bound">u</a><a id="4198" class="Symbol">}</a> <a id="4200" class="Symbol">{</a><a id="4201" class="Argument">y</a> <a id="4203" class="Symbol">=</a> <a id="4205" class="Bound">tx</a><a id="4207" class="Symbol">}</a> <a id="4209" class="Symbol">(</a><a id="4210" href="Relation.Binary.PropositionalEquality.Core.html#1738" class="Function">trans</a> <a id="4216" class="Symbol">(</a><a id="4217" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a> <a id="4221" class="Symbol">(</a><a id="4222" href="UTxO.TxUtilities.html#3310" class="Function">utxo-outRef↔prevTx</a> <a id="4241" class="Symbol">{</a><a id="4242" class="Bound">u</a><a id="4243" class="Symbol">}</a> <a id="4245" class="Symbol">{</a><a id="4246" class="Bound">tx</a> <a id="4249" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="4251" class="Bound">l</a><a id="4252" class="Symbol">}</a> <a id="4254" class="Bound">u∈</a><a id="4256" class="Symbol">))</a> <a id="4259" href="UTxO.TxUtilities.html#4160" class="Bound">p</a><a id="4260" class="Symbol">)</a>
    <a id="4266" class="Symbol">=</a> <a id="4268" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
<a id="4273" class="Symbol">...</a> <a id="4277" class="Symbol">|</a> <a id="4279" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="4282" href="UTxO.TxUtilities.html#4282" class="Bound">¬p</a> <a id="4285" class="Symbol">=</a> <a id="4287" href="UTxO.TxUtilities.html#4021" class="Function">utxo-[]</a> <a id="4295" class="Symbol">{</a><a id="4296" class="Bound">l</a><a id="4297" class="Symbol">}</a> <a id="4299" class="Symbol">(</a><a id="4300" href="UTxO.TxUtilities.html#3629" class="Function">utxo-≢</a> <a id="4307" class="Symbol">{</a><a id="4308" class="Bound">l</a><a id="4309" class="Symbol">}</a> <a id="4311" class="Symbol">{</a><a id="4312" class="Bound">u</a><a id="4313" class="Symbol">}</a> <a id="4315" class="Symbol">{</a><a id="4316" class="Bound">tx</a><a id="4318" class="Symbol">}</a> <a id="4320" class="Bound">u∈</a> <a id="4323" href="UTxO.TxUtilities.html#4282" class="Bound">¬p</a><a id="4325" class="Symbol">)</a>

<a id="_⟦_⟧"></a><a id="4328" href="UTxO.TxUtilities.html#4328" class="Function Operator">_⟦_⟧</a> <a id="4333" class="Symbol">:</a> <a id="4335" class="Symbol">{</a><a id="4336" href="UTxO.TxUtilities.html#4336" class="Bound">X</a> <a id="4338" class="Symbol">:</a> <a id="4340" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="4343" class="Symbol">}</a> <a id="4345" class="Symbol">→</a> <a id="4347" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="4352" href="UTxO.TxUtilities.html#4336" class="Bound">X</a> <a id="4354" class="Symbol">→</a> <a id="4356" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="4358" class="Symbol">→</a> <a id="4360" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="4366" href="UTxO.TxUtilities.html#4336" class="Bound">X</a>
<a id="4368" href="UTxO.TxUtilities.html#4328" class="Function Operator">_⟦_⟧</a> <a id="4373" class="Symbol">=</a> <a id="4375" href="Prelude.Lists.Indexed.html#663" class="Function Operator">_⁉_</a>

<a id="utxo-⟨⟩"></a><a id="4380" href="UTxO.TxUtilities.html#4380" class="Function">utxo-⟨⟩</a> <a id="4388" class="Symbol">:</a> <a id="4390" class="Symbol">∀</a> <a id="4392" class="Symbol">{</a><a id="4393" href="UTxO.TxUtilities.html#4393" class="Bound">l</a> <a id="4395" href="UTxO.TxUtilities.html#4395" class="Bound">u</a><a id="4396" class="Symbol">}</a>
  <a id="4400" class="Symbol">→</a> <a id="4402" href="UTxO.TxUtilities.html#4395" class="Bound">u</a> <a id="4404" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="4406" href="UTxO.TxUtilities.html#837" class="Function">utxo</a> <a id="4411" href="UTxO.TxUtilities.html#4393" class="Bound">l</a>
  <a id="4415" class="Symbol">→</a> <a id="4417" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="4425" class="Symbol">(</a><a id="4426" href="UTxO.TxUtilities.html#623" class="Field">prevTx</a> <a id="4433" href="UTxO.TxUtilities.html#4395" class="Bound">u</a><a id="4434" class="Symbol">)</a> <a id="4436" href="UTxO.TxUtilities.html#4328" class="Function Operator">⟦</a> <a id="4438" href="UTxO.Types.html#4324" class="Field">index</a> <a id="4444" class="Symbol">(</a><a id="4445" href="UTxO.TxUtilities.html#572" class="Field">outRef</a> <a id="4452" href="UTxO.TxUtilities.html#4395" class="Bound">u</a><a id="4453" class="Symbol">)</a> <a id="4455" href="UTxO.TxUtilities.html#4328" class="Function Operator">⟧</a> <a id="4457" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4459" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="4464" class="Symbol">(</a><a id="4465" href="UTxO.TxUtilities.html#599" class="Field">out</a> <a id="4469" href="UTxO.TxUtilities.html#4395" class="Bound">u</a><a id="4470" class="Symbol">)</a>
<a id="4472" href="UTxO.TxUtilities.html#4380" class="Function">utxo-⟨⟩</a> <a id="4480" class="Symbol">{</a><a id="4481" href="UTxO.TxUtilities.html#4481" class="Bound">tx</a> <a id="4484" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="4486" href="UTxO.TxUtilities.html#4486" class="Bound">l</a><a id="4487" class="Symbol">}</a> <a id="4489" class="Symbol">{</a><a id="4490" href="UTxO.TxUtilities.html#4490" class="Bound">u</a><a id="4491" class="Symbol">}</a> <a id="4493" href="UTxO.TxUtilities.html#4493" class="Bound">u∈</a>
  <a id="4498" class="Keyword">with</a> <a id="4503" href="Data.List.Membership.Propositional.Properties.html#4143" class="Function">∈-++⁻</a> <a id="4509" class="Symbol">(</a><a id="4510" href="Data.List.Base.html#8101" class="Function">filter</a> <a id="4517" class="Symbol">((</a><a id="4519" href="Prelude.Membership.html#613" class="Function Operator">_∉?</a> <a id="4523" href="UTxO.Types.html#8024" class="Function">outputRefs</a> <a id="4534" href="UTxO.TxUtilities.html#4481" class="Bound">tx</a><a id="4536" class="Symbol">)</a> <a id="4538" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4540" href="UTxO.TxUtilities.html#572" class="Field">outRef</a><a id="4546" class="Symbol">)</a> <a id="4548" class="Symbol">(</a><a id="4549" href="UTxO.TxUtilities.html#837" class="Function">utxo</a> <a id="4554" href="UTxO.TxUtilities.html#4486" class="Bound">l</a><a id="4555" class="Symbol">))</a> <a id="4558" href="UTxO.TxUtilities.html#4493" class="Bound">u∈</a>
<a id="4561" class="Symbol">...</a> <a id="4565" class="Symbol">|</a> <a id="4567" href="Data.Sum.Base.html#793" class="InductiveConstructor">inj₁</a> <a id="4572" href="UTxO.TxUtilities.html#4572" class="Bound">u∈ˡ</a>
    <a id="4580" class="Symbol">=</a> <a id="4582" href="UTxO.TxUtilities.html#4380" class="Function">utxo-⟨⟩</a> <a id="4590" class="Symbol">{</a><a id="4591" class="Bound">l</a><a id="4592" class="Symbol">}</a> <a id="4594" class="Symbol">{</a><a id="4595" class="Bound">u</a><a id="4596" class="Symbol">}</a> <a id="4598" class="Symbol">(</a><a id="4599" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a> <a id="4605" class="Symbol">(</a><a id="4606" href="Data.List.Membership.Propositional.Properties.html#8622" class="Function">∈-filter⁻</a> <a id="4616" class="Symbol">((</a><a id="4618" href="Prelude.Membership.html#613" class="Function Operator">_∉?</a> <a id="4622" href="UTxO.Types.html#8024" class="Function">outputRefs</a> <a id="4633" class="Bound">tx</a><a id="4635" class="Symbol">)</a> <a id="4637" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4639" href="UTxO.TxUtilities.html#572" class="Field">outRef</a><a id="4645" class="Symbol">)</a> <a id="4647" class="Symbol">{</a><a id="4648" class="Argument">v</a> <a id="4650" class="Symbol">=</a> <a id="4652" class="Bound">u</a><a id="4653" class="Symbol">}</a> <a id="4655" class="Symbol">{</a><a id="4656" class="Argument">xs</a> <a id="4659" class="Symbol">=</a> <a id="4661" href="UTxO.TxUtilities.html#837" class="Function">utxo</a> <a id="4666" class="Bound">l</a><a id="4667" class="Symbol">}</a> <a id="4669" href="UTxO.TxUtilities.html#4572" class="Bound">u∈ˡ</a><a id="4672" class="Symbol">))</a>
<a id="4675" class="Symbol">...</a> <a id="4679" class="Symbol">|</a> <a id="4681" href="Data.Sum.Base.html#818" class="InductiveConstructor">inj₂</a> <a id="4686" href="UTxO.TxUtilities.html#4686" class="Bound">u∈ʳ</a>
    <a id="4694" class="Symbol">=</a> <a id="4696" href="Prelude.Lists.Membership.html#4738" class="Function">mapWith∈-∀</a> <a id="4707" class="Symbol">{</a><a id="4708" class="Argument">P</a> <a id="4710" class="Symbol">=</a> <a id="4712" class="Symbol">λ</a> <a id="4714" href="UTxO.TxUtilities.html#4714" class="Bound">u</a> <a id="4716" class="Symbol">→</a> <a id="4718" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="4726" class="Symbol">(</a><a id="4727" href="UTxO.TxUtilities.html#623" class="Field">prevTx</a> <a id="4734" href="UTxO.TxUtilities.html#4714" class="Bound">u</a><a id="4735" class="Symbol">)</a> <a id="4737" href="UTxO.TxUtilities.html#4328" class="Function Operator">⟦</a> <a id="4739" href="UTxO.Types.html#4324" class="Field">index</a> <a id="4745" class="Symbol">(</a><a id="4746" href="UTxO.TxUtilities.html#572" class="Field">outRef</a> <a id="4753" href="UTxO.TxUtilities.html#4714" class="Bound">u</a><a id="4754" class="Symbol">)</a> <a id="4756" href="UTxO.TxUtilities.html#4328" class="Function Operator">⟧</a> <a id="4758" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4760" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="4765" class="Symbol">(</a><a id="4766" href="UTxO.TxUtilities.html#599" class="Field">out</a> <a id="4770" href="UTxO.TxUtilities.html#4714" class="Bound">u</a><a id="4771" class="Symbol">)}</a>
                 <a id="4791" class="Symbol">(λ</a> <a id="4794" href="UTxO.TxUtilities.html#4794" class="Bound">x∈</a> <a id="4797" class="Symbol">→</a> <a id="4799" href="Relation.Binary.PropositionalEquality.Core.html#1738" class="Function">trans</a> <a id="4805" class="Symbol">(</a><a id="4806" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a> <a id="4810" class="Symbol">(</a><a id="4811" href="Prelude.Lists.Indexed.html#10267" class="Function">‼→⁉</a> <a id="4815" class="Symbol">{</a><a id="4816" class="Argument">xs</a> <a id="4819" class="Symbol">=</a> <a id="4821" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="4829" class="Bound">tx</a><a id="4831" class="Symbol">}</a> <a id="4833" class="Symbol">{</a><a id="4834" class="Argument">ix</a> <a id="4837" class="Symbol">=</a> <a id="4839" href="Data.List.Relation.Unary.Any.html#1826" class="Function">L.Any.index</a> <a id="4851" href="UTxO.TxUtilities.html#4794" class="Bound">x∈</a><a id="4853" class="Symbol">}))</a> <a id="4857" class="Symbol">(</a><a id="4858" href="Relation.Binary.PropositionalEquality.Core.html#1139" class="Function">cong</a> <a id="4863" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="4868" class="Symbol">(</a><a id="4869" href="Prelude.Lists.Indexed.html#10450" class="Function">‼-index</a> <a id="4877" href="UTxO.TxUtilities.html#4794" class="Bound">x∈</a><a id="4879" class="Symbol">)))</a> <a id="4883" href="UTxO.TxUtilities.html#4686" class="Bound">u∈ʳ</a>

<a id="getSpentOutputRef"></a><a id="4888" href="UTxO.TxUtilities.html#4888" class="Function">getSpentOutputRef</a> <a id="4906" class="Symbol">:</a> <a id="4908" href="UTxO.Types.html#7888" class="Function">Ledger</a> <a id="4915" class="Symbol">→</a> <a id="4917" href="UTxO.Types.html#4204" class="Record">TxOutputRef</a> <a id="4929" class="Symbol">→</a> <a id="4931" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="4937" href="UTxO.Types.html#4814" class="Record">TxOutput</a>
<a id="4946" href="UTxO.TxUtilities.html#4888" class="Function">getSpentOutputRef</a> <a id="4964" href="UTxO.TxUtilities.html#4964" class="Bound">l</a> <a id="4966" href="UTxO.TxUtilities.html#4966" class="Bound">oRef</a> <a id="4971" class="Symbol">=</a>
  <a id="4975" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="4983" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="4987" class="Symbol">(</a><a id="4988" href="UTxO.TxUtilities.html#4964" class="Bound">l</a> <a id="4990" href="UTxO.TxUtilities.html#2928" class="Function Operator">⟨</a> <a id="4992" href="UTxO.TxUtilities.html#4966" class="Bound">oRef</a> <a id="4997" href="UTxO.TxUtilities.html#2928" class="Function Operator">⟩</a><a id="4998" class="Symbol">)</a> <a id="5000" href="Prelude.Monad.html#590" class="Field Operator">&gt;&gt;=</a> <a id="5004" href="UTxO.TxUtilities.html#4328" class="Function Operator">_⟦</a> <a id="5007" href="UTxO.Types.html#4324" class="Field">index</a> <a id="5013" href="UTxO.TxUtilities.html#4966" class="Bound">oRef</a> <a id="5018" href="UTxO.TxUtilities.html#4328" class="Function Operator">⟧</a>

<a id="getSpentOutput"></a><a id="5021" href="UTxO.TxUtilities.html#5021" class="Function">getSpentOutput</a> <a id="5036" class="Symbol">:</a> <a id="5038" href="UTxO.Types.html#7888" class="Function">Ledger</a> <a id="5045" class="Symbol">→</a> <a id="5047" href="UTxO.Types.html#7416" class="Record">TxInput</a> <a id="5055" class="Symbol">→</a> <a id="5057" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="5063" href="UTxO.Types.html#4814" class="Record">TxOutput</a>
<a id="5072" href="UTxO.TxUtilities.html#5021" class="Function">getSpentOutput</a> <a id="5087" href="UTxO.TxUtilities.html#5087" class="Bound">l</a> <a id="5089" href="UTxO.TxUtilities.html#5089" class="Bound">i</a> <a id="5091" class="Symbol">=</a> <a id="5093" href="UTxO.TxUtilities.html#4888" class="Function">getSpentOutputRef</a> <a id="5111" href="UTxO.TxUtilities.html#5087" class="Bound">l</a> <a id="5113" class="Symbol">(</a><a id="5114" href="UTxO.Types.html#7448" class="Field">outputRef</a> <a id="5124" href="UTxO.TxUtilities.html#5089" class="Bound">i</a><a id="5125" class="Symbol">)</a>

<a id="utxo-getSpent"></a><a id="5128" href="UTxO.TxUtilities.html#5128" class="Function">utxo-getSpent</a> <a id="5142" class="Symbol">:</a> <a id="5144" class="Symbol">∀</a> <a id="5146" class="Symbol">{</a><a id="5147" href="UTxO.TxUtilities.html#5147" class="Bound">l</a> <a id="5149" href="UTxO.TxUtilities.html#5149" class="Bound">u</a><a id="5150" class="Symbol">}</a>
  <a id="5154" class="Symbol">→</a> <a id="5156" href="UTxO.TxUtilities.html#5149" class="Bound">u</a> <a id="5158" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="5160" href="UTxO.TxUtilities.html#837" class="Function">utxo</a> <a id="5165" href="UTxO.TxUtilities.html#5147" class="Bound">l</a>
  <a id="5169" class="Symbol">→</a> <a id="5171" href="UTxO.TxUtilities.html#4888" class="Function">getSpentOutputRef</a> <a id="5189" href="UTxO.TxUtilities.html#5147" class="Bound">l</a> <a id="5191" class="Symbol">(</a><a id="5192" href="UTxO.TxUtilities.html#572" class="Field">outRef</a> <a id="5199" href="UTxO.TxUtilities.html#5149" class="Bound">u</a><a id="5200" class="Symbol">)</a> <a id="5202" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="5204" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="5209" class="Symbol">(</a><a id="5210" href="UTxO.TxUtilities.html#599" class="Field">out</a> <a id="5214" href="UTxO.TxUtilities.html#5149" class="Bound">u</a><a id="5215" class="Symbol">)</a>
<a id="5217" href="UTxO.TxUtilities.html#5128" class="Function">utxo-getSpent</a> <a id="5231" class="Symbol">{</a><a id="5232" href="UTxO.TxUtilities.html#5232" class="Bound">l</a><a id="5233" class="Symbol">}</a> <a id="5235" class="Symbol">{</a><a id="5236" href="UTxO.TxUtilities.html#5236" class="Bound">u</a><a id="5237" class="Symbol">}</a> <a id="5239" href="UTxO.TxUtilities.html#5239" class="Bound">u∈</a>
  <a id="5244" class="Keyword">rewrite</a> <a id="5252" href="UTxO.TxUtilities.html#4021" class="Function">utxo-[]</a> <a id="5260" class="Symbol">{</a><a id="5261" href="UTxO.TxUtilities.html#5232" class="Bound">l</a><a id="5262" class="Symbol">}</a> <a id="5264" class="Symbol">{</a><a id="5265" href="UTxO.TxUtilities.html#5236" class="Bound">u</a><a id="5266" class="Symbol">}</a> <a id="5268" href="UTxO.TxUtilities.html#5239" class="Bound">u∈</a>
        <a id="5279" class="Symbol">|</a> <a id="5281" href="UTxO.TxUtilities.html#4380" class="Function">utxo-⟨⟩</a> <a id="5289" class="Symbol">{</a><a id="5290" href="UTxO.TxUtilities.html#5232" class="Bound">l</a><a id="5291" class="Symbol">}</a> <a id="5293" class="Symbol">{</a><a id="5294" href="UTxO.TxUtilities.html#5236" class="Bound">u</a><a id="5295" class="Symbol">}</a> <a id="5297" href="UTxO.TxUtilities.html#5239" class="Bound">u∈</a>
        <a id="5308" class="Symbol">=</a> <a id="5310" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="utxo-getSpentᵛ"></a><a id="5316" href="UTxO.TxUtilities.html#5316" class="Function">utxo-getSpentᵛ</a> <a id="5331" class="Symbol">:</a> <a id="5333" class="Symbol">∀</a> <a id="5335" class="Symbol">{</a><a id="5336" href="UTxO.TxUtilities.html#5336" class="Bound">l</a> <a id="5338" href="UTxO.TxUtilities.html#5338" class="Bound">u</a> <a id="5340" href="UTxO.TxUtilities.html#5340" class="Bound">i</a><a id="5341" class="Symbol">}</a>
  <a id="5345" class="Symbol">→</a> <a id="5347" href="UTxO.TxUtilities.html#5338" class="Bound">u</a> <a id="5349" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="5351" href="UTxO.TxUtilities.html#837" class="Function">utxo</a> <a id="5356" href="UTxO.TxUtilities.html#5336" class="Bound">l</a>
  <a id="5360" class="Symbol">→</a> <a id="5362" href="UTxO.TxUtilities.html#572" class="Field">outRef</a> <a id="5369" href="UTxO.TxUtilities.html#5338" class="Bound">u</a> <a id="5371" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="5373" href="UTxO.Types.html#7448" class="Field">outputRef</a> <a id="5383" href="UTxO.TxUtilities.html#5340" class="Bound">i</a>
  <a id="5387" class="Symbol">→</a> <a id="5389" class="Symbol">(</a><a id="5390" href="UTxO.Types.html#4906" class="Field">value</a> <a id="5396" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="5400" href="UTxO.TxUtilities.html#5021" class="Function">getSpentOutput</a> <a id="5415" href="UTxO.TxUtilities.html#5336" class="Bound">l</a> <a id="5417" href="UTxO.TxUtilities.html#5340" class="Bound">i</a><a id="5418" class="Symbol">)</a> <a id="5420" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="5422" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="5427" class="Symbol">(</a><a id="5428" href="UTxO.Types.html#4906" class="Field">value</a> <a id="5434" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="5436" href="UTxO.TxUtilities.html#599" class="Field">out</a> <a id="5440" href="UTxO.TxUtilities.html#5338" class="Bound">u</a><a id="5441" class="Symbol">)</a>
<a id="5443" href="UTxO.TxUtilities.html#5316" class="Function">utxo-getSpentᵛ</a> <a id="5458" class="Symbol">{</a><a id="5459" href="UTxO.TxUtilities.html#5459" class="Bound">l</a><a id="5460" class="Symbol">}</a> <a id="5462" class="Symbol">{</a><a id="5463" href="UTxO.TxUtilities.html#5463" class="Bound">u</a><a id="5464" class="Symbol">}</a> <a id="5466" class="Symbol">{</a><a id="5467" href="UTxO.TxUtilities.html#5467" class="Bound">i</a><a id="5468" class="Symbol">}</a> <a id="5470" href="UTxO.TxUtilities.html#5470" class="Bound">u∈</a> <a id="5473" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="5478" class="Symbol">=</a> <a id="5480" href="Relation.Binary.PropositionalEquality.Core.html#1139" class="Function">cong</a> <a id="5485" class="Symbol">(</a><a id="5486" href="Prelude.Functor.html#382" class="Field Operator">_&lt;$&gt;_</a> <a id="5492" href="UTxO.Types.html#4906" class="Field">value</a><a id="5497" class="Symbol">)</a> <a id="5499" class="Symbol">(</a><a id="5500" href="UTxO.TxUtilities.html#5128" class="Function">utxo-getSpent</a> <a id="5514" class="Symbol">{</a><a id="5515" href="UTxO.TxUtilities.html#5459" class="Bound">l</a><a id="5516" class="Symbol">}</a> <a id="5518" class="Symbol">{</a><a id="5519" href="UTxO.TxUtilities.html#5463" class="Bound">u</a><a id="5520" class="Symbol">}</a> <a id="5522" href="UTxO.TxUtilities.html#5470" class="Bound">u∈</a><a id="5524" class="Symbol">)</a>
<a id="5526" class="Comment">-- BUG: `cong (value &lt;$&gt;_)` leads to unresolved instances...</a>

<a id="5588" class="Comment">--</a>

<a id="mkInputInfo"></a><a id="5592" href="UTxO.TxUtilities.html#5592" class="Function">mkInputInfo</a> <a id="5604" class="Symbol">:</a> <a id="5606" href="UTxO.Types.html#7888" class="Function">Ledger</a> <a id="5613" class="Symbol">→</a> <a id="5615" href="UTxO.Types.html#7416" class="Record">TxInput</a> <a id="5623" class="Symbol">→</a> <a id="5625" href="UTxO.Types.html#4637" class="Record">InputInfo</a>
<a id="5635" href="UTxO.TxUtilities.html#5592" class="Function">mkInputInfo</a> <a id="5647" href="UTxO.TxUtilities.html#5647" class="Bound">l</a> <a id="5649" href="UTxO.TxUtilities.html#5649" class="Bound">i</a> <a id="5651" class="Symbol">=</a> <a id="5653" class="Keyword">record</a>
  <a id="5662" class="Symbol">{</a> <a id="5664" href="UTxO.Types.html#4671" class="Field">outputRef</a>     <a id="5678" class="Symbol">=</a> <a id="5680" href="UTxO.Types.html#7448" class="Field">outputRef</a> <a id="5690" href="UTxO.TxUtilities.html#5649" class="Bound">i</a>
  <a id="5694" class="Symbol">;</a> <a id="5696" href="UTxO.Types.html#4703" class="Field">validatorHash</a> <a id="5710" class="Symbol">=</a> <a id="5712" class="Symbol">(</a><a id="5713" href="UTxO.Types.html#7476" class="Field">validator</a> <a id="5723" href="UTxO.TxUtilities.html#5649" class="Bound">i</a><a id="5724" class="Symbol">)</a> <a id="5726" href="UTxO.Hashing.Base.html#1199" class="Postulate Operator">♯</a>
  <a id="5730" class="Symbol">;</a> <a id="5732" href="UTxO.Types.html#4730" class="Field">datumHash</a>     <a id="5746" class="Symbol">=</a> <a id="5748" class="Symbol">(</a><a id="5749" href="UTxO.Types.html#7523" class="Field">datum</a> <a id="5755" href="UTxO.TxUtilities.html#5649" class="Bound">i</a><a id="5756" class="Symbol">)</a> <a id="5758" href="UTxO.Hashing.Types.html#593" class="Function Operator">♯ᵈ</a>
  <a id="5763" class="Symbol">;</a> <a id="5765" href="UTxO.Types.html#4757" class="Field">redeemerHash</a>  <a id="5779" class="Symbol">=</a> <a id="5781" class="Symbol">(</a><a id="5782" href="UTxO.Types.html#7502" class="Field">redeemer</a> <a id="5791" href="UTxO.TxUtilities.html#5649" class="Bound">i</a><a id="5792" class="Symbol">)</a> <a id="5794" href="UTxO.Hashing.Types.html#593" class="Function Operator">♯ᵈ</a>
  <a id="5799" class="Symbol">;</a> <a id="5801" href="UTxO.Types.html#4784" class="Field">value</a>         <a id="5815" class="Symbol">=</a> <a id="5817" href="Data.Maybe.Base.html#1371" class="Function">maybe</a> <a id="5823" href="UTxO.Types.html#4906" class="Field">value</a> <a id="5829" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="5832" class="Symbol">(</a><a id="5833" href="UTxO.TxUtilities.html#5021" class="Function">getSpentOutput</a> <a id="5848" href="UTxO.TxUtilities.html#5647" class="Bound">l</a> <a id="5850" href="UTxO.TxUtilities.html#5649" class="Bound">i</a><a id="5851" class="Symbol">)</a> <a id="5853" class="Symbol">}</a>

<a id="mkTxInfo"></a><a id="5856" href="UTxO.TxUtilities.html#5856" class="Function">mkTxInfo</a> <a id="5865" class="Symbol">:</a> <a id="5867" href="UTxO.Types.html#7888" class="Function">Ledger</a> <a id="5874" class="Symbol">→</a> <a id="5876" href="UTxO.Types.html#7568" class="Record">Tx</a> <a id="5879" class="Symbol">→</a> <a id="5881" href="UTxO.Types.html#5070" class="Record">TxInfo</a>
<a id="5888" href="UTxO.TxUtilities.html#5856" class="Function">mkTxInfo</a> <a id="5897" href="UTxO.TxUtilities.html#5897" class="Bound">l</a> <a id="5899" href="UTxO.TxUtilities.html#5899" class="Bound">tx</a> <a id="5902" class="Symbol">=</a> <a id="5904" class="Keyword">record</a>
  <a id="5913" class="Symbol">{</a> <a id="5915" href="UTxO.Types.html#5101" class="Field">inputInfo</a>      <a id="5930" class="Symbol">=</a> <a id="5932" href="Data.List.Base.html#1553" class="Function">map</a> <a id="5936" class="Symbol">(</a><a id="5937" href="UTxO.TxUtilities.html#5592" class="Function">mkInputInfo</a> <a id="5949" href="UTxO.TxUtilities.html#5897" class="Bound">l</a><a id="5950" class="Symbol">)</a> <a id="5952" class="Symbol">(</a><a id="5953" href="UTxO.Types.html#7595" class="Field">inputs</a> <a id="5960" href="UTxO.TxUtilities.html#5899" class="Bound">tx</a><a id="5962" class="Symbol">)</a>
  <a id="5966" class="Symbol">;</a> <a id="5968" href="UTxO.Types.html#5137" class="Field">outputInfo</a>     <a id="5983" class="Symbol">=</a> <a id="5985" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="5993" href="UTxO.TxUtilities.html#5899" class="Bound">tx</a>
  <a id="5998" class="Symbol">;</a> <a id="6000" href="UTxO.Types.html#5271" class="Field">datumWitnesses</a> <a id="6015" class="Symbol">=</a> <a id="6017" href="UTxO.Types.html#7834" class="Field">datumWitnesses</a> <a id="6032" href="UTxO.TxUtilities.html#5899" class="Bound">tx</a>
  <a id="6037" class="Symbol">;</a> <a id="6039" href="UTxO.Types.html#5240" class="Field">range</a>          <a id="6054" class="Symbol">=</a> <a id="6056" href="UTxO.Types.html#7803" class="Field">range</a> <a id="6062" href="UTxO.TxUtilities.html#5899" class="Bound">tx</a>
  <a id="6067" class="Symbol">;</a> <a id="6069" href="UTxO.Types.html#5199" class="Field">policies</a>       <a id="6084" class="Symbol">=</a> <a id="6086" href="Data.List.Base.html#1553" class="Function">map</a> <a id="6090" href="UTxO.Hashing.Base.html#1199" class="Postulate Operator">_♯</a> <a id="6093" class="Symbol">(</a><a id="6094" href="UTxO.Types.html#7762" class="Field">policies</a> <a id="6103" href="UTxO.TxUtilities.html#5899" class="Bound">tx</a><a id="6105" class="Symbol">)</a>
  <a id="6109" class="Symbol">;</a> <a id="6111" href="UTxO.Types.html#5172" class="Field">forge</a>          <a id="6126" class="Symbol">=</a> <a id="6128" href="UTxO.Types.html#7735" class="Field">forge</a> <a id="6134" href="UTxO.TxUtilities.html#5899" class="Bound">tx</a> <a id="6137" class="Symbol">}</a>

<a id="toPendingTx"></a><a id="6140" href="UTxO.TxUtilities.html#6140" class="Function">toPendingTx</a> <a id="6152" class="Symbol">:</a> <a id="6154" href="UTxO.Types.html#7888" class="Function">Ledger</a> <a id="6161" class="Symbol">→</a> <a id="6163" class="Symbol">(</a><a id="6164" href="UTxO.TxUtilities.html#6164" class="Bound">tx</a> <a id="6167" class="Symbol">:</a> <a id="6169" href="UTxO.Types.html#7568" class="Record">Tx</a><a id="6171" class="Symbol">)</a> <a id="6173" class="Symbol">→</a> <a id="6175" href="Prelude.Lists.Indexed.html#492" class="Function">Index</a> <a id="6181" class="Symbol">(</a><a id="6182" href="UTxO.Types.html#7595" class="Field">inputs</a> <a id="6189" href="UTxO.TxUtilities.html#6164" class="Bound">tx</a><a id="6191" class="Symbol">)</a> <a id="6193" class="Symbol">→</a> <a id="6195" href="UTxO.Types.html#5428" class="Function">PendingTx</a>
<a id="6205" href="UTxO.TxUtilities.html#6140" class="Function">toPendingTx</a> <a id="6217" href="UTxO.TxUtilities.html#6217" class="Bound">l</a> <a id="6219" href="UTxO.TxUtilities.html#6219" class="Bound">tx</a> <a id="6222" href="UTxO.TxUtilities.html#6222" class="Bound">i</a> <a id="6224" class="Symbol">=</a> <a id="6226" class="Keyword">record</a>
  <a id="6235" class="Symbol">{</a> <a id="6237" href="UTxO.Types.html#5388" class="Field">thisTx</a> <a id="6244" class="Symbol">=</a> <a id="6246" href="Prelude.Lists.Indexed.html#9672" class="Function">‼-map</a> <a id="6252" class="Symbol">{</a><a id="6253" class="Argument">xs</a> <a id="6256" class="Symbol">=</a> <a id="6258" href="UTxO.Types.html#7595" class="Field">inputs</a> <a id="6265" href="UTxO.TxUtilities.html#6219" class="Bound">tx</a><a id="6267" class="Symbol">}</a> <a id="6269" class="Symbol">{</a><a id="6270" class="Argument">f</a> <a id="6272" class="Symbol">=</a> <a id="6274" href="UTxO.TxUtilities.html#5592" class="Function">mkInputInfo</a> <a id="6286" href="UTxO.TxUtilities.html#6217" class="Bound">l</a><a id="6287" class="Symbol">}</a> <a id="6289" href="UTxO.TxUtilities.html#6222" class="Bound">i</a>
  <a id="6293" class="Symbol">;</a> <a id="6295" href="UTxO.Types.html#5368" class="Field">txInfo</a> <a id="6302" class="Symbol">=</a> <a id="6304" href="UTxO.TxUtilities.html#5856" class="Function">mkTxInfo</a> <a id="6313" href="UTxO.TxUtilities.html#6217" class="Bound">l</a> <a id="6315" href="UTxO.TxUtilities.html#6219" class="Bound">tx</a> <a id="6318" class="Symbol">}</a>

<a id="toPendingMPS"></a><a id="6321" href="UTxO.TxUtilities.html#6321" class="Function">toPendingMPS</a> <a id="6334" class="Symbol">:</a> <a id="6336" href="UTxO.Types.html#7888" class="Function">Ledger</a> <a id="6343" class="Symbol">→</a> <a id="6345" href="UTxO.Types.html#7568" class="Record">Tx</a> <a id="6348" class="Symbol">→</a> <a id="6350" href="UTxO.Hashing.Base.html#201" class="Function">HashId</a> <a id="6357" class="Symbol">→</a> <a id="6359" href="UTxO.Types.html#5476" class="Function">PendingMPS</a>
<a id="6370" href="UTxO.TxUtilities.html#6321" class="Function">toPendingMPS</a> <a id="6383" href="UTxO.TxUtilities.html#6383" class="Bound">l</a> <a id="6385" href="UTxO.TxUtilities.html#6385" class="Bound">tx</a> <a id="6388" href="UTxO.TxUtilities.html#6388" class="Bound">i</a> <a id="6390" class="Symbol">=</a> <a id="6392" class="Keyword">record</a>
  <a id="6401" class="Symbol">{</a> <a id="6403" href="UTxO.Types.html#5388" class="Field">thisTx</a> <a id="6410" class="Symbol">=</a> <a id="6412" href="UTxO.TxUtilities.html#6388" class="Bound">i</a>
  <a id="6416" class="Symbol">;</a> <a id="6418" href="UTxO.Types.html#5368" class="Field">txInfo</a> <a id="6425" class="Symbol">=</a> <a id="6427" href="UTxO.TxUtilities.html#5856" class="Function">mkTxInfo</a> <a id="6436" href="UTxO.TxUtilities.html#6383" class="Bound">l</a> <a id="6438" href="UTxO.TxUtilities.html#6385" class="Bound">tx</a> <a id="6441" class="Symbol">}</a>

<a id="6444" class="Comment">--</a>

<a id="ptx-‼"></a><a id="6448" href="UTxO.TxUtilities.html#6448" class="Function">ptx-‼</a> <a id="6454" class="Symbol">:</a> <a id="6456" class="Symbol">∀</a> <a id="6458" class="Symbol">{</a><a id="6459" href="UTxO.TxUtilities.html#6459" class="Bound">l</a> <a id="6461" href="UTxO.TxUtilities.html#6461" class="Bound">tx</a> <a id="6464" href="UTxO.TxUtilities.html#6464" class="Bound">i</a><a id="6465" class="Symbol">}</a> <a id="6467" class="Symbol">{</a><a id="6468" href="UTxO.TxUtilities.html#6468" class="Bound">i∈</a> <a id="6471" class="Symbol">:</a> <a id="6473" href="UTxO.TxUtilities.html#6464" class="Bound">i</a> <a id="6475" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="6477" href="UTxO.Types.html#7595" class="Field">inputs</a> <a id="6484" href="UTxO.TxUtilities.html#6461" class="Bound">tx</a><a id="6486" class="Symbol">}</a> <a id="6488" class="Symbol">→</a>
  <a id="6492" class="Keyword">let</a> <a id="6496" href="UTxO.TxUtilities.html#6496" class="Bound">ptx</a> <a id="6500" class="Symbol">=</a> <a id="6502" href="UTxO.TxUtilities.html#6140" class="Function">toPendingTx</a> <a id="6514" href="UTxO.TxUtilities.html#6459" class="Bound">l</a> <a id="6516" href="UTxO.TxUtilities.html#6461" class="Bound">tx</a> <a id="6519" class="Symbol">(</a><a id="6520" href="Data.List.Relation.Unary.Any.html#1826" class="Function">L.Any.index</a> <a id="6532" href="UTxO.TxUtilities.html#6468" class="Bound">i∈</a><a id="6534" class="Symbol">)</a>
  <a id="6538" class="Keyword">in</a>  <a id="6542" class="Symbol">(</a><a id="6543" href="UTxO.Types.html#5101" class="Field">TxInfo.inputInfo</a> <a id="6560" class="Symbol">(</a><a id="6561" href="UTxO.Types.html#5368" class="Field">txInfo</a> <a id="6568" href="UTxO.TxUtilities.html#6496" class="Bound">ptx</a><a id="6571" class="Symbol">)</a> <a id="6573" href="Prelude.Lists.Indexed.html#600" class="Function Operator">‼</a> <a id="6575" href="UTxO.Types.html#5388" class="Field">thisTx</a> <a id="6582" href="UTxO.TxUtilities.html#6496" class="Bound">ptx</a><a id="6585" class="Symbol">)</a> <a id="6587" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="6589" href="UTxO.TxUtilities.html#5592" class="Function">mkInputInfo</a> <a id="6601" href="UTxO.TxUtilities.html#6459" class="Bound">l</a> <a id="6603" href="UTxO.TxUtilities.html#6464" class="Bound">i</a>
<a id="6605" href="UTxO.TxUtilities.html#6448" class="Function">ptx-‼</a> <a id="6611" class="Symbol">{</a><a id="6612" class="Argument">l</a> <a id="6614" class="Symbol">=</a> <a id="6616" href="UTxO.TxUtilities.html#6616" class="Bound">l</a><a id="6617" class="Symbol">}</a> <a id="6619" class="Symbol">{</a><a id="6620" class="Argument">i∈</a> <a id="6623" class="Symbol">=</a> <a id="6625" href="UTxO.TxUtilities.html#6625" class="Bound">i∈</a><a id="6627" class="Symbol">}</a> <a id="6629" class="Keyword">rewrite</a> <a id="6637" href="Prelude.Lists.Indexed.html#10038" class="Function">map-‼</a> <a id="6643" class="Symbol">{</a><a id="6644" class="Argument">f</a> <a id="6646" class="Symbol">=</a> <a id="6648" href="UTxO.TxUtilities.html#5592" class="Function">mkInputInfo</a> <a id="6660" href="UTxO.TxUtilities.html#6616" class="Bound">l</a><a id="6661" class="Symbol">}</a> <a id="6663" href="UTxO.TxUtilities.html#6625" class="Bound">i∈</a> <a id="6666" class="Symbol">=</a> <a id="6668" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="∑₁ᶜ"></a><a id="6674" href="UTxO.TxUtilities.html#6674" class="Function">∑₁ᶜ</a> <a id="6678" class="Symbol">:</a> <a id="6680" class="Symbol">∀</a> <a id="6682" class="Symbol">{</a><a id="6683" href="UTxO.TxUtilities.html#6683" class="Bound">H</a> <a id="6685" class="Symbol">:</a> <a id="6687" href="UTxO.Value.html#987" class="Function">Value</a> <a id="6693" class="Symbol">→</a> <a id="6695" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="6698" class="Symbol">}</a> <a id="6700" class="Symbol">→</a> <a id="6702" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="6707" class="Symbol">(</a><a id="6708" href="Data.Product.html#1378" class="Function">∃</a> <a id="6710" href="UTxO.TxUtilities.html#6683" class="Bound">H</a><a id="6711" class="Symbol">)</a> <a id="6713" class="Symbol">→</a> <a id="6715" href="UTxO.Value.html#987" class="Function">Value</a>
<a id="6721" href="UTxO.TxUtilities.html#6674" class="Function">∑₁ᶜ</a> <a id="6725" class="Symbol">=</a> <a id="6727" href="Function.Base.html#1563" class="Function">flip</a> <a id="6732" href="UTxO.Value.html#2582" class="Function">∑</a> <a id="6734" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a>

<a id="∑ᵥ"></a><a id="6741" href="UTxO.TxUtilities.html#6741" class="Function">∑ᵥ</a> <a id="6744" class="Symbol">:</a> <a id="6746" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="6751" href="UTxO.Types.html#4814" class="Record">TxOutput</a> <a id="6760" class="Symbol">→</a> <a id="6762" href="UTxO.Value.html#987" class="Function">Value</a>
<a id="6768" href="UTxO.TxUtilities.html#6741" class="Function">∑ᵥ</a> <a id="6771" class="Symbol">=</a> <a id="6773" href="Function.Base.html#1563" class="Function">flip</a> <a id="6778" href="UTxO.Value.html#2582" class="Function">∑</a> <a id="6780" href="UTxO.Types.html#4906" class="Field">value</a>

<a id="outRef∈txi"></a><a id="6787" href="UTxO.TxUtilities.html#6787" class="Function">outRef∈txi</a> <a id="6798" class="Symbol">:</a> <a id="6800" class="Symbol">∀</a> <a id="6802" class="Symbol">{</a><a id="6803" href="UTxO.TxUtilities.html#6803" class="Bound">tx</a> <a id="6806" href="UTxO.TxUtilities.html#6806" class="Bound">l</a> <a id="6808" href="UTxO.TxUtilities.html#6808" class="Bound">o</a><a id="6809" class="Symbol">}</a>
  <a id="6813" class="Symbol">→</a> <a id="6815" href="UTxO.TxUtilities.html#6808" class="Bound">o</a> <a id="6817" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="6819" href="Data.List.Base.html#1553" class="Function">map</a> <a id="6823" href="UTxO.Types.html#4671" class="Field">InputInfo.outputRef</a> <a id="6843" class="Symbol">(</a><a id="6844" href="UTxO.Types.html#5101" class="Field">TxInfo.inputInfo</a> <a id="6861" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="6863" href="UTxO.TxUtilities.html#5856" class="Function">mkTxInfo</a> <a id="6872" href="UTxO.TxUtilities.html#6806" class="Bound">l</a> <a id="6874" href="UTxO.TxUtilities.html#6803" class="Bound">tx</a><a id="6876" class="Symbol">)</a>
  <a id="6880" class="Symbol">→</a> <a id="6882" href="UTxO.TxUtilities.html#6808" class="Bound">o</a> <a id="6884" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="6886" href="UTxO.Types.html#8024" class="Function">outputRefs</a> <a id="6897" href="UTxO.TxUtilities.html#6803" class="Bound">tx</a>
<a id="6900" href="UTxO.TxUtilities.html#6787" class="Function">outRef∈txi</a> <a id="6911" class="Symbol">{</a><a id="6912" href="UTxO.TxUtilities.html#6912" class="Bound">tx</a><a id="6914" class="Symbol">}{</a><a id="6916" href="UTxO.TxUtilities.html#6916" class="Bound">l</a><a id="6917" class="Symbol">}{</a><a id="6919" href="UTxO.TxUtilities.html#6919" class="Bound">o</a><a id="6920" class="Symbol">}</a> <a id="6922" href="UTxO.TxUtilities.html#6922" class="Bound">o∈</a> <a id="6925" class="Keyword">with</a> <a id="6930" href="UTxO.Types.html#7595" class="Field">inputs</a> <a id="6937" href="UTxO.TxUtilities.html#6912" class="Bound">tx</a> <a id="6940" class="Symbol">|</a> <a id="6942" href="UTxO.TxUtilities.html#6922" class="Bound">o∈</a>
<a id="6945" class="Symbol">...</a> <a id="6949" class="Symbol">|</a> <a id="6951" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>     <a id="6958" class="Symbol">|</a> <a id="6960" class="Symbol">()</a>
<a id="6963" class="Symbol">...</a> <a id="6967" class="Symbol">|</a> <a id="6969" href="UTxO.TxUtilities.html#6969" class="Bound">i</a> <a id="6971" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="6973" href="UTxO.TxUtilities.html#6973" class="Bound">is</a> <a id="6976" class="Symbol">|</a> <a id="6978" href="Data.List.Relation.Unary.Any.html#1228" class="InductiveConstructor">here</a> <a id="6983" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="6988" class="Symbol">=</a> <a id="6990" href="Data.List.Relation.Unary.Any.html#1228" class="InductiveConstructor">here</a> <a id="6995" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
<a id="7000" class="Symbol">...</a> <a id="7004" class="Symbol">|</a> <a id="7006" href="UTxO.TxUtilities.html#7006" class="Bound">i</a> <a id="7008" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="7010" href="UTxO.TxUtilities.html#7010" class="Bound">is</a> <a id="7013" class="Symbol">|</a> <a id="7015" href="Data.List.Relation.Unary.Any.html#1281" class="InductiveConstructor">there</a> <a id="7021" href="UTxO.TxUtilities.html#7021" class="Bound">o∈′</a> <a id="7025" class="Symbol">=</a> <a id="7027" href="Data.List.Relation.Unary.Any.html#1281" class="InductiveConstructor">there</a> <a id="7033" class="Symbol">(</a><a id="7034" href="UTxO.TxUtilities.html#6787" class="Function">outRef∈txi</a> <a id="7045" class="Symbol">{</a><a id="7046" class="Argument">tx</a> <a id="7049" class="Symbol">=</a> <a id="7051" class="Keyword">record</a> <a id="7058" class="Bound">tx</a> <a id="7061" class="Symbol">{</a><a id="7062" href="UTxO.Types.html#7595" class="Field">inputs</a> <a id="7069" class="Symbol">=</a> <a id="7071" href="UTxO.TxUtilities.html#7010" class="Bound">is</a><a id="7073" class="Symbol">}}{</a><a id="7076" class="Bound">l</a><a id="7077" class="Symbol">}</a> <a id="7079" href="UTxO.TxUtilities.html#7021" class="Bound">o∈′</a><a id="7082" class="Symbol">)</a>

<a id="lookup-⟨⟩"></a><a id="7085" href="UTxO.TxUtilities.html#7085" class="Function">lookup-⟨⟩</a> <a id="7095" class="Symbol">:</a> <a id="7097" class="Symbol">∀</a> <a id="7099" class="Symbol">{</a><a id="7100" href="UTxO.TxUtilities.html#7100" class="Bound">tx</a> <a id="7103" href="UTxO.TxUtilities.html#7103" class="Bound">l</a> <a id="7105" href="UTxO.TxUtilities.html#7105" class="Bound">i</a><a id="7106" class="Symbol">}</a>
  <a id="7110" class="Symbol">→</a> <a id="7112" href="Data.Maybe.html#810" class="Function">Is-just</a> <a id="7120" class="Symbol">(</a><a id="7121" href="UTxO.TxUtilities.html#5021" class="Function">getSpentOutput</a> <a id="7136" href="UTxO.TxUtilities.html#7103" class="Bound">l</a> <a id="7138" href="UTxO.TxUtilities.html#7105" class="Bound">i</a><a id="7139" class="Symbol">)</a>
  <a id="7143" class="Symbol">→</a> <a id="7145" href="UTxO.Types.html#4267" class="Field">hid</a> <a id="7149" class="Symbol">(</a><a id="7150" href="UTxO.Types.html#7448" class="Field">outputRef</a> <a id="7160" href="UTxO.TxUtilities.html#7105" class="Bound">i</a><a id="7161" class="Symbol">)</a> <a id="7163" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="7165" href="UTxO.TxUtilities.html#7100" class="Bound">tx</a> <a id="7168" href="UTxO.Hashing.Types.html#1170" class="Function Operator">♯ₜₓ</a>
    <a id="7176" class="Comment">----------------------------</a>
  <a id="7207" class="Symbol">→</a> <a id="7209" href="UTxO.TxUtilities.html#7103" class="Bound">l</a> <a id="7211" href="UTxO.TxUtilities.html#2928" class="Function Operator">⟨</a> <a id="7213" href="UTxO.Types.html#7448" class="Field">outputRef</a> <a id="7223" href="UTxO.TxUtilities.html#7105" class="Bound">i</a> <a id="7225" href="UTxO.TxUtilities.html#2928" class="Function Operator">⟩</a> <a id="7227" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="7229" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="7234" href="UTxO.TxUtilities.html#7100" class="Bound">tx</a>
<a id="7237" href="UTxO.TxUtilities.html#7085" class="Function">lookup-⟨⟩</a> <a id="7247" class="Symbol">{</a><a id="7248" href="UTxO.TxUtilities.html#7248" class="Bound">tx</a><a id="7250" class="Symbol">}{</a><a id="7252" href="UTxO.TxUtilities.html#7252" class="Bound">l</a><a id="7253" class="Symbol">}{</a><a id="7255" href="UTxO.TxUtilities.html#7255" class="Bound">i</a><a id="7256" class="Symbol">@(</a><a id="7258" class="Keyword">record</a><a id="7264" class="Symbol">{</a><a id="7265" href="UTxO.Types.html#7448" class="Field">outputRef</a> <a id="7275" class="Symbol">=</a> <a id="7277" href="UTxO.TxUtilities.html#7277" class="Bound">or</a><a id="7279" class="Symbol">})}</a> <a id="7283" href="UTxO.TxUtilities.html#7283" class="Bound">getSpent≡</a> <a id="7293" href="UTxO.TxUtilities.html#7293" class="Bound">id≡</a>
  <a id="7299" class="Keyword">with</a> <a id="7304" href="UTxO.TxUtilities.html#7252" class="Bound">l</a>       <a id="7312" class="Symbol">|</a> <a id="7314" href="UTxO.TxUtilities.html#7283" class="Bound">getSpent≡</a>
<a id="7324" class="Symbol">...</a> <a id="7328" class="Symbol">|</a> <a id="7330" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>       <a id="7339" class="Symbol">|</a> <a id="7341" class="Symbol">()</a>
<a id="7344" class="Symbol">...</a> <a id="7348" class="Symbol">|</a> <a id="7350" href="UTxO.TxUtilities.html#7350" class="Bound">tx′</a> <a id="7354" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="7356" href="UTxO.TxUtilities.html#7356" class="Bound">l′</a> <a id="7359" class="Symbol">|</a> <a id="7361" href="UTxO.TxUtilities.html#7361" class="Bound">getSpent≡′</a>
  <a id="7374" class="Keyword">with</a> <a id="7379" href="UTxO.Types.html#4267" class="Field">hid</a> <a id="7383" class="Bound">or</a> <a id="7386" href="Prelude.DecEq.Core.html#190" class="Field Operator">≟</a> <a id="7388" href="UTxO.TxUtilities.html#7350" class="Bound">tx′</a> <a id="7392" href="UTxO.Hashing.Types.html#1170" class="Function Operator">♯ₜₓ</a>
<a id="7396" class="Symbol">...</a> <a id="7400" class="Symbol">|</a> <a id="7402" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="7406" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
  <a id="7413" class="Keyword">rewrite</a> <a id="7421" href="UTxO.Hashing.Types.html#1690" class="Postulate">injective♯ₜₓ</a> <a id="7434" class="Symbol">{</a><a id="7435" class="Argument">x</a> <a id="7437" class="Symbol">=</a> <a id="7439" class="Bound">tx′</a><a id="7442" class="Symbol">}</a> <a id="7444" class="Symbol">{</a><a id="7445" class="Argument">y</a> <a id="7447" class="Symbol">=</a> <a id="7449" class="Bound">tx</a><a id="7451" class="Symbol">}</a> <a id="7453" class="Bound">id≡</a>
    <a id="7461" class="Symbol">=</a> <a id="7463" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
<a id="7468" class="Symbol">...</a> <a id="7472" class="Symbol">|</a> <a id="7474" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="7477" class="Symbol">_</a>
    <a id="7483" class="Symbol">=</a> <a id="7485" href="UTxO.TxUtilities.html#7085" class="Function">lookup-⟨⟩</a> <a id="7495" class="Symbol">{</a><a id="7496" class="Bound">tx</a><a id="7498" class="Symbol">}{</a><a id="7500" class="Bound">l′</a><a id="7502" class="Symbol">}{</a><a id="7504" class="Bound">i</a><a id="7505" class="Symbol">}</a> <a id="7507" class="Bound">getSpent≡′</a> <a id="7518" class="Bound">id≡</a>

<a id="lookup-⟦⟧"></a><a id="7523" href="UTxO.TxUtilities.html#7523" class="Function">lookup-⟦⟧</a> <a id="7533" class="Symbol">:</a> <a id="7535" class="Symbol">∀</a> <a id="7537" class="Symbol">{</a><a id="7538" href="UTxO.TxUtilities.html#7538" class="Bound">tx</a> <a id="7541" href="UTxO.TxUtilities.html#7541" class="Bound">l</a> <a id="7543" href="UTxO.TxUtilities.html#7543" class="Bound">i</a> <a id="7545" href="UTxO.TxUtilities.html#7545" class="Bound">o</a><a id="7546" class="Symbol">}</a>
  <a id="7550" class="Symbol">→</a> <a id="7552" href="Data.Maybe.html#810" class="Function">Is-just</a> <a id="7560" class="Symbol">(</a><a id="7561" href="UTxO.TxUtilities.html#5021" class="Function">getSpentOutput</a> <a id="7576" href="UTxO.TxUtilities.html#7541" class="Bound">l</a> <a id="7578" href="UTxO.TxUtilities.html#7543" class="Bound">i</a><a id="7579" class="Symbol">)</a>
  <a id="7583" class="Symbol">→</a> <a id="7585" href="UTxO.Types.html#4267" class="Field">hid</a> <a id="7589" class="Symbol">(</a><a id="7590" href="UTxO.Types.html#7448" class="Field">outputRef</a> <a id="7600" href="UTxO.TxUtilities.html#7543" class="Bound">i</a><a id="7601" class="Symbol">)</a> <a id="7603" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="7605" href="UTxO.TxUtilities.html#7538" class="Bound">tx</a> <a id="7608" href="UTxO.Hashing.Types.html#1170" class="Function Operator">♯ₜₓ</a>
  <a id="7614" class="Symbol">→</a> <a id="7616" href="UTxO.Types.html#7700" class="Field">outputs</a> <a id="7624" href="UTxO.TxUtilities.html#7538" class="Bound">tx</a> <a id="7627" href="UTxO.TxUtilities.html#4328" class="Function Operator">⟦</a> <a id="7629" href="UTxO.Types.html#4324" class="Field">index</a> <a id="7635" class="Symbol">(</a><a id="7636" href="UTxO.Types.html#7448" class="Field">outputRef</a> <a id="7646" href="UTxO.TxUtilities.html#7543" class="Bound">i</a><a id="7647" class="Symbol">)</a> <a id="7649" href="UTxO.TxUtilities.html#4328" class="Function Operator">⟧</a> <a id="7651" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="7653" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="7658" href="UTxO.TxUtilities.html#7545" class="Bound">o</a>
    <a id="7664" class="Comment">-------------------------------------------</a>
  <a id="7710" class="Symbol">→</a> <a id="7712" href="UTxO.TxUtilities.html#5021" class="Function">getSpentOutput</a> <a id="7727" href="UTxO.TxUtilities.html#7541" class="Bound">l</a> <a id="7729" href="UTxO.TxUtilities.html#7543" class="Bound">i</a> <a id="7731" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="7733" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="7738" href="UTxO.TxUtilities.html#7545" class="Bound">o</a>
<a id="7740" href="UTxO.TxUtilities.html#7523" class="Function">lookup-⟦⟧</a> <a id="7750" class="Symbol">{</a><a id="7751" class="Argument">tx</a> <a id="7754" class="Symbol">=</a> <a id="7756" href="UTxO.TxUtilities.html#7756" class="Bound">tx</a><a id="7758" class="Symbol">}{</a><a id="7760" href="UTxO.TxUtilities.html#7760" class="Bound">l</a><a id="7761" class="Symbol">}{</a><a id="7763" href="UTxO.TxUtilities.html#7763" class="Bound">i</a><a id="7764" class="Symbol">}{</a><a id="7766" href="UTxO.TxUtilities.html#7766" class="Bound">o</a><a id="7767" class="Symbol">}</a> <a id="7769" href="UTxO.TxUtilities.html#7769" class="Bound">vvh</a> <a id="7773" href="UTxO.TxUtilities.html#7773" class="Bound">id≡</a> <a id="7777" href="UTxO.TxUtilities.html#7777" class="Bound">p</a> <a id="7779" class="Keyword">rewrite</a> <a id="7787" href="UTxO.TxUtilities.html#7085" class="Function">lookup-⟨⟩</a> <a id="7797" class="Symbol">{</a><a id="7798" class="Argument">tx</a> <a id="7801" class="Symbol">=</a> <a id="7803" href="UTxO.TxUtilities.html#7756" class="Bound">tx</a><a id="7805" class="Symbol">}{</a><a id="7807" href="UTxO.TxUtilities.html#7760" class="Bound">l</a><a id="7808" class="Symbol">}{</a><a id="7810" href="UTxO.TxUtilities.html#7763" class="Bound">i</a><a id="7811" class="Symbol">}</a> <a id="7813" href="UTxO.TxUtilities.html#7769" class="Bound">vvh</a> <a id="7817" href="UTxO.TxUtilities.html#7773" class="Bound">id≡</a> <a id="7821" class="Symbol">=</a> <a id="7823" href="UTxO.TxUtilities.html#7777" class="Bound">p</a>

<a id="7826" class="Keyword">postulate</a>
  <a id="7838" class="Comment">-- Assume that datumWitnesses have been constructed properly.</a>
  <a id="7902" class="Comment">-- T0D0: remove datumWitnesses and keep datums immediately in outputs</a>
  <a id="wits♯"></a><a id="7974" href="UTxO.TxUtilities.html#7974" class="Postulate">wits♯</a> <a id="7980" class="Symbol">:</a> <a id="7982" class="Symbol">∀</a> <a id="7984" class="Symbol">{</a><a id="7985" href="UTxO.TxUtilities.html#7985" class="Bound">txi</a> <a id="7989" href="UTxO.TxUtilities.html#7989" class="Bound">d♯</a> <a id="7992" href="UTxO.TxUtilities.html#7992" class="Bound">d</a><a id="7993" class="Symbol">}</a>
    <a id="7999" class="Symbol">→</a> <a id="8001" class="Symbol">(</a><a id="8002" href="UTxO.TxUtilities.html#7989" class="Bound">d♯</a> <a id="8005" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="8007" href="UTxO.TxUtilities.html#7992" class="Bound">d</a><a id="8008" class="Symbol">)</a> <a id="8010" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="8012" href="UTxO.Types.html#5271" class="Field">TxInfo.datumWitnesses</a> <a id="8034" href="UTxO.TxUtilities.html#7985" class="Bound">txi</a>
    <a id="8042" class="Symbol">→</a> <a id="8044" href="UTxO.TxUtilities.html#7989" class="Bound">d♯</a> <a id="8047" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="8049" href="UTxO.TxUtilities.html#7992" class="Bound">d</a> <a id="8051" href="UTxO.Hashing.Types.html#593" class="Function Operator">♯ᵈ</a>

<a id="lookupDatum≡"></a><a id="8055" href="UTxO.TxUtilities.html#8055" class="Function">lookupDatum≡</a> <a id="8068" class="Symbol">:</a> <a id="8070" class="Symbol">∀</a> <a id="8072" class="Symbol">{</a><a id="8073" href="UTxO.TxUtilities.html#8073" class="Bound">A</a> <a id="8075" class="Symbol">:</a> <a id="8077" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="8080" class="Symbol">}</a> <a id="8082" class="Symbol">{{</a><a id="8084" href="UTxO.TxUtilities.html#8084" class="Bound">_</a> <a id="8086" class="Symbol">:</a> <a id="8088" href="UTxO.Types.html#1155" class="Record">IsData</a> <a id="8095" href="UTxO.TxUtilities.html#8073" class="Bound">A</a><a id="8096" class="Symbol">}}</a> <a id="8099" class="Symbol">{</a><a id="8100" href="UTxO.TxUtilities.html#8100" class="Bound">x</a> <a id="8102" class="Symbol">:</a> <a id="8104" href="UTxO.TxUtilities.html#8073" class="Bound">A</a><a id="8105" class="Symbol">}</a> <a id="8107" class="Symbol">{</a><a id="8108" href="UTxO.TxUtilities.html#8108" class="Bound">d♯</a> <a id="8111" class="Symbol">:</a> <a id="8113" href="UTxO.Hashing.Base.html#201" class="Function">HashId</a><a id="8119" class="Symbol">}</a> <a id="8121" class="Symbol">{</a><a id="8122" href="UTxO.TxUtilities.html#8122" class="Bound">txi</a> <a id="8126" class="Symbol">:</a> <a id="8128" href="UTxO.Types.html#5070" class="Record">TxInfo</a><a id="8134" class="Symbol">}</a> <a id="8136" class="Symbol">{</a><a id="8137" href="UTxO.TxUtilities.html#8137" class="Bound">wits</a> <a id="8142" class="Symbol">:</a> <a id="8144" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="8149" class="Symbol">(</a><a id="8150" href="UTxO.Hashing.Base.html#201" class="Function">HashId</a> <a id="8157" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="8159" href="UTxO.Types.html#907" class="Datatype">DATA</a><a id="8163" class="Symbol">)}</a>
  <a id="8168" class="Symbol">→</a> <a id="8170" href="UTxO.Types.html#5271" class="Field">TxInfo.datumWitnesses</a> <a id="8192" href="UTxO.TxUtilities.html#8122" class="Bound">txi</a> <a id="8196" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="8198" href="UTxO.TxUtilities.html#8137" class="Bound">wits</a>
  <a id="8205" class="Symbol">→</a> <a id="8207" class="Symbol">(</a><a id="8208" href="UTxO.Types.html#5513" class="Function">lookupDatum</a> <a id="8220" href="UTxO.TxUtilities.html#8108" class="Bound">d♯</a> <a id="8223" href="UTxO.TxUtilities.html#8137" class="Bound">wits</a> <a id="8228" href="Prelude.Monad.html#590" class="Field Operator">&gt;&gt;=</a> <a id="8232" href="UTxO.Types.html#1220" class="Field">fromData</a><a id="8240" class="Symbol">)</a> <a id="8242" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="8244" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="8249" href="UTxO.TxUtilities.html#8100" class="Bound">x</a>
  <a id="8253" class="Symbol">→</a> <a id="8255" href="UTxO.TxUtilities.html#8108" class="Bound">d♯</a> <a id="8258" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="8260" href="UTxO.Types.html#1196" class="Field">toData</a> <a id="8267" href="UTxO.TxUtilities.html#8100" class="Bound">x</a> <a id="8269" href="UTxO.Hashing.Types.html#593" class="Function Operator">♯ᵈ</a>
<a id="8272" href="UTxO.TxUtilities.html#8055" class="Function">lookupDatum≡</a> <a id="8285" class="Symbol">{</a><a id="8286" class="Argument">x</a> <a id="8288" class="Symbol">=</a> <a id="8290" href="UTxO.TxUtilities.html#8290" class="Bound">x</a><a id="8291" class="Symbol">}{</a><a id="8293" href="UTxO.TxUtilities.html#8293" class="Bound">d♯</a><a id="8295" class="Symbol">}{</a><a id="8297" href="UTxO.TxUtilities.html#8297" class="Bound">txi</a><a id="8300" class="Symbol">}{</a><a id="8302" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="8304" class="Symbol">}</a>             <a id="8318" class="Symbol">_</a>    <a id="8323" class="Symbol">()</a>
<a id="8326" href="UTxO.TxUtilities.html#8055" class="Function">lookupDatum≡</a> <a id="8339" class="Symbol">{</a><a id="8340" class="Argument">x</a> <a id="8342" class="Symbol">=</a> <a id="8344" href="UTxO.TxUtilities.html#8344" class="Bound">x</a><a id="8345" class="Symbol">}{</a><a id="8347" href="UTxO.TxUtilities.html#8347" class="Bound">d♯</a><a id="8349" class="Symbol">}{</a><a id="8351" href="UTxO.TxUtilities.html#8351" class="Bound">txi</a><a id="8354" class="Symbol">}{(</a><a id="8357" href="UTxO.TxUtilities.html#8357" class="Bound">h</a> <a id="8359" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="8361" href="UTxO.TxUtilities.html#8361" class="Bound">d</a><a id="8362" class="Symbol">)</a> <a id="8364" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="8366" href="UTxO.TxUtilities.html#8366" class="Bound">wits</a><a id="8370" class="Symbol">}</a> <a id="8372" href="UTxO.TxUtilities.html#8372" class="Bound">wits≡</a> <a id="8378" href="UTxO.TxUtilities.html#8378" class="Bound">eq</a>
  <a id="8383" class="Keyword">with</a> <a id="8388" href="UTxO.TxUtilities.html#8347" class="Bound">d♯</a> <a id="8391" href="Prelude.DecEq.Core.html#190" class="Field Operator">≟</a> <a id="8393" href="UTxO.TxUtilities.html#8357" class="Bound">h</a>
<a id="8395" class="Symbol">...</a> <a id="8399" class="Symbol">|</a> <a id="8401" href="Relation.Nullary.html#1657" class="InductiveConstructor">yes</a> <a id="8405" href="UTxO.TxUtilities.html#8405" class="Bound">p</a>
  <a id="8409" class="Keyword">rewrite</a> <a id="8417" href="Data.List.Properties.html#28554" class="Function">filter-accept</a> <a id="8431" class="Symbol">((</a><a id="8433" class="Bound">d♯</a> <a id="8436" href="Prelude.DecEq.Core.html#190" class="Field Operator">≟_</a><a id="8438" class="Symbol">)</a> <a id="8440" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="8442" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a><a id="8447" class="Symbol">)</a> <a id="8449" class="Symbol">{</a><a id="8450" class="Argument">x</a> <a id="8452" class="Symbol">=</a> <a id="8454" class="Bound">h</a> <a id="8456" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="8458" class="Bound">d</a><a id="8459" class="Symbol">}</a> <a id="8461" class="Symbol">{</a><a id="8462" class="Argument">xs</a> <a id="8465" class="Symbol">=</a> <a id="8467" class="Bound">wits</a><a id="8471" class="Symbol">}</a> <a id="8473" href="UTxO.TxUtilities.html#8405" class="Bound">p</a>
    <a id="8479" class="Symbol">=</a> <a id="8481" href="Relation.Binary.PropositionalEquality.Core.html#2815" class="Function Operator">begin</a> <a id="8487" class="Bound">d♯</a>          <a id="8499" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="8502" href="UTxO.TxUtilities.html#8405" class="Bound">p</a> <a id="8504" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
            <a id="8518" class="Bound">h</a>           <a id="8530" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="8533" href="UTxO.TxUtilities.html#7974" class="Postulate">wits♯</a> <a id="8539" class="Symbol">{</a><a id="8540" class="Bound">txi</a><a id="8543" class="Symbol">}{</a><a id="8545" class="Bound">h</a><a id="8546" class="Symbol">}{</a><a id="8548" class="Bound">d</a><a id="8549" class="Symbol">}</a> <a id="8551" class="Symbol">(</a><a id="8552" href="Relation.Binary.PropositionalEquality.Core.html#1789" class="Function">subst</a> <a id="8558" class="Symbol">((</a><a id="8560" class="Bound">h</a> <a id="8562" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="8564" class="Bound">d</a><a id="8565" class="Symbol">)</a> <a id="8567" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈_</a><a id="8569" class="Symbol">)</a> <a id="8571" class="Symbol">(</a><a id="8572" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a> <a id="8576" class="Bound">wits≡</a><a id="8581" class="Symbol">)</a> <a id="8583" class="Symbol">(</a><a id="8584" href="Data.List.Relation.Unary.Any.html#1228" class="InductiveConstructor">here</a> <a id="8589" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="8593" class="Symbol">))</a> <a id="8596" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
            <a id="8610" class="Bound">d</a> <a id="8612" href="UTxO.Hashing.Types.html#593" class="Function Operator">♯ᵈ</a>        <a id="8622" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">≡⟨</a> <a id="8625" href="Relation.Binary.PropositionalEquality.Core.html#1139" class="Function">cong</a> <a id="8630" class="Symbol">(</a><a id="8631" href="UTxO.Hashing.Types.html#593" class="Function Operator">_♯ᵈ</a><a id="8634" class="Symbol">)</a> <a id="8636" class="Symbol">(</a><a id="8637" href="UTxO.Types.html#1300" class="Field">from-inj</a> <a id="8646" class="Symbol">_</a> <a id="8648" class="Symbol">_</a> <a id="8650" class="Bound">eq</a><a id="8652" class="Symbol">)</a> <a id="8654" href="Relation.Binary.PropositionalEquality.Core.html#2932" class="Function">⟩</a>
            <a id="8668" href="UTxO.Types.html#1196" class="Field">toData</a> <a id="8675" class="Bound">x</a> <a id="8677" href="UTxO.Hashing.Types.html#593" class="Function Operator">♯ᵈ</a> <a id="8680" href="Relation.Binary.PropositionalEquality.Core.html#3114" class="Function Operator">∎</a>
<a id="8682" class="Symbol">...</a> <a id="8686" class="Symbol">|</a> <a id="8688" href="Relation.Nullary.html#1694" class="InductiveConstructor">no</a> <a id="8691" href="UTxO.TxUtilities.html#8691" class="Bound">¬p</a>
  <a id="8696" class="Keyword">rewrite</a> <a id="8704" href="Data.List.Properties.html#28739" class="Function">filter-reject</a> <a id="8718" class="Symbol">((</a><a id="8720" class="Bound">d♯</a> <a id="8723" href="Prelude.DecEq.Core.html#190" class="Field Operator">≟_</a><a id="8725" class="Symbol">)</a> <a id="8727" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="8729" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a><a id="8734" class="Symbol">)</a> <a id="8736" class="Symbol">{</a><a id="8737" class="Argument">x</a> <a id="8739" class="Symbol">=</a> <a id="8741" class="Bound">h</a> <a id="8743" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="8745" class="Bound">d</a><a id="8746" class="Symbol">}</a> <a id="8748" class="Symbol">{</a><a id="8749" class="Argument">xs</a> <a id="8752" class="Symbol">=</a> <a id="8754" class="Bound">wits</a><a id="8758" class="Symbol">}</a> <a id="8760" href="UTxO.TxUtilities.html#8691" class="Bound">¬p</a>
    <a id="8767" class="Symbol">=</a> <a id="8769" href="UTxO.TxUtilities.html#8055" class="Function">lookupDatum≡</a> <a id="8782" class="Symbol">{</a><a id="8783" class="Argument">x</a> <a id="8785" class="Symbol">=</a> <a id="8787" class="Bound">x</a><a id="8788" class="Symbol">}{</a><a id="8790" class="Bound">d♯</a><a id="8792" class="Symbol">}{</a><a id="8794" class="Keyword">record</a> <a id="8801" class="Bound">txi</a> <a id="8805" class="Symbol">{</a><a id="8806" href="UTxO.Types.html#5271" class="Field">datumWitnesses</a> <a id="8821" class="Symbol">=</a> <a id="8823" class="Bound">wits</a><a id="8827" class="Symbol">}}{</a><a id="8830" class="Bound">wits</a><a id="8834" class="Symbol">}</a> <a id="8836" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="8841" class="Bound">eq</a>
</pre></body></html>