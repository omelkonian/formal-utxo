<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Hashing.MetaHash</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Naive hashing functions for UTxO types.</a>

<a id="118" class="Comment">-- NB: uses meta-programming to be able to hash values of any type, by:</a>
<a id="190" class="Comment">--     1. Quoting the given expression to get a `Term`</a>
<a id="245" class="Comment">--     2. Showing the term to get a `String`</a>
<a id="290" class="Comment">--     3. Naively converting the string to a number</a>
<a id="342" class="Comment">--</a>
<a id="345" class="Comment">-- EDIT: Does not work, since meta-programs are restricted to 2 stages..</a>
<a id="418" class="Comment">------------------------------------------------------------------------</a>
<a id="491" class="Keyword">module</a> <a id="498" href="Hashing.MetaHash.html" class="Module">Hashing.MetaHash</a> <a id="515" class="Keyword">where</a>

<a id="522" class="Keyword">open</a> <a id="527" class="Keyword">import</a> <a id="534" href="Function.html" class="Module">Function</a>      <a id="548" class="Keyword">using</a> <a id="554" class="Symbol">(</a><a id="555" href="Function.html#1085" class="Function Operator">_∘_</a><a id="558" class="Symbol">)</a>
<a id="560" class="Keyword">open</a> <a id="565" class="Keyword">import</a> <a id="572" href="Data.Unit.html" class="Module">Data.Unit</a>     <a id="586" class="Keyword">using</a> <a id="592" class="Symbol">(</a><a id="593" href="Agda.Builtin.Unit.html#137" class="Record">⊤</a><a id="594" class="Symbol">)</a>
<a id="596" class="Keyword">open</a> <a id="601" class="Keyword">import</a> <a id="608" href="Data.Bool.html" class="Module">Data.Bool</a>     <a id="622" class="Keyword">using</a> <a id="628" class="Symbol">(</a><a id="629" href="Agda.Builtin.Bool.html#135" class="Datatype">Bool</a><a id="633" class="Symbol">;</a> <a id="635" href="Agda.Builtin.Bool.html#160" class="InductiveConstructor">true</a><a id="639" class="Symbol">;</a> <a id="641" href="Agda.Builtin.Bool.html#154" class="InductiveConstructor">false</a><a id="646" class="Symbol">)</a>
<a id="648" class="Keyword">open</a> <a id="653" class="Keyword">import</a> <a id="660" href="Data.Product.html" class="Module">Data.Product</a>  <a id="674" class="Keyword">using</a> <a id="680" class="Symbol">(</a><a id="681" href="Data.Product.html#1162" class="Function Operator">_×_</a><a id="684" class="Symbol">;</a> <a id="686" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">_,_</a><a id="689" class="Symbol">)</a>
<a id="691" class="Keyword">open</a> <a id="696" class="Keyword">import</a> <a id="703" href="Data.List.html" class="Module">Data.List</a>     <a id="717" class="Keyword">using</a> <a id="723" class="Symbol">(</a><a id="724" href="Agda.Builtin.List.html#121" class="Datatype">List</a><a id="728" class="Symbol">;</a> <a id="730" href="Data.List.Base.html#8786" class="InductiveConstructor">[]</a><a id="732" class="Symbol">;</a> <a id="734" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">_∷_</a><a id="737" class="Symbol">;</a> <a id="739" href="Data.List.Base.html#8640" class="Function Operator">_∷ʳ_</a><a id="743" class="Symbol">;</a> <a id="745" href="Data.List.Base.html#4265" class="Function Operator">[_]</a><a id="748" class="Symbol">;</a> <a id="750" href="Data.List.Base.html#4104" class="Function">length</a><a id="756" class="Symbol">;</a> <a id="758" href="Data.List.Base.html#4024" class="Function">sum</a><a id="761" class="Symbol">;</a> <a id="763" href="Data.List.Base.html#1304" class="Function">map</a><a id="766" class="Symbol">)</a>
<a id="768" class="Keyword">open</a> <a id="773" class="Keyword">import</a> <a id="780" href="Data.Nat.html" class="Module">Data.Nat</a>      <a id="794" class="Keyword">using</a> <a id="800" class="Symbol">(</a><a id="801" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a><a id="802" class="Symbol">;</a> <a id="804" href="Agda.Builtin.Nat.html#298" class="Primitive Operator">_+_</a><a id="807" class="Symbol">;</a> <a id="809" href="Agda.Builtin.Nat.html#501" class="Primitive Operator">_*_</a><a id="812" class="Symbol">;</a> <a id="814" href="Agda.Builtin.Nat.html#388" class="Primitive Operator">_∸_</a><a id="817" class="Symbol">;</a> <a id="819" href="Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a><a id="822" class="Symbol">)</a>
<a id="824" class="Keyword">open</a> <a id="829" class="Keyword">import</a> <a id="836" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a> <a id="850" class="Keyword">using</a> <a id="856" class="Symbol">(</a><a id="857" href="Data.Nat.Show.html#1075" class="Function">show</a><a id="861" class="Symbol">)</a>
<a id="863" class="Keyword">open</a> <a id="868" class="Keyword">import</a> <a id="875" href="Data.Fin.html" class="Module">Data.Fin</a>      <a id="889" class="Keyword">using</a> <a id="895" class="Symbol">(</a><a id="896" href="Data.Fin.Base.html#1077" class="Function">toℕ</a><a id="899" class="Symbol">)</a>
<a id="901" class="Keyword">open</a> <a id="906" class="Keyword">import</a> <a id="913" href="Data.String.html" class="Module">Data.String</a>   <a id="927" class="Keyword">using</a> <a id="933" class="Symbol">(</a><a id="934" href="Agda.Builtin.String.html#206" class="Postulate">String</a><a id="940" class="Symbol">;</a> <a id="942" href="Agda.Builtin.String.html#262" class="Primitive">toList</a><a id="948" class="Symbol">;</a> <a id="950" href="Data.String.Base.html#1735" class="Function Operator">_++_</a><a id="954" class="Symbol">)</a>
<a id="956" class="Keyword">open</a> <a id="961" class="Keyword">import</a> <a id="968" href="Data.Char.html" class="Module">Data.Char</a>     <a id="982" class="Keyword">using</a> <a id="988" class="Symbol">(</a><a id="989" href="Agda.Builtin.Char.html#200" class="Postulate">Char</a><a id="993" class="Symbol">;</a> <a id="995" href="Agda.Builtin.Char.html#410" class="Primitive">toNat</a><a id="1000" class="Symbol">)</a>

<a id="1003" class="Keyword">open</a> <a id="1008" class="Keyword">import</a> <a id="1015" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1053" class="Keyword">using</a> <a id="1059" class="Symbol">(</a><a id="1060" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">_≡_</a><a id="1063" class="Symbol">)</a>

<a id="1066" class="Keyword">open</a> <a id="1071" class="Keyword">import</a> <a id="1078" href="Reflection.html" class="Module">Reflection</a>

<a id="1090" class="Keyword">open</a> <a id="1095" class="Keyword">import</a> <a id="1102" href="Hashing.Base.html" class="Module">Hashing.Base</a>


<a id="Show"></a><a id="1117" href="Hashing.MetaHash.html#1117" class="Function">Show</a> <a id="1122" class="Symbol">:</a> <a id="1124" class="PrimitiveType">Set</a> <a id="1128" class="Symbol">→</a> <a id="1130" class="PrimitiveType">Set</a>
<a id="1134" href="Hashing.MetaHash.html#1117" class="Function">Show</a> <a id="1139" href="Hashing.MetaHash.html#1139" class="Bound">A</a> <a id="1141" class="Symbol">=</a> <a id="1143" href="Hashing.MetaHash.html#1139" class="Bound">A</a> <a id="1145" class="Symbol">→</a> <a id="1147" href="Agda.Builtin.String.html#206" class="Postulate">String</a>

<a id="1155" class="Keyword">infixl</a> <a id="1162" class="Number">20</a> <a id="1165" href="Hashing.MetaHash.html#1169" class="Function Operator">_◇_</a>
<a id="_◇_"></a><a id="1169" href="Hashing.MetaHash.html#1169" class="Function Operator">_◇_</a> <a id="1173" class="Symbol">:</a> <a id="1175" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="1182" class="Symbol">→</a> <a id="1184" href="Agda.Builtin.String.html#206" class="Postulate">String</a> <a id="1191" class="Symbol">→</a> <a id="1193" href="Agda.Builtin.String.html#206" class="Postulate">String</a>
<a id="1200" href="Hashing.MetaHash.html#1200" class="Bound">s</a> <a id="1202" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="1204" href="Hashing.MetaHash.html#1204" class="Bound">s′</a> <a id="1207" class="Symbol">=</a> <a id="1209" href="Hashing.MetaHash.html#1200" class="Bound">s</a> <a id="1211" href="Data.String.Base.html#1735" class="Function Operator">++</a> <a id="1214" class="String">&quot; &quot;</a> <a id="1218" href="Data.String.Base.html#1735" class="Function Operator">++</a> <a id="1221" href="Hashing.MetaHash.html#1204" class="Bound">s′</a>

<a id="showList"></a><a id="1225" href="Hashing.MetaHash.html#1225" class="Function">showList</a> <a id="1234" class="Symbol">:</a> <a id="1236" class="Symbol">∀</a> <a id="1238" class="Symbol">{</a><a id="1239" href="Hashing.MetaHash.html#1239" class="Bound">A</a> <a id="1241" class="Symbol">:</a> <a id="1243" class="PrimitiveType">Set</a><a id="1246" class="Symbol">}</a> <a id="1248" class="Symbol">→</a> <a id="1250" href="Hashing.MetaHash.html#1117" class="Function">Show</a> <a id="1255" href="Hashing.MetaHash.html#1239" class="Bound">A</a> <a id="1257" class="Symbol">→</a> <a id="1259" href="Hashing.MetaHash.html#1117" class="Function">Show</a> <a id="1264" class="Symbol">(</a><a id="1265" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="1270" href="Hashing.MetaHash.html#1239" class="Bound">A</a><a id="1271" class="Symbol">)</a>
<a id="1273" href="Hashing.MetaHash.html#1225" class="Function">showList</a> <a id="1282" href="Hashing.MetaHash.html#1282" class="Bound">showA</a> <a id="1288" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>       <a id="1297" class="Symbol">=</a> <a id="1299" class="String">&quot;&quot;</a>
<a id="1302" href="Hashing.MetaHash.html#1225" class="Function">showList</a> <a id="1311" href="Hashing.MetaHash.html#1311" class="Bound">showA</a> <a id="1317" class="Symbol">(</a><a id="1318" href="Hashing.MetaHash.html#1318" class="Bound">x</a> <a id="1320" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1322" href="Hashing.MetaHash.html#1322" class="Bound">xs</a><a id="1324" class="Symbol">)</a> <a id="1326" class="Symbol">=</a> <a id="1328" href="Hashing.MetaHash.html#1311" class="Bound">showA</a> <a id="1334" href="Hashing.MetaHash.html#1318" class="Bound">x</a> <a id="1336" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="1338" href="Hashing.MetaHash.html#1225" class="Function">showList</a> <a id="1347" href="Hashing.MetaHash.html#1311" class="Bound">showA</a> <a id="1353" href="Hashing.MetaHash.html#1322" class="Bound">xs</a>

<a id="showRelevance"></a><a id="1357" href="Hashing.MetaHash.html#1357" class="Function">showRelevance</a> <a id="1371" class="Symbol">:</a> <a id="1373" href="Hashing.MetaHash.html#1117" class="Function">Show</a> <a id="1378" href="Agda.Builtin.Reflection.html#2854" class="Datatype">Relevance</a>
<a id="1388" href="Hashing.MetaHash.html#1357" class="Function">showRelevance</a> <a id="1402" href="Agda.Builtin.Reflection.html#2878" class="InductiveConstructor">relevant</a>   <a id="1413" class="Symbol">=</a> <a id="1415" class="String">&quot;relevant&quot;</a>
<a id="1426" href="Hashing.MetaHash.html#1357" class="Function">showRelevance</a> <a id="1440" href="Agda.Builtin.Reflection.html#2887" class="InductiveConstructor">irrelevant</a> <a id="1451" class="Symbol">=</a> <a id="1453" class="String">&quot;irrelevant&quot;</a>

<a id="showVisibility"></a><a id="1467" href="Hashing.MetaHash.html#1467" class="Function">showVisibility</a> <a id="1482" class="Symbol">:</a> <a id="1484" href="Hashing.MetaHash.html#1117" class="Function">Show</a> <a id="1489" href="Agda.Builtin.Reflection.html#2596" class="Datatype">Visibility</a>
<a id="1500" href="Hashing.MetaHash.html#1467" class="Function">showVisibility</a> <a id="1515" href="Agda.Builtin.Reflection.html#2621" class="InductiveConstructor">visible</a>   <a id="1525" class="Symbol">=</a> <a id="1527" class="String">&quot;visible&quot;</a>
<a id="1537" href="Hashing.MetaHash.html#1467" class="Function">showVisibility</a> <a id="1552" href="Agda.Builtin.Reflection.html#2629" class="InductiveConstructor">hidden</a>    <a id="1562" class="Symbol">=</a> <a id="1564" class="String">&quot;hidden&quot;</a>
<a id="1573" href="Hashing.MetaHash.html#1467" class="Function">showVisibility</a> <a id="1588" href="Agda.Builtin.Reflection.html#2636" class="InductiveConstructor">instance′</a> <a id="1598" class="Symbol">=</a> <a id="1600" class="String">&quot;instance&quot;</a>

<a id="showArg"></a><a id="1612" href="Hashing.MetaHash.html#1612" class="Function">showArg</a> <a id="1620" class="Symbol">:</a> <a id="1622" class="Symbol">∀</a> <a id="1624" class="Symbol">{</a><a id="1625" href="Hashing.MetaHash.html#1625" class="Bound">A</a> <a id="1627" class="Symbol">:</a> <a id="1629" class="PrimitiveType">Set</a><a id="1632" class="Symbol">}</a> <a id="1634" class="Symbol">→</a> <a id="1636" href="Hashing.MetaHash.html#1117" class="Function">Show</a> <a id="1641" href="Hashing.MetaHash.html#1625" class="Bound">A</a> <a id="1643" class="Symbol">→</a> <a id="1645" href="Hashing.MetaHash.html#1117" class="Function">Show</a> <a id="1650" class="Symbol">(</a><a id="1651" href="Agda.Builtin.Reflection.html#3113" class="Datatype">Arg</a> <a id="1655" href="Hashing.MetaHash.html#1625" class="Bound">A</a><a id="1656" class="Symbol">)</a>
<a id="1658" href="Hashing.MetaHash.html#1612" class="Function">showArg</a> <a id="1666" href="Hashing.MetaHash.html#1666" class="Bound">showA</a> <a id="1672" class="Symbol">(</a><a id="1673" href="Agda.Builtin.Reflection.html#3141" class="InductiveConstructor">arg</a> <a id="1677" class="Symbol">(</a><a id="1678" href="Agda.Builtin.Reflection.html#3053" class="InductiveConstructor">arg-info</a> <a id="1687" href="Hashing.MetaHash.html#1687" class="Bound">v</a> <a id="1689" href="Hashing.MetaHash.html#1689" class="Bound">r</a><a id="1690" class="Symbol">)</a> <a id="1692" href="Hashing.MetaHash.html#1692" class="Bound">x</a><a id="1693" class="Symbol">)</a> <a id="1695" class="Symbol">=</a> <a id="1697" class="String">&quot;arg&quot;</a> <a id="1703" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="1705" href="Hashing.MetaHash.html#1467" class="Function">showVisibility</a> <a id="1720" href="Hashing.MetaHash.html#1687" class="Bound">v</a> <a id="1722" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="1724" href="Hashing.MetaHash.html#1357" class="Function">showRelevance</a> <a id="1738" href="Hashing.MetaHash.html#1689" class="Bound">r</a> <a id="1740" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="1742" href="Hashing.MetaHash.html#1666" class="Bound">showA</a> <a id="1748" href="Hashing.MetaHash.html#1692" class="Bound">x</a>

<a id="showPat"></a><a id="1751" href="Hashing.MetaHash.html#1751" class="Function">showPat</a> <a id="1759" class="Symbol">:</a> <a id="1761" href="Hashing.MetaHash.html#1117" class="Function">Show</a> <a id="1766" href="Agda.Builtin.Reflection.html#4077" class="Datatype">Pattern</a>
<a id="showClause"></a><a id="1774" href="Hashing.MetaHash.html#1774" class="Function">showClause</a> <a id="1785" class="Symbol">:</a> <a id="1787" href="Hashing.MetaHash.html#1117" class="Function">Show</a> <a id="1792" href="Agda.Builtin.Reflection.html#4602" class="Datatype">Clause</a>
<a id="showSort"></a><a id="1799" href="Hashing.MetaHash.html#1799" class="Function">showSort</a> <a id="1808" class="Symbol">:</a> <a id="1810" href="Hashing.MetaHash.html#1117" class="Function">Show</a> <a id="1815" href="Agda.Builtin.Reflection.html#4584" class="Datatype">Sort</a>
<a id="showTerm"></a><a id="1820" href="Hashing.MetaHash.html#1820" class="Function">showTerm</a> <a id="1829" class="Symbol">:</a> <a id="1831" href="Hashing.MetaHash.html#1117" class="Function">Show</a> <a id="1836" href="Agda.Builtin.Reflection.html#4620" class="Datatype">Term</a>

<a id="showPats"></a><a id="1842" href="Hashing.MetaHash.html#1842" class="Function">showPats</a> <a id="1851" class="Symbol">:</a> <a id="1853" href="Hashing.MetaHash.html#1117" class="Function">Show</a> <a id="1858" class="Symbol">(</a><a id="1859" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="1864" class="Symbol">(</a><a id="1865" href="Agda.Builtin.Reflection.html#3113" class="Datatype">Arg</a> <a id="1869" href="Agda.Builtin.Reflection.html#4077" class="Datatype">Pattern</a><a id="1876" class="Symbol">))</a>
<a id="1879" href="Hashing.MetaHash.html#1842" class="Function">showPats</a> <a id="1888" class="Symbol">=</a> <a id="1890" href="Hashing.MetaHash.html#1225" class="Function">showList</a> <a id="1899" class="Symbol">(</a><a id="1900" href="Hashing.MetaHash.html#1612" class="Function">showArg</a> <a id="1908" href="Hashing.MetaHash.html#1751" class="Function">showPat</a><a id="1915" class="Symbol">)</a>

<a id="showArgs"></a><a id="1918" href="Hashing.MetaHash.html#1918" class="Function">showArgs</a> <a id="1927" class="Symbol">:</a> <a id="1929" href="Hashing.MetaHash.html#1117" class="Function">Show</a> <a id="1934" class="Symbol">(</a><a id="1935" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="1940" class="Symbol">(</a><a id="1941" href="Agda.Builtin.Reflection.html#3113" class="Datatype">Arg</a> <a id="1945" href="Agda.Builtin.Reflection.html#4620" class="Datatype">Term</a><a id="1949" class="Symbol">))</a>
<a id="1952" href="Hashing.MetaHash.html#1918" class="Function">showArgs</a> <a id="1961" class="Symbol">=</a> <a id="1963" href="Hashing.MetaHash.html#1225" class="Function">showList</a> <a id="1972" class="Symbol">(</a><a id="1973" href="Hashing.MetaHash.html#1612" class="Function">showArg</a> <a id="1981" href="Hashing.MetaHash.html#1820" class="Function">showTerm</a><a id="1989" class="Symbol">)</a>

<a id="1992" class="Symbol">{-#</a> <a id="1996" class="Keyword">TERMINATING</a> <a id="2008" class="Symbol">#-}</a>
<a id="2012" href="Hashing.MetaHash.html#1751" class="Function">showPat</a> <a id="2020" class="Symbol">(</a><a id="2021" href="Agda.Builtin.Reflection.html#4099" class="InductiveConstructor">con</a> <a id="2025" href="Hashing.MetaHash.html#2025" class="Bound">c</a> <a id="2027" href="Hashing.MetaHash.html#2027" class="Bound">ps</a><a id="2029" class="Symbol">)</a> <a id="2031" class="Symbol">=</a> <a id="2033" class="String">&quot;con&quot;</a> <a id="2039" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2041" href="Reflection.html#1822" class="Function">showName</a> <a id="2050" href="Hashing.MetaHash.html#2025" class="Bound">c</a> <a id="2052" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2054" href="Hashing.MetaHash.html#1842" class="Function">showPats</a> <a id="2063" href="Hashing.MetaHash.html#2027" class="Bound">ps</a>
<a id="2066" href="Hashing.MetaHash.html#1751" class="Function">showPat</a> <a id="2074" href="Agda.Builtin.Reflection.html#4157" class="InductiveConstructor">dot</a>        <a id="2085" class="Symbol">=</a> <a id="2087" class="String">&quot;dot&quot;</a>
<a id="2093" href="Hashing.MetaHash.html#1751" class="Function">showPat</a> <a id="2101" class="Symbol">(</a><a id="2102" href="Agda.Builtin.Reflection.html#4176" class="InductiveConstructor">var</a> <a id="2106" href="Hashing.MetaHash.html#2106" class="Bound">s</a><a id="2107" class="Symbol">)</a>    <a id="2112" class="Symbol">=</a> <a id="2114" class="String">&quot;var&quot;</a> <a id="2120" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2122" href="Hashing.MetaHash.html#2106" class="Bound">s</a>
<a id="2124" href="Hashing.MetaHash.html#1751" class="Function">showPat</a> <a id="2132" class="Symbol">(</a><a id="2133" href="Agda.Builtin.Reflection.html#4211" class="InductiveConstructor">lit</a> <a id="2137" href="Hashing.MetaHash.html#2137" class="Bound">l</a><a id="2138" class="Symbol">)</a>    <a id="2143" class="Symbol">=</a> <a id="2145" class="String">&quot;lit&quot;</a> <a id="2151" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2153" href="Reflection.html#4978" class="Function">showLiteral</a> <a id="2165" href="Hashing.MetaHash.html#2137" class="Bound">l</a>
<a id="2167" href="Hashing.MetaHash.html#1751" class="Function">showPat</a> <a id="2175" class="Symbol">(</a><a id="2176" href="Agda.Builtin.Reflection.html#4246" class="InductiveConstructor">proj</a> <a id="2181" href="Hashing.MetaHash.html#2181" class="Bound">f</a><a id="2182" class="Symbol">)</a>   <a id="2186" class="Symbol">=</a> <a id="2188" class="String">&quot;proj&quot;</a> <a id="2195" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2197" href="Reflection.html#1822" class="Function">showName</a> <a id="2206" href="Hashing.MetaHash.html#2181" class="Bound">f</a>
<a id="2208" href="Hashing.MetaHash.html#1751" class="Function">showPat</a> <a id="2216" href="Agda.Builtin.Reflection.html#4281" class="InductiveConstructor">absurd</a>     <a id="2227" class="Symbol">=</a> <a id="2229" class="String">&quot;absurd&quot;</a>

<a id="2239" class="Symbol">{-#</a> <a id="2243" class="Keyword">TERMINATING</a> <a id="2255" class="Symbol">#-}</a>
<a id="2259" href="Hashing.MetaHash.html#1820" class="Function">showTerm</a> <a id="2268" class="Symbol">(</a><a id="2269" href="Agda.Builtin.Reflection.html#4664" class="InductiveConstructor">var</a> <a id="2273" href="Hashing.MetaHash.html#2273" class="Bound">x</a> <a id="2275" href="Hashing.MetaHash.html#2275" class="Bound">args</a><a id="2279" class="Symbol">)</a>      <a id="2286" class="Symbol">=</a> <a id="2288" class="String">&quot;var&quot;</a> <a id="2294" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2296" href="Data.Nat.Show.html#1075" class="Function">show</a> <a id="2301" href="Hashing.MetaHash.html#2273" class="Bound">x</a> <a id="2303" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2305" href="Hashing.MetaHash.html#1918" class="Function">showArgs</a> <a id="2314" href="Hashing.MetaHash.html#2275" class="Bound">args</a>
<a id="2319" href="Hashing.MetaHash.html#1820" class="Function">showTerm</a> <a id="2328" class="Symbol">(</a><a id="2329" href="Agda.Builtin.Reflection.html#4720" class="InductiveConstructor">con</a> <a id="2333" href="Hashing.MetaHash.html#2333" class="Bound">c</a> <a id="2335" href="Hashing.MetaHash.html#2335" class="Bound">args</a><a id="2339" class="Symbol">)</a>      <a id="2346" class="Symbol">=</a> <a id="2348" class="String">&quot;con&quot;</a> <a id="2354" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2356" href="Reflection.html#1822" class="Function">showName</a> <a id="2365" href="Hashing.MetaHash.html#2333" class="Bound">c</a> <a id="2367" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2369" href="Hashing.MetaHash.html#1918" class="Function">showArgs</a> <a id="2378" href="Hashing.MetaHash.html#2335" class="Bound">args</a>
<a id="2383" href="Hashing.MetaHash.html#1820" class="Function">showTerm</a> <a id="2392" class="Symbol">(</a><a id="2393" href="Agda.Builtin.Reflection.html#4777" class="InductiveConstructor">def</a> <a id="2397" href="Hashing.MetaHash.html#2397" class="Bound">f</a> <a id="2399" href="Hashing.MetaHash.html#2399" class="Bound">args</a><a id="2403" class="Symbol">)</a>      <a id="2410" class="Symbol">=</a> <a id="2412" class="String">&quot;def&quot;</a> <a id="2418" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2420" href="Reflection.html#1822" class="Function">showName</a> <a id="2429" href="Hashing.MetaHash.html#2397" class="Bound">f</a> <a id="2431" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2433" href="Hashing.MetaHash.html#1918" class="Function">showArgs</a> <a id="2442" href="Hashing.MetaHash.html#2399" class="Bound">args</a>
<a id="2447" href="Hashing.MetaHash.html#1820" class="Function">showTerm</a> <a id="2456" class="Symbol">(</a><a id="2457" href="Agda.Builtin.Reflection.html#4834" class="InductiveConstructor">lam</a> <a id="2461" href="Hashing.MetaHash.html#2461" class="Bound">v</a> <a id="2463" class="Symbol">(</a><a id="2464" href="Agda.Builtin.Reflection.html#3380" class="InductiveConstructor">abs</a> <a id="2468" href="Hashing.MetaHash.html#2468" class="Bound">s</a> <a id="2470" href="Hashing.MetaHash.html#2470" class="Bound">e</a><a id="2471" class="Symbol">))</a> <a id="2474" class="Symbol">=</a> <a id="2476" class="String">&quot;lam&quot;</a> <a id="2482" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2484" href="Hashing.MetaHash.html#1467" class="Function">showVisibility</a> <a id="2499" href="Hashing.MetaHash.html#2461" class="Bound">v</a> <a id="2501" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2503" class="String">&quot;abs&quot;</a> <a id="2509" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2511" href="Hashing.MetaHash.html#2468" class="Bound">s</a> <a id="2513" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2515" href="Hashing.MetaHash.html#1820" class="Function">showTerm</a> <a id="2524" href="Hashing.MetaHash.html#2470" class="Bound">e</a>
<a id="2526" href="Hashing.MetaHash.html#1820" class="Function">showTerm</a> <a id="2535" class="Symbol">(</a><a id="2536" href="Agda.Builtin.Reflection.html#4887" class="InductiveConstructor">pat-lam</a> <a id="2544" href="Hashing.MetaHash.html#2544" class="Bound">cs</a> <a id="2547" href="Hashing.MetaHash.html#2547" class="Bound">args</a><a id="2551" class="Symbol">)</a> <a id="2553" class="Symbol">=</a> <a id="2555" class="String">&quot;pat-lam&quot;</a> <a id="2565" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2567" href="Hashing.MetaHash.html#1225" class="Function">showList</a> <a id="2576" href="Hashing.MetaHash.html#1774" class="Function">showClause</a> <a id="2587" href="Hashing.MetaHash.html#2544" class="Bound">cs</a> <a id="2590" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2592" href="Hashing.MetaHash.html#1918" class="Function">showArgs</a> <a id="2601" href="Hashing.MetaHash.html#2547" class="Bound">args</a>
<a id="2606" href="Hashing.MetaHash.html#1820" class="Function">showTerm</a> <a id="2615" class="Symbol">(</a><a id="2616" href="Agda.Builtin.Reflection.html#4952" class="InductiveConstructor">pi</a> <a id="2619" href="Hashing.MetaHash.html#2619" class="Bound">e</a> <a id="2621" class="Symbol">(</a><a id="2622" href="Agda.Builtin.Reflection.html#3380" class="InductiveConstructor">abs</a> <a id="2626" href="Hashing.MetaHash.html#2626" class="Bound">s</a> <a id="2628" href="Hashing.MetaHash.html#2628" class="Bound">e′</a><a id="2630" class="Symbol">))</a> <a id="2633" class="Symbol">=</a> <a id="2635" class="String">&quot;pi&quot;</a> <a id="2640" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2642" href="Hashing.MetaHash.html#1612" class="Function">showArg</a> <a id="2650" href="Hashing.MetaHash.html#1820" class="Function">showTerm</a> <a id="2659" href="Hashing.MetaHash.html#2619" class="Bound">e</a> <a id="2661" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2663" class="String">&quot;abs&quot;</a> <a id="2669" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2671" href="Hashing.MetaHash.html#2626" class="Bound">s</a> <a id="2673" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2675" href="Hashing.MetaHash.html#1820" class="Function">showTerm</a> <a id="2684" href="Hashing.MetaHash.html#2628" class="Bound">e′</a>
<a id="2687" href="Hashing.MetaHash.html#1820" class="Function">showTerm</a> <a id="2696" class="Symbol">(</a><a id="2697" href="Agda.Builtin.Reflection.html#5003" class="InductiveConstructor">sort</a> <a id="2702" href="Hashing.MetaHash.html#2702" class="Bound">s</a><a id="2703" class="Symbol">)</a>          <a id="2714" class="Symbol">=</a> <a id="2716" class="String">&quot;sort&quot;</a> <a id="2723" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2725" href="Hashing.MetaHash.html#1799" class="Function">showSort</a> <a id="2734" href="Hashing.MetaHash.html#2702" class="Bound">s</a>
<a id="2736" href="Hashing.MetaHash.html#1820" class="Function">showTerm</a> <a id="2745" class="Symbol">(</a><a id="2746" href="Agda.Builtin.Reflection.html#5035" class="InductiveConstructor">lit</a> <a id="2750" href="Hashing.MetaHash.html#2750" class="Bound">l</a><a id="2751" class="Symbol">)</a>           <a id="2763" class="Symbol">=</a> <a id="2765" href="Reflection.html#4978" class="Function">showLiteral</a> <a id="2777" href="Hashing.MetaHash.html#2750" class="Bound">l</a>
<a id="2779" href="Hashing.MetaHash.html#1820" class="Function">showTerm</a> <a id="2788" class="Symbol">(</a><a id="2789" href="Agda.Builtin.Reflection.html#5070" class="InductiveConstructor">meta</a> <a id="2794" href="Hashing.MetaHash.html#2794" class="Bound">m</a> <a id="2796" href="Hashing.MetaHash.html#2796" class="Bound">es</a><a id="2798" class="Symbol">)</a>       <a id="2806" class="Symbol">=</a> <a id="2808" class="String">&quot;meta&quot;</a> <a id="2815" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2817" href="Reflection.html#2619" class="Function">showMeta</a> <a id="2826" href="Hashing.MetaHash.html#2794" class="Bound">m</a> <a id="2828" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="2830" href="Hashing.MetaHash.html#1225" class="Function">showList</a> <a id="2839" class="Symbol">(</a><a id="2840" href="Hashing.MetaHash.html#1612" class="Function">showArg</a> <a id="2848" href="Hashing.MetaHash.html#1820" class="Function">showTerm</a><a id="2856" class="Symbol">)</a> <a id="2858" href="Hashing.MetaHash.html#2796" class="Bound">es</a>
<a id="2861" href="Hashing.MetaHash.html#1820" class="Function">showTerm</a> <a id="2870" href="Agda.Builtin.Reflection.html#5120" class="InductiveConstructor">unknown</a>           <a id="2888" class="Symbol">=</a> <a id="2890" class="String">&quot;_&quot;</a>

<a id="2895" href="Hashing.MetaHash.html#1799" class="Function">showSort</a> <a id="2904" class="Symbol">(</a><a id="2905" href="Agda.Builtin.Reflection.html#5156" class="InductiveConstructor">set</a> <a id="2909" href="Hashing.MetaHash.html#2909" class="Bound">t</a><a id="2910" class="Symbol">)</a> <a id="2912" class="Symbol">=</a> <a id="2914" href="Hashing.MetaHash.html#1820" class="Function">showTerm</a> <a id="2923" href="Hashing.MetaHash.html#2909" class="Bound">t</a>
<a id="2925" href="Hashing.MetaHash.html#1799" class="Function">showSort</a> <a id="2934" class="Symbol">(</a><a id="2935" href="Agda.Builtin.Reflection.html#5186" class="InductiveConstructor">lit</a> <a id="2939" href="Hashing.MetaHash.html#2939" class="Bound">n</a><a id="2940" class="Symbol">)</a> <a id="2942" class="Symbol">=</a> <a id="2944" href="Data.Nat.Show.html#1075" class="Function">show</a> <a id="2949" href="Hashing.MetaHash.html#2939" class="Bound">n</a>
<a id="2951" href="Hashing.MetaHash.html#1799" class="Function">showSort</a> <a id="2960" href="Agda.Builtin.Reflection.html#5215" class="InductiveConstructor">unknown</a> <a id="2968" class="Symbol">=</a> <a id="2970" class="String">&quot;_&quot;</a>

<a id="2975" href="Hashing.MetaHash.html#1774" class="Function">showClause</a> <a id="2986" class="Symbol">(</a><a id="2987" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">clause</a> <a id="2994" href="Hashing.MetaHash.html#2994" class="Bound">ps</a> <a id="2997" href="Hashing.MetaHash.html#2997" class="Bound">t</a><a id="2998" class="Symbol">)</a>      <a id="3005" class="Symbol">=</a> <a id="3007" class="String">&quot;clause&quot;</a> <a id="3016" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="3018" href="Hashing.MetaHash.html#1842" class="Function">showPats</a> <a id="3027" href="Hashing.MetaHash.html#2994" class="Bound">ps</a> <a id="3030" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="3032" href="Hashing.MetaHash.html#1820" class="Function">showTerm</a> <a id="3041" href="Hashing.MetaHash.html#2997" class="Bound">t</a>
<a id="3043" href="Hashing.MetaHash.html#1774" class="Function">showClause</a> <a id="3054" class="Symbol">(</a><a id="3055" href="Agda.Builtin.Reflection.html#5315" class="InductiveConstructor">absurd-clause</a> <a id="3069" href="Hashing.MetaHash.html#3069" class="Bound">ps</a><a id="3071" class="Symbol">)</a> <a id="3073" class="Symbol">=</a> <a id="3075" class="String">&quot;absurd-clause&quot;</a> <a id="3091" href="Hashing.MetaHash.html#1169" class="Function Operator">◇</a> <a id="3093" href="Hashing.MetaHash.html#1842" class="Function">showPats</a> <a id="3102" href="Hashing.MetaHash.html#3069" class="Bound">ps</a>

<a id="3106" class="Comment">-- Finally, the meta hashing function.</a>

<a id="3146" class="Comment">-- macro</a>
<a id="3155" class="Comment">--   metaHash : Term → Term → TC ⊤</a>
<a id="3190" class="Comment">--   metaHash (var n []) hole = do</a>
<a id="3225" class="Comment">--     ctx ← getContext</a>
<a id="3249" class="Comment">--     typeError [ strErr (show n) ]</a>
<a id="3286" class="Comment">--   metaHash t          _    = typeError [ termErr t ]</a>
<a id="3342" class="Comment">-- ← getDefinition</a>
<a id="3361" class="Comment">-- do `s ← quoteTC (showTerm t)</a>
<a id="3393" class="Comment">--    unify hole `s</a>

<a id="3414" class="Comment">-- !!! DOES NOT WORK, I need runtime reflection :(</a>
<a id="3465" class="Comment">-- _♯ : ∀ {ℓ} {A : Set ℓ} → Hash A</a>
<a id="3500" class="Comment">-- x ♯ = (metaHash x) ♯ₛₜᵣ</a>

<a id="3528" class="Keyword">postulate</a>
  <a id="_♯"></a><a id="3540" href="Hashing.MetaHash.html#3540" class="Postulate Operator">_♯</a> <a id="3543" class="Symbol">:</a> <a id="3545" class="Symbol">∀</a> <a id="3547" class="Symbol">{</a><a id="3548" href="Hashing.MetaHash.html#3548" class="Bound">ℓ</a><a id="3549" class="Symbol">}</a> <a id="3551" class="Symbol">{</a><a id="3552" href="Hashing.MetaHash.html#3552" class="Bound">A</a> <a id="3554" class="Symbol">:</a> <a id="3556" class="PrimitiveType">Set</a> <a id="3560" href="Hashing.MetaHash.html#3548" class="Bound">ℓ</a><a id="3561" class="Symbol">}</a> <a id="3563" class="Symbol">→</a> <a id="3565" href="Hashing.Base.html#621" class="Function">Hash</a> <a id="3570" href="Hashing.MetaHash.html#3552" class="Bound">A</a>
  <a id="♯-injective"></a><a id="3574" href="Hashing.MetaHash.html#3574" class="Postulate">♯-injective</a> <a id="3586" class="Symbol">:</a> <a id="3588" class="Symbol">∀</a> <a id="3590" class="Symbol">{</a><a id="3591" href="Hashing.MetaHash.html#3591" class="Bound">ℓ</a><a id="3592" class="Symbol">}</a> <a id="3594" class="Symbol">{</a><a id="3595" href="Hashing.MetaHash.html#3595" class="Bound">A</a> <a id="3597" class="Symbol">:</a> <a id="3599" class="PrimitiveType">Set</a> <a id="3603" href="Hashing.MetaHash.html#3591" class="Bound">ℓ</a><a id="3604" class="Symbol">}</a> <a id="3606" class="Symbol">→</a> <a id="3608" href="Hashing.Base.html#672" class="Function">Injective</a> <a id="3618" class="Symbol">{</a><a id="3619" href="Hashing.MetaHash.html#3591" class="Bound">ℓ</a><a id="3620" class="Symbol">}</a> <a id="3622" class="Symbol">{</a><a id="3623" href="Hashing.MetaHash.html#3595" class="Bound">A</a><a id="3624" class="Symbol">}</a> <a id="3626" href="Hashing.MetaHash.html#3540" class="Postulate Operator">_♯</a>
</pre></body></html>