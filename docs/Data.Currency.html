<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Currency</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Multi-currency support.</a>
<a id="101" class="Comment">------------------------------------------------------------------------</a>
<a id="174" class="Keyword">module</a> <a id="181" href="Data.Currency.html" class="Module">Data.Currency</a> <a id="195" class="Keyword">where</a>

<a id="202" class="Keyword">open</a> <a id="207" class="Keyword">import</a> <a id="214" href="Function.html" class="Module">Function</a>     <a id="227" class="Keyword">using</a> <a id="233" class="Symbol">(</a><a id="234" href="Function.html#1085" class="Function Operator">_∘_</a><a id="237" class="Symbol">)</a>
<a id="239" class="Keyword">open</a> <a id="244" class="Keyword">import</a> <a id="251" href="Data.Product.html" class="Module">Data.Product</a> <a id="264" class="Keyword">using</a> <a id="270" class="Symbol">(</a><a id="271" href="Data.Product.html#1162" class="Function Operator">_×_</a><a id="274" class="Symbol">;</a> <a id="276" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">_,_</a><a id="279" class="Symbol">;</a> <a id="281" href="Agda.Builtin.Sigma.html#225" class="Field">proj₁</a><a id="286" class="Symbol">;</a> <a id="288" href="Agda.Builtin.Sigma.html#237" class="Field">proj₂</a><a id="293" class="Symbol">)</a>
<a id="295" class="Keyword">open</a> <a id="300" class="Keyword">import</a> <a id="307" href="Data.Maybe.html" class="Module">Data.Maybe</a>   <a id="320" class="Keyword">using</a> <a id="326" class="Symbol">(</a><a id="327" href="Data.Maybe.Base.html#1572" class="Function">fromMaybe</a><a id="336" class="Symbol">)</a>
<a id="338" class="Keyword">open</a> <a id="343" class="Keyword">import</a> <a id="350" href="Data.Nat.html" class="Module">Data.Nat</a>     <a id="363" class="Keyword">using</a> <a id="369" class="Symbol">(</a><a id="370" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a><a id="371" class="Symbol">;</a> <a id="373" href="Agda.Builtin.Nat.html#298" class="Primitive Operator">_+_</a><a id="376" class="Symbol">;</a> <a id="378" href="Data.Nat.Properties.html#2208" class="Function Operator">_≟_</a><a id="381" class="Symbol">)</a>
<a id="383" class="Keyword">open</a> <a id="388" class="Keyword">import</a> <a id="395" href="Data.List.html" class="Module">Data.List</a>    <a id="408" class="Keyword">using</a> <a id="414" class="Symbol">(</a><a id="415" href="Agda.Builtin.List.html#121" class="Datatype">List</a><a id="419" class="Symbol">;</a> <a id="421" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">_∷_</a><a id="424" class="Symbol">;</a> <a id="426" href="Data.List.Base.html#8786" class="InductiveConstructor">[]</a><a id="428" class="Symbol">;</a> <a id="430" href="Data.List.Base.html#4024" class="Function">sum</a><a id="433" class="Symbol">;</a> <a id="435" href="Data.List.Base.html#1304" class="Function">map</a><a id="438" class="Symbol">;</a> <a id="440" href="Data.List.Base.html#3533" class="Function">foldl</a><a id="445" class="Symbol">)</a>

<a id="448" class="Keyword">open</a> <a id="453" class="Keyword">import</a> <a id="460" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="480" class="Keyword">using</a> <a id="486" class="Symbol">(</a><a id="487" href="Data.Nat.Properties.html#9658" class="Function">&lt;-strictTotalOrder</a><a id="505" class="Symbol">;</a> <a id="507" href="Data.Nat.Properties.html#9349" class="Function">&lt;-isStrictTotalOrder</a><a id="527" class="Symbol">)</a>

<a id="530" class="Keyword">open</a> <a id="535" class="Keyword">import</a> <a id="542" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="559" class="Keyword">using</a> <a id="565" class="Symbol">(</a><a id="566" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a><a id="569" class="Symbol">;</a> <a id="571" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a><a id="573" class="Symbol">)</a>
<a id="575" class="Keyword">open</a> <a id="580" class="Keyword">import</a> <a id="587" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="603" class="Keyword">using</a> <a id="609" class="Symbol">(</a><a id="610" href="Relation.Binary.html#11410" class="Record">StrictTotalOrder</a><a id="626" class="Symbol">;</a> <a id="628" href="Relation.Binary.Core.html#1071" class="Function">Rel</a><a id="631" class="Symbol">;</a> <a id="633" href="Relation.Binary.Core.html#5557" class="Function">Decidable</a><a id="642" class="Symbol">)</a>
<a id="644" class="Keyword">open</a> <a id="649" class="Keyword">import</a> <a id="656" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="694" class="Keyword">using</a> <a id="700" class="Symbol">(</a><a id="701" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">_≡_</a><a id="704" class="Symbol">;</a> <a id="706" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="710" class="Symbol">;</a> <a id="712" href="Relation.Binary.PropositionalEquality.Core.html#1035" class="Function">subst</a><a id="717" class="Symbol">)</a>

<a id="720" class="Comment">------------------------------------------------------------------------</a>
<a id="793" class="Comment">-- Currency maps.</a>

<a id="$"></a><a id="812" href="Data.Currency.html#812" class="Function">$</a> <a id="814" class="Symbol">:</a> <a id="816" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a> <a id="818" class="Symbol">→</a> <a id="820" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a>
<a id="822" href="Data.Currency.html#812" class="Function">$</a> <a id="824" href="Data.Currency.html#824" class="Bound">v</a> <a id="826" class="Symbol">=</a> <a id="828" href="Data.Currency.html#824" class="Bound">v</a>

<a id="Value"></a><a id="831" href="Data.Currency.html#831" class="Function">Value</a> <a id="837" class="Symbol">=</a> <a id="839" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="844" class="Symbol">(</a><a id="845" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a> <a id="847" href="Data.Product.html#1162" class="Function Operator">×</a> <a id="849" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a><a id="850" class="Symbol">)</a>

<a id="853" class="Keyword">open</a> <a id="858" class="Keyword">import</a> <a id="865" href="Data.AVL.html" class="Module">Data.AVL</a> <a id="874" href="Data.Nat.Properties.html#9658" class="Function">&lt;-strictTotalOrder</a> <a id="893" class="Keyword">public</a>
  <a id="902" class="Keyword">renaming</a> <a id="911" class="Symbol">(</a>Tree <a id="917" class="Symbol">to</a> Tree&#39;<a id="925" class="Symbol">;</a> map <a id="931" class="Symbol">to</a> mapValues<a id="943" class="Symbol">)</a>
  <a id="947" class="Keyword">hiding</a>   <a id="956" class="Symbol">(</a>Value<a id="962" class="Symbol">)</a>

<a id="CurrencyMap"></a><a id="965" href="Data.Currency.html#965" class="Function">CurrencyMap</a> <a id="977" class="Symbol">=</a> <a id="979" href="Data.AVL.html#1369" class="Datatype">Tree&#39;</a> <a id="985" class="Symbol">(</a><a id="986" href="Data.AVL.Value.html#559" class="InductiveConstructor">MkValue</a> <a id="994" class="Symbol">(λ</a> <a id="997" href="Data.Currency.html#997" class="Bound">_</a> <a id="999" class="Symbol">→</a> <a id="1001" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a><a id="1002" class="Symbol">)</a> <a id="1004" class="Symbol">(</a><a id="1005" href="Relation.Binary.PropositionalEquality.Core.html#1035" class="Function">subst</a> <a id="1011" class="Symbol">(λ</a> <a id="1014" href="Data.Currency.html#1014" class="Bound">_</a> <a id="1016" class="Symbol">→</a> <a id="1018" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a><a id="1019" class="Symbol">)))</a>

<a id="_+ᶜ_"></a><a id="1024" href="Data.Currency.html#1024" class="Function Operator">_+ᶜ_</a> <a id="1029" class="Symbol">:</a> <a id="1031" href="Data.Currency.html#831" class="Function">Value</a> <a id="1037" class="Symbol">→</a> <a id="1039" href="Data.Currency.html#831" class="Function">Value</a> <a id="1045" class="Symbol">→</a> <a id="1047" href="Data.Currency.html#831" class="Function">Value</a>
<a id="1053" href="Data.Currency.html#1053" class="Bound">c</a> <a id="1055" href="Data.Currency.html#1024" class="Function Operator">+ᶜ</a> <a id="1058" href="Data.Currency.html#1058" class="Bound">c′</a> <a id="1061" class="Symbol">=</a> <a id="1063" href="Data.AVL.html#3132" class="Function">toList</a> <a id="1070" class="Symbol">(</a><a id="1071" href="Data.List.Base.html#3533" class="Function">foldl</a> <a id="1077" href="Data.Currency.html#1109" class="Function">go</a> <a id="1080" class="Symbol">(</a><a id="1081" href="Data.AVL.html#3019" class="Function">fromList</a> <a id="1090" href="Data.Currency.html#1053" class="Bound">c</a><a id="1091" class="Symbol">)</a> <a id="1093" href="Data.Currency.html#1058" class="Bound">c′</a><a id="1095" class="Symbol">)</a>
  <a id="1099" class="Keyword">where</a>
    <a id="1109" href="Data.Currency.html#1109" class="Function">go</a> <a id="1112" class="Symbol">:</a> <a id="1114" href="Data.Currency.html#965" class="Function">CurrencyMap</a> <a id="1126" class="Symbol">→</a> <a id="1128" class="Symbol">(</a><a id="1129" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a> <a id="1131" href="Data.Product.html#1162" class="Function Operator">×</a> <a id="1133" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a><a id="1134" class="Symbol">)</a> <a id="1136" class="Symbol">→</a> <a id="1138" href="Data.Currency.html#965" class="Function">CurrencyMap</a>
    <a id="1154" href="Data.Currency.html#1109" class="Function">go</a> <a id="1157" href="Data.Currency.html#1157" class="Bound">cur</a> <a id="1161" class="Symbol">(</a><a id="1162" href="Data.Currency.html#1162" class="Bound">currency</a> <a id="1171" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1173" href="Data.Currency.html#1173" class="Bound">value</a><a id="1178" class="Symbol">)</a> <a id="1180" class="Symbol">=</a> <a id="1182" href="Data.AVL.html#1817" class="Function">insertWith</a> <a id="1193" href="Data.Currency.html#1162" class="Bound">currency</a> <a id="1202" class="Symbol">((</a><a id="1204" href="Agda.Builtin.Nat.html#298" class="Primitive Operator">_+</a> <a id="1207" href="Data.Currency.html#1173" class="Bound">value</a><a id="1212" class="Symbol">)</a> <a id="1214" href="Function.html#1085" class="Function Operator">∘</a> <a id="1216" href="Data.Maybe.Base.html#1572" class="Function">fromMaybe</a> <a id="1226" class="Number">0</a><a id="1227" class="Symbol">)</a> <a id="1229" href="Data.Currency.html#1157" class="Bound">cur</a>

<a id="sumᶜ"></a><a id="1234" href="Data.Currency.html#1234" class="Function">sumᶜ</a> <a id="1239" class="Symbol">:</a> <a id="1241" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="1246" href="Data.Currency.html#831" class="Function">Value</a> <a id="1252" class="Symbol">→</a> <a id="1254" href="Data.Currency.html#831" class="Function">Value</a>
<a id="1260" href="Data.Currency.html#1234" class="Function">sumᶜ</a> <a id="1265" class="Symbol">=</a> <a id="1267" href="Data.List.Base.html#3533" class="Function">foldl</a> <a id="1273" href="Data.Currency.html#1024" class="Function Operator">_+ᶜ_</a> <a id="1278" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>

<a id="keys"></a><a id="1282" href="Data.Currency.html#1282" class="Function">keys</a> <a id="1287" class="Symbol">:</a> <a id="1289" href="Data.Currency.html#831" class="Function">Value</a> <a id="1295" class="Symbol">→</a> <a id="1297" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="1302" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a>
<a id="1304" href="Data.Currency.html#1282" class="Function">keys</a> <a id="1309" class="Symbol">=</a> <a id="1311" href="Data.List.Base.html#1304" class="Function">map</a> <a id="1315" href="Agda.Builtin.Sigma.html#225" class="Field">proj₁</a>

<a id="values"></a><a id="1322" href="Data.Currency.html#1322" class="Function">values</a> <a id="1329" class="Symbol">:</a> <a id="1331" href="Data.Currency.html#831" class="Function">Value</a> <a id="1337" class="Symbol">→</a> <a id="1339" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="1344" href="Agda.Builtin.Nat.html#165" class="Datatype">ℕ</a>
<a id="1346" href="Data.Currency.html#1322" class="Function">values</a> <a id="1353" class="Symbol">=</a> <a id="1355" href="Data.List.Base.html#1304" class="Function">map</a> <a id="1359" href="Agda.Builtin.Sigma.html#237" class="Field">proj₂</a>

<a id="ex-map"></a><a id="1366" href="Data.Currency.html#1366" class="Function">ex-map</a> <a id="1373" class="Symbol">:</a> <a id="1375" href="Data.Currency.html#831" class="Function">Value</a>
<a id="1381" href="Data.Currency.html#1366" class="Function">ex-map</a> <a id="1388" class="Symbol">=</a> <a id="1390" class="Symbol">(</a><a id="1391" class="Number">1</a> <a id="1393" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1395" href="Data.Currency.html#812" class="Function">$</a> <a id="1397" class="Number">50</a><a id="1399" class="Symbol">)</a>
       <a id="1408" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1410" class="Symbol">(</a><a id="1411" class="Number">2</a> <a id="1413" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1415" href="Data.Currency.html#812" class="Function">$</a> <a id="1417" class="Number">77</a><a id="1419" class="Symbol">)</a>
       <a id="1428" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1430" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>

<a id="1434" class="Keyword">infix</a> <a id="1440" class="Number">4</a> <a id="1442" href="Data.Currency.html#1447" class="Function Operator">_≟ᶜ_</a>
<a id="_≟ᶜ_"></a><a id="1447" href="Data.Currency.html#1447" class="Function Operator">_≟ᶜ_</a> <a id="1452" class="Symbol">:</a> <a id="1454" href="Relation.Binary.Core.html#5557" class="Function">Decidable</a> <a id="1464" class="Symbol">{</a><a id="1465" class="Argument">A</a> <a id="1467" class="Symbol">=</a> <a id="1469" href="Data.Currency.html#831" class="Function">Value</a><a id="1474" class="Symbol">}</a> <a id="1476" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">_≡_</a>
<a id="1480" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>           <a id="1493" href="Data.Currency.html#1447" class="Function Operator">≟ᶜ</a> <a id="1496" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>             <a id="1511" class="Symbol">=</a> <a id="1513" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="1517" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
<a id="1522" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>           <a id="1535" href="Data.Currency.html#1447" class="Function Operator">≟ᶜ</a> <a id="1538" class="Symbol">_</a> <a id="1540" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1542" class="Symbol">_</a>          <a id="1553" class="Symbol">=</a> <a id="1555" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="1558" class="Symbol">λ</a> <a id="1560" class="Symbol">()</a>
<a id="1563" class="Symbol">_</a> <a id="1565" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1567" class="Symbol">_</a>        <a id="1576" href="Data.Currency.html#1447" class="Function Operator">≟ᶜ</a> <a id="1579" href="Agda.Builtin.List.html#158" class="InductiveConstructor">[]</a>             <a id="1594" class="Symbol">=</a> <a id="1596" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="1599" class="Symbol">λ</a> <a id="1601" class="Symbol">()</a>
<a id="1604" class="Symbol">(</a><a id="1605" href="Data.Currency.html#1605" class="Bound">x</a> <a id="1607" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1609" href="Data.Currency.html#1609" class="Bound">y</a><a id="1610" class="Symbol">)</a> <a id="1612" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1614" href="Data.Currency.html#1614" class="Bound">xs</a> <a id="1617" href="Data.Currency.html#1447" class="Function Operator">≟ᶜ</a> <a id="1620" class="Symbol">(</a><a id="1621" href="Data.Currency.html#1621" class="Bound">x′</a> <a id="1624" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1626" href="Data.Currency.html#1626" class="Bound">y′</a><a id="1628" class="Symbol">)</a> <a id="1630" href="Agda.Builtin.List.html#173" class="InductiveConstructor Operator">∷</a> <a id="1632" href="Data.Currency.html#1632" class="Bound">ys</a> <a id="1635" class="Keyword">with</a> <a id="1640" href="Data.Currency.html#1605" class="Bound">x</a> <a id="1642" href="Data.Nat.Properties.html#2208" class="Function Operator">≟</a> <a id="1644" href="Data.Currency.html#1621" class="Bound">x′</a>
<a id="1647" class="Symbol">...</a> <a id="1651" class="Symbol">|</a> <a id="1653" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="1656" href="Data.Currency.html#1656" class="Bound">¬p</a>                    <a id="1678" class="Symbol">=</a> <a id="1680" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="1683" class="Symbol">λ{</a><a id="1685" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="1690" class="Symbol">→</a> <a id="1692" href="Data.Currency.html#1656" class="Bound">¬p</a> <a id="1695" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="1699" class="Symbol">}</a>
<a id="1701" class="Symbol">...</a> <a id="1705" class="Symbol">|</a> <a id="1707" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="1711" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>                 <a id="1732" class="Keyword">with</a> <a id="1737" class="Bound">y</a> <a id="1739" href="Data.Nat.Properties.html#2208" class="Function Operator">≟</a> <a id="1741" class="Bound">y′</a>
<a id="1744" class="Symbol">...</a> <a id="1748" class="Symbol">|</a> <a id="1750" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="1753" href="Data.Currency.html#1753" class="Bound">¬p</a>                    <a id="1775" class="Symbol">=</a> <a id="1777" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="1780" class="Symbol">λ{</a><a id="1782" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="1787" class="Symbol">→</a> <a id="1789" href="Data.Currency.html#1753" class="Bound">¬p</a> <a id="1792" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="1796" class="Symbol">}</a>
<a id="1798" class="Symbol">...</a> <a id="1802" class="Symbol">|</a> <a id="1804" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="1808" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>                 <a id="1829" class="Keyword">with</a> <a id="1834" class="Bound">xs</a> <a id="1837" href="Data.Currency.html#1447" class="Function Operator">≟ᶜ</a> <a id="1840" class="Bound">ys</a>
<a id="1843" class="Symbol">...</a> <a id="1847" class="Symbol">|</a> <a id="1849" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="1852" href="Data.Currency.html#1852" class="Bound">¬p</a>                    <a id="1874" class="Symbol">=</a> <a id="1876" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="1879" class="Symbol">λ{</a><a id="1881" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="1886" class="Symbol">→</a> <a id="1888" href="Data.Currency.html#1852" class="Bound">¬p</a> <a id="1891" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="1895" class="Symbol">}</a>
<a id="1897" class="Symbol">...</a> <a id="1901" class="Symbol">|</a> <a id="1903" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="1907" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>                 <a id="1928" class="Symbol">=</a> <a id="1930" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="1934" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
</pre></body></html>