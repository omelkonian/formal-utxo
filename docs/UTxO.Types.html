<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>UTxO.Types</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Basic UTxO types.</a>
<a id="95" class="Comment">------------------------------------------------------------------------</a>
<a id="168" class="Keyword">module</a> <a id="175" href="UTxO.Types.html" class="Module">UTxO.Types</a> <a id="186" class="Keyword">where</a>

<a id="193" class="Keyword">open</a> <a id="198" class="Keyword">import</a> <a id="205" href="Level.html" class="Module">Level</a>     <a id="215" class="Keyword">using</a> <a id="221" class="Symbol">(</a><a id="222" href="Agda.Primitive.html#408" class="Postulate">Level</a><a id="227" class="Symbol">;</a> <a id="229" href="Level.html#506" class="Function">0â„“</a><a id="231" class="Symbol">)</a>
<a id="233" class="Keyword">open</a> <a id="238" class="Keyword">import</a> <a id="245" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="255" class="Keyword">using</a> <a id="261" class="Symbol">(</a><a id="262" href="Agda.Builtin.Bool.html#135" class="Datatype">Bool</a><a id="266" class="Symbol">)</a>
<a id="268" class="Keyword">open</a> <a id="273" class="Keyword">import</a> <a id="280" href="Data.Nat.html" class="Module">Data.Nat</a>  <a id="290" class="Keyword">using</a> <a id="296" class="Symbol">(</a><a id="297" href="Agda.Builtin.Nat.html#165" class="Datatype">â„•</a><a id="298" class="Symbol">;</a> <a id="300" href="Data.Nat.Properties.html#2208" class="Function Operator">_â‰Ÿ_</a><a id="303" class="Symbol">)</a>
<a id="305" class="Keyword">open</a> <a id="310" class="Keyword">import</a> <a id="317" href="Data.List.html" class="Module">Data.List</a> <a id="327" class="Keyword">using</a> <a id="333" class="Symbol">(</a><a id="334" href="Agda.Builtin.List.html#121" class="Datatype">List</a><a id="338" class="Symbol">;</a> <a id="340" href="Data.List.Base.html#1304" class="Function">map</a><a id="343" class="Symbol">)</a>

<a id="346" class="Keyword">open</a> <a id="351" class="Keyword">import</a> <a id="358" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>                      <a id="396" class="Keyword">using</a> <a id="402" class="Symbol">(</a><a id="403" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a><a id="406" class="Symbol">;</a> <a id="408" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a><a id="410" class="Symbol">)</a>
<a id="412" class="Keyword">open</a> <a id="417" class="Keyword">import</a> <a id="424" href="Relation.Binary.html" class="Module">Relation.Binary</a>                       <a id="462" class="Keyword">using</a> <a id="468" class="Symbol">(</a><a id="469" href="Relation.Binary.Core.html#5557" class="Function">Decidable</a><a id="478" class="Symbol">)</a>
<a id="480" class="Keyword">open</a> <a id="485" class="Keyword">import</a> <a id="492" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="530" class="Keyword">using</a> <a id="536" class="Symbol">(</a><a id="537" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">_â‰¡_</a><a id="540" class="Symbol">;</a> <a id="542" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="546" class="Symbol">)</a>

<a id="549" class="Comment">-- Re-export list utilities.</a>
<a id="578" class="Keyword">open</a> <a id="583" class="Keyword">import</a> <a id="590" href="Utilities.Lists.html" class="Module">Utilities.Lists</a> <a id="606" class="Keyword">public</a>

<a id="614" class="Comment">-- Re-export type universe ğ•Œ.</a>
<a id="644" class="Keyword">open</a> <a id="649" class="Keyword">import</a> <a id="656" href="Data.TYPE.html" class="Module">Data.TYPE</a> <a id="666" class="Keyword">public</a>

<a id="674" class="Comment">-- Re-export currency maps.</a>
<a id="702" class="Keyword">open</a> <a id="707" class="Keyword">import</a> <a id="714" href="Utilities.Currency.html" class="Module">Utilities.Currency</a> <a id="733" class="Keyword">public</a>
  <a id="742" class="Keyword">using</a> <a id="748" class="Symbol">(</a> <a id="750" href="Utilities.Currency.html#764" class="Function">Value</a><a id="755" class="Symbol">;</a> <a id="757" href="Utilities.Currency.html#745" class="Function">$</a><a id="758" class="Symbol">;</a> <a id="760" href="Utilities.Currency.html#1380" class="Function Operator">_â‰Ÿá¶œ_</a><a id="764" class="Symbol">;</a> <a id="766" href="Utilities.Currency.html#957" class="Function Operator">_+á¶œ_</a><a id="770" class="Symbol">;</a> <a id="772" href="Utilities.Currency.html#1167" class="Function">sumá¶œ</a><a id="776" class="Symbol">;</a> <a id="778" href="Utilities.Currency.html#1215" class="Function">keys</a><a id="782" class="Symbol">;</a> <a id="784" href="Utilities.Currency.html#1255" class="Function">values</a><a id="790" class="Symbol">;</a> <a id="792" href="Data.AVL.html#2297" class="Function">mapValues</a> <a id="802" class="Symbol">)</a>

<a id="805" class="Comment">------------------------------------------------------------------------</a>
<a id="878" class="Comment">-- Basic types.</a>

<a id="HashId"></a><a id="895" href="UTxO.Types.html#895" class="Function">HashId</a> <a id="902" class="Symbol">:</a> <a id="904" class="PrimitiveType">Set</a>
<a id="908" href="UTxO.Types.html#895" class="Function">HashId</a> <a id="915" class="Symbol">=</a> <a id="917" href="Agda.Builtin.Nat.html#165" class="Datatype">â„•</a>

<a id="920" class="Keyword">record</a> <a id="State"></a><a id="927" href="UTxO.Types.html#927" class="Record">State</a> <a id="933" class="Symbol">:</a> <a id="935" class="PrimitiveType">Set</a> <a id="939" class="Keyword">where</a>
  <a id="947" class="Keyword">field</a>
    <a id="State.height"></a><a id="957" href="UTxO.Types.html#957" class="Field">height</a> <a id="964" class="Symbol">:</a> <a id="966" href="Agda.Builtin.Nat.html#165" class="Datatype">â„•</a>
<a id="968" class="Keyword">open</a> <a id="973" href="UTxO.Types.html#927" class="Module">State</a> <a id="979" class="Keyword">public</a>

<a id="getState"></a><a id="987" href="UTxO.Types.html#987" class="Function">getState</a> <a id="996" class="Symbol">:</a> <a id="998" class="Symbol">âˆ€</a> <a id="1000" class="Symbol">{</a><a id="1001" href="UTxO.Types.html#1001" class="Bound">A</a> <a id="1003" class="Symbol">:</a> <a id="1005" class="PrimitiveType">Set</a><a id="1008" class="Symbol">}</a> <a id="1010" class="Symbol">â†’</a> <a id="1012" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="1017" href="UTxO.Types.html#1001" class="Bound">A</a> <a id="1019" class="Symbol">â†’</a> <a id="1021" href="UTxO.Types.html#927" class="Record">State</a>
<a id="1027" href="UTxO.Types.html#987" class="Function">getState</a> <a id="1036" href="UTxO.Types.html#1036" class="Bound">l</a> <a id="1038" class="Symbol">=</a> <a id="1040" class="Keyword">record</a> <a id="1047" class="Symbol">{</a> <a id="1049" href="UTxO.Types.html#957" class="Field">height</a> <a id="1056" class="Symbol">=</a> <a id="1058" href="Data.List.Base.html#4104" class="Function">length</a> <a id="1065" href="UTxO.Types.html#1036" class="Bound">l</a> <a id="1067" class="Symbol">}</a>

<a id="1070" class="Comment">--------------------------------------------------------------------------------------</a>
<a id="1157" class="Comment">-- Pending transactions (i.e. parts of the transaction being passed to a validator).</a>

<a id="1243" class="Keyword">record</a> <a id="PendingTxInput"></a><a id="1250" href="UTxO.Types.html#1250" class="Record">PendingTxInput</a> <a id="1265" class="Symbol">:</a> <a id="1267" class="PrimitiveType">Set</a> <a id="1271" class="Keyword">where</a>
  <a id="1279" class="Keyword">field</a>
    <a id="PendingTxInput.value"></a><a id="1289" href="UTxO.Types.html#1289" class="Field">value</a>         <a id="1303" class="Symbol">:</a> <a id="1305" href="Utilities.Currency.html#764" class="Function">Value</a>
    <a id="PendingTxInput.validatorHash"></a><a id="1315" href="UTxO.Types.html#1315" class="Field">validatorHash</a> <a id="1329" class="Symbol">:</a> <a id="1331" href="UTxO.Types.html#895" class="Function">HashId</a>
    <a id="PendingTxInput.redeemerHash"></a><a id="1342" href="UTxO.Types.html#1342" class="Field">redeemerHash</a>  <a id="1356" class="Symbol">:</a> <a id="1358" href="UTxO.Types.html#895" class="Function">HashId</a>
    <a id="1369" class="Comment">-- dataHash      : HashId</a>

<a id="1396" class="Keyword">record</a> <a id="PendingTxOutput"></a><a id="1403" href="UTxO.Types.html#1403" class="Record">PendingTxOutput</a> <a id="1419" class="Symbol">:</a> <a id="1421" class="PrimitiveType">Set</a> <a id="1425" class="Keyword">where</a>
  <a id="1433" class="Keyword">field</a>
    <a id="PendingTxOutput.value"></a><a id="1443" href="UTxO.Types.html#1443" class="Field">value</a>         <a id="1457" class="Symbol">:</a> <a id="1459" href="Utilities.Currency.html#764" class="Function">Value</a>
    <a id="PendingTxOutput.dataHash"></a><a id="1469" href="UTxO.Types.html#1469" class="Field">dataHash</a>      <a id="1483" class="Symbol">:</a> <a id="1485" href="UTxO.Types.html#895" class="Function">HashId</a>
    <a id="1496" class="Comment">-- validatorHash : HashId</a>

<a id="1523" class="Keyword">record</a> <a id="PendingTx"></a><a id="1530" href="UTxO.Types.html#1530" class="Record">PendingTx</a> <a id="1540" class="Symbol">:</a> <a id="1542" class="PrimitiveType">Set</a> <a id="1546" class="Keyword">where</a>
  <a id="1554" class="Keyword">field</a>
    <a id="PendingTx.txHash"></a><a id="1564" href="UTxO.Types.html#1564" class="Field">txHash</a> <a id="1571" class="Symbol">:</a> <a id="1573" href="UTxO.Types.html#895" class="Function">HashId</a>   <a id="1582" class="Comment">-- ^ hash of the current validated transaction</a>

    <a id="PendingTx.inputs"></a><a id="1634" href="UTxO.Types.html#1634" class="Field">inputs</a>  <a id="1642" class="Symbol">:</a> <a id="1644" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="1649" href="UTxO.Types.html#1250" class="Record">PendingTxInput</a>
    <a id="PendingTx.outputs"></a><a id="1668" href="UTxO.Types.html#1668" class="Field">outputs</a> <a id="1676" class="Symbol">:</a> <a id="1678" href="Agda.Builtin.List.html#121" class="Datatype">List</a> <a id="1683" href="UTxO.Types.html#1403" class="Record">PendingTxOutput</a>
    <a id="PendingTx.forge"></a><a id="1703" href="UTxO.Types.html#1703" class="Field">forge</a>   <a id="1711" class="Symbol">:</a> <a id="1713" href="Utilities.Currency.html#764" class="Function">Value</a>
    <a id="PendingTx.fee"></a><a id="1723" href="UTxO.Types.html#1723" class="Field">fee</a>     <a id="1731" class="Symbol">:</a> <a id="1733" href="Utilities.Currency.html#764" class="Function">Value</a>

<a id="1740" class="Comment">--------------------------------------------------------------------------------------</a>
<a id="1827" class="Comment">-- Output references and inputs.</a>

<a id="1861" class="Keyword">record</a> <a id="TxOutputRef"></a><a id="1868" href="UTxO.Types.html#1868" class="Record">TxOutputRef</a> <a id="1880" class="Symbol">:</a> <a id="1882" class="PrimitiveType">Set</a> <a id="1886" class="Keyword">where</a>
  <a id="1894" class="Keyword">constructor</a> <a id="TxOutputRef._indexed-at_"></a><a id="1906" href="UTxO.Types.html#1906" class="InductiveConstructor Operator">_indexed-at_</a>
  <a id="1921" class="Keyword">field</a>
    <a id="TxOutputRef.id"></a><a id="1931" href="UTxO.Types.html#1931" class="Field">id</a>    <a id="1937" class="Symbol">:</a> <a id="1939" href="UTxO.Types.html#895" class="Function">HashId</a>
    <a id="TxOutputRef.index"></a><a id="1950" href="UTxO.Types.html#1950" class="Field">index</a> <a id="1956" class="Symbol">:</a> <a id="1958" href="Agda.Builtin.Nat.html#165" class="Datatype">â„•</a>
<a id="1960" class="Keyword">open</a> <a id="1965" href="UTxO.Types.html#1868" class="Module">TxOutputRef</a> <a id="1977" class="Keyword">public</a>

<a id="1985" class="Keyword">record</a> <a id="TxInput"></a><a id="1992" href="UTxO.Types.html#1992" class="Record">TxInput</a> <a id="2000" class="Symbol">:</a> <a id="2002" class="PrimitiveType">Set</a> <a id="2006" class="Keyword">where</a>
  <a id="2014" class="Keyword">field</a>
    <a id="TxInput.outputRef"></a><a id="2024" href="UTxO.Types.html#2024" class="Field">outputRef</a> <a id="2034" class="Symbol">:</a> <a id="2036" href="UTxO.Types.html#1868" class="Record">TxOutputRef</a>

    <a id="TxInput.R"></a><a id="2053" href="UTxO.Types.html#2053" class="Field">R</a>         <a id="2063" class="Symbol">:</a> <a id="2065" href="Data.TYPE.html#439" class="Datatype">ğ•Œ</a> <a id="2067" class="Comment">-- ^ intermediate type used by the redeemer script</a>
    <a id="TxInput.D"></a><a id="2122" href="UTxO.Types.html#2122" class="Field">D</a>         <a id="2132" class="Symbol">:</a> <a id="2134" href="Data.TYPE.html#439" class="Datatype">ğ•Œ</a> <a id="2136" class="Comment">-- ^ intermediate type used by the data script</a>

    <a id="TxInput.redeemer"></a><a id="2188" href="UTxO.Types.html#2188" class="Field">redeemer</a>  <a id="2198" class="Symbol">:</a> <a id="2200" href="UTxO.Types.html#927" class="Record">State</a> <a id="2206" class="Symbol">â†’</a> <a id="2208" href="Data.TYPE.html#558" class="Function">el</a> <a id="2211" href="UTxO.Types.html#2053" class="Field">R</a>
    <a id="TxInput.validator"></a><a id="2217" href="UTxO.Types.html#2217" class="Field">validator</a> <a id="2227" class="Symbol">:</a> <a id="2229" href="UTxO.Types.html#927" class="Record">State</a>     <a id="2239" class="Comment">-- ^ current blockchain state</a>
              <a id="2283" class="Symbol">â†’</a> <a id="2285" href="Utilities.Currency.html#764" class="Function">Value</a>     <a id="2295" class="Comment">-- ^ output value</a>
              <a id="2327" class="Symbol">â†’</a> <a id="2329" href="UTxO.Types.html#1530" class="Record">PendingTx</a> <a id="2339" class="Comment">-- ^ parts of the currently validated transaction</a>
              <a id="2403" class="Symbol">â†’</a> <a id="2405" href="Data.TYPE.html#558" class="Function">el</a> <a id="2408" href="UTxO.Types.html#2053" class="Field">R</a>      <a id="2415" class="Comment">-- ^ result value of the redeemer script</a>
              <a id="2470" class="Symbol">â†’</a> <a id="2472" href="Data.TYPE.html#558" class="Function">el</a> <a id="2475" href="UTxO.Types.html#2122" class="Field">D</a>      <a id="2482" class="Comment">-- ^ result value of the data script</a>
              <a id="2533" class="Symbol">â†’</a> <a id="2535" href="Agda.Builtin.Bool.html#135" class="Datatype">Bool</a>

<a id="2541" class="Keyword">open</a> <a id="2546" href="UTxO.Types.html#1992" class="Module">TxInput</a> <a id="2554" class="Keyword">public</a>



<a id="2564" class="Comment">------------------------------------------------------------------------</a>
<a id="2637" class="Comment">-- Set modules/types.</a>

<a id="2660" class="Keyword">import</a> <a id="2667" href="Data.Set%2527.html" class="Module">Data.Set&#39;</a> <a id="2677" class="Symbol">as</a> <a id="2680" class="Module">SET</a>

<a id="2685" class="Comment">-- Sets of output references</a>
<a id="_â‰Ÿâ‚’_"></a><a id="2714" href="UTxO.Types.html#2714" class="Function Operator">_â‰Ÿâ‚’_</a> <a id="2719" class="Symbol">:</a> <a id="2721" href="Relation.Binary.Core.html#5557" class="Function">Decidable</a> <a id="2731" class="Symbol">{</a><a id="2732" class="Argument">A</a> <a id="2734" class="Symbol">=</a> <a id="2736" href="UTxO.Types.html#1868" class="Record">TxOutputRef</a><a id="2747" class="Symbol">}</a> <a id="2749" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">_â‰¡_</a>
<a id="2753" href="UTxO.Types.html#2753" class="Bound">x</a> <a id="2755" href="UTxO.Types.html#2714" class="Function Operator">â‰Ÿâ‚’</a> <a id="2758" href="UTxO.Types.html#2758" class="Bound">y</a> <a id="2760" class="Keyword">with</a> <a id="2765" href="UTxO.Types.html#1931" class="Field">id</a> <a id="2768" href="UTxO.Types.html#2753" class="Bound">x</a> <a id="2770" href="Data.Nat.Properties.html#2208" class="Function Operator">â‰Ÿ</a> <a id="2772" href="UTxO.Types.html#1931" class="Field">id</a> <a id="2775" href="UTxO.Types.html#2758" class="Bound">y</a> <a id="2777" class="Symbol">|</a> <a id="2779" href="UTxO.Types.html#1950" class="Field">index</a> <a id="2785" href="UTxO.Types.html#2753" class="Bound">x</a> <a id="2787" href="Data.Nat.Properties.html#2208" class="Function Operator">â‰Ÿ</a> <a id="2789" href="UTxO.Types.html#1950" class="Field">index</a> <a id="2795" href="UTxO.Types.html#2758" class="Bound">y</a>
<a id="2797" class="Symbol">...</a> <a id="2801" class="Symbol">|</a> <a id="2803" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="2806" href="UTxO.Types.html#2806" class="Bound">Â¬p</a>    <a id="2812" class="Symbol">|</a> <a id="2814" class="Symbol">_</a>        <a id="2823" class="Symbol">=</a> <a id="2825" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="2828" class="Symbol">Î»{</a><a id="2830" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="2835" class="Symbol">â†’</a> <a id="2837" href="UTxO.Types.html#2806" class="Bound">Â¬p</a> <a id="2840" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="2844" class="Symbol">}</a>
<a id="2846" class="CatchallClause Symbol">...</a><a id="2849" class="CatchallClause"> </a><a id="2850" class="CatchallClause Symbol">|</a><a id="2851" class="CatchallClause"> </a><a id="2852" class="CatchallClause Symbol">_</a><a id="2853" class="CatchallClause">        </a><a id="2861" class="CatchallClause Symbol">|</a><a id="2862" class="CatchallClause"> </a><a id="2863" href="Relation.Nullary.html#633" class="CatchallClause InductiveConstructor">no</a><a id="2865" class="CatchallClause"> </a><a id="2866" href="UTxO.Types.html#2866" class="CatchallClause Bound">Â¬pâ€²</a>   <a id="2872" class="Symbol">=</a> <a id="2874" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="2877" class="Symbol">Î»{</a><a id="2879" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="2884" class="Symbol">â†’</a> <a id="2886" href="UTxO.Types.html#2866" class="Bound">Â¬pâ€²</a> <a id="2890" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a><a id="2894" class="Symbol">}</a>
<a id="2896" class="Symbol">...</a> <a id="2900" class="Symbol">|</a> <a id="2902" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="2906" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="2911" class="Symbol">|</a> <a id="2913" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="2917" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a> <a id="2922" class="Symbol">=</a> <a id="2924" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="2928" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>

<a id="2934" class="Keyword">module</a> <a id="SETâ‚’"></a><a id="2941" href="UTxO.Types.html#2941" class="Module">SETâ‚’</a> <a id="2946" class="Symbol">=</a> <a id="2948" href="Data.Set%2527.html" class="Module">SET</a> <a id="2952" class="Symbol">{</a><a id="2953" class="Argument">A</a> <a id="2955" class="Symbol">=</a> <a id="2957" href="UTxO.Types.html#1868" class="Record">TxOutputRef</a><a id="2968" class="Symbol">}</a> <a id="2970" href="UTxO.Types.html#2714" class="Function Operator">_â‰Ÿâ‚’_</a>

<a id="SetâŸ¨TxOutputRefâŸ©"></a><a id="2976" href="UTxO.Types.html#2976" class="Function">SetâŸ¨TxOutputRefâŸ©</a> <a id="2993" class="Symbol">:</a> <a id="2995" class="PrimitiveType">Set</a>
<a id="2999" href="UTxO.Types.html#2976" class="Function">SetâŸ¨TxOutputRefâŸ©</a> <a id="3016" class="Symbol">=</a> <a id="3018" href="Data.Set%2527.html#3084" class="Record">Set&#39;</a>
  <a id="3025" class="Keyword">where</a> <a id="3031" class="Keyword">open</a> <a id="3036" href="UTxO.Types.html#2941" class="Module">SETâ‚’</a>

<a id="3042" class="Comment">{- T0D0
-- Sets of transaction inputs
_â‰Ÿáµ¢_ : Decidable {A = TxInput} _â‰¡_
x â‰Ÿáµ¢ y with outputRef x â‰Ÿâ‚’ outputRef y
          | redeemer  x â‰Ÿâ‚› redeemer  y
          | validator x â‰Ÿâ‚› validator y
... | no Â¬p    | _        | _        = no Î»{refl â†’ Â¬p refl}
... | _        | no Â¬p    | _        = no Î»{refl â†’ Â¬p refl}
... | _        | _        | no Â¬p    = no Î»{refl â†’ Â¬p refl}
... | yes refl | yes refl | yes refl = yes refl

module SETáµ¢ = SET {A = TxInput} _â‰Ÿáµ¢_

SetâŸ¨TxInputâŸ© : Set
SetâŸ¨TxInputâŸ© = Set&#39;
  where open SETáµ¢
-}</a>
</pre></body></html>