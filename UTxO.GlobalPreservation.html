<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>UTxO.GlobalPreservation</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="UTxO.GlobalPreservation.html" class="Module">UTxO.GlobalPreservation</a> <a id="32" class="Keyword">where</a>

<a id="39" class="Keyword">open</a> <a id="44" class="Keyword">import</a> <a id="51" href="Data.List.Properties.html" class="Module">Data.List.Properties</a>                                           <a id="114" class="Keyword">using</a> <a id="120" class="Symbol">(</a><a id="121" href="Data.List.Properties.html#3709" class="Function">map-compose</a><a id="132" class="Symbol">)</a>
<a id="134" class="Keyword">open</a> <a id="139" class="Keyword">import</a> <a id="146" href="Data.List.Membership.Propositional.Properties.html" class="Module">Data.List.Membership.Propositional.Properties</a>                  <a id="209" class="Keyword">using</a> <a id="215" class="Symbol">(</a><a id="216" href="Data.List.Membership.Propositional.Properties.html#3429" class="Function">∈-map⁻</a><a id="222" class="Symbol">)</a>
<a id="224" class="Keyword">open</a> <a id="229" class="Keyword">import</a> <a id="236" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html" class="Module">Data.List.Relation.Binary.Permutation.Propositional.Properties</a> <a id="299" class="Keyword">using</a> <a id="305" class="Symbol">(</a><a id="306" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html#2953" class="Function">map⁺</a><a id="310" class="Symbol">)</a>

<a id="313" class="Keyword">open</a> <a id="318" class="Keyword">import</a> <a id="325" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="338" class="Keyword">open</a> <a id="343" class="Keyword">import</a> <a id="350" href="Prelude.Lists.html" class="Module">Prelude.Lists</a> <a id="364" class="Keyword">using</a> <a id="370" class="Symbol">(</a><a id="371" href="Prelude.Lists.html#12376" class="Function">mapWith∈↭filter</a><a id="386" class="Symbol">;</a> <a id="388" href="Prelude.Lists.html#13302" class="Function">↭⇒≡</a><a id="391" class="Symbol">)</a>
<a id="393" class="Keyword">open</a> <a id="398" class="Keyword">import</a> <a id="405" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="419" class="Keyword">open</a> <a id="424" class="Keyword">import</a> <a id="431" href="Prelude.Set%2527.html" class="Module">Prelude.Set&#39;</a>
<a id="444" class="Keyword">open</a> <a id="449" class="Keyword">import</a> <a id="456" href="Prelude.Monad.html" class="Module">Prelude.Monad</a>

<a id="471" class="Keyword">open</a> <a id="476" class="Keyword">import</a> <a id="483" href="UTxO.Hashing.html" class="Module">UTxO.Hashing</a>
<a id="496" class="Keyword">open</a> <a id="501" class="Keyword">import</a> <a id="508" href="UTxO.Value.html" class="Module">UTxO.Value</a>
<a id="519" class="Keyword">open</a> <a id="524" class="Keyword">import</a> <a id="531" href="UTxO.Types.html" class="Module">UTxO.Types</a>
<a id="542" class="Keyword">open</a> <a id="547" class="Keyword">import</a> <a id="554" href="UTxO.TxUtilities.html" class="Module">UTxO.TxUtilities</a>
<a id="571" class="Keyword">open</a> <a id="576" class="Keyword">import</a> <a id="583" href="UTxO.Validity.html" class="Module">UTxO.Validity</a>
<a id="597" class="Keyword">open</a> <a id="602" class="Keyword">import</a> <a id="609" href="UTxO.Uniqueness.html" class="Module">UTxO.Uniqueness</a>

<a id="globalPreservation"></a><a id="626" href="UTxO.GlobalPreservation.html#626" class="Function">globalPreservation</a> <a id="645" class="Symbol">:</a> <a id="647" class="Symbol">∀</a> <a id="649" class="Symbol">{</a><a id="650" href="UTxO.GlobalPreservation.html#650" class="Bound">l</a><a id="651" class="Symbol">}</a> <a id="653" class="Symbol">{</a><a id="654" href="UTxO.GlobalPreservation.html#654" class="Bound">vl</a> <a id="657" class="Symbol">:</a> <a id="659" href="UTxO.Validity.html#2109" class="Datatype">ValidLedger</a> <a id="671" href="UTxO.GlobalPreservation.html#650" class="Bound">l</a><a id="672" class="Symbol">}</a> <a id="674" class="Symbol">→</a>
  <a id="678" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="680" href="UTxO.GlobalPreservation.html#650" class="Bound">l</a> <a id="682" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="688" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="690" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="692" class="Symbol">(</a><a id="693" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="698" href="UTxO.GlobalPreservation.html#650" class="Bound">l</a><a id="699" class="Symbol">)</a> <a id="701" class="Symbol">(</a><a id="702" href="UTxO.Types.html#4728" class="Field">value</a> <a id="708" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="710" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="713" class="Symbol">)</a>
<a id="715" href="UTxO.GlobalPreservation.html#626" class="Function">globalPreservation</a> <a id="734" class="Symbol">{</a><a id="735" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="737" class="Symbol">}</a>          <a id="748" class="Symbol">{</a><a id="749" href="UTxO.GlobalPreservation.html#749" class="Bound">vl</a><a id="751" class="Symbol">}</a>                    <a id="772" class="Symbol">=</a> <a id="774" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="779" href="UTxO.GlobalPreservation.html#626" class="Function">globalPreservation</a> <a id="798" class="Symbol">{</a><a id="799" href="UTxO.GlobalPreservation.html#799" class="Bound">l₀</a><a id="801" class="Symbol">@(</a><a id="803" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a> <a id="806" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="808" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a><a id="809" class="Symbol">)}</a> <a id="812" class="Symbol">{</a><a id="813" href="UTxO.GlobalPreservation.html#813" class="Bound">vl₀</a><a id="816" class="Symbol">@(</a><a id="818" href="UTxO.GlobalPreservation.html#818" class="Bound">vl</a> <a id="821" href="UTxO.Validity.html#2167" class="InductiveConstructor Operator">⊕</a> <a id="823" class="DottedPattern Symbol">.</a><a id="824" href="UTxO.GlobalPreservation.html#803" class="DottedPattern Bound">tx</a> <a id="827" href="UTxO.Validity.html#2167" class="InductiveConstructor Operator">∶-</a> <a id="830" href="UTxO.GlobalPreservation.html#830" class="Bound">vtx</a><a id="833" class="Symbol">)}</a> <a id="836" class="Symbol">=</a> <a id="838" href="UTxO.GlobalPreservation.html#5905" class="Function">h″</a>
  <a id="843" class="Keyword">where</a>
    <a id="853" class="Keyword">open</a> <a id="858" href="Relation.Binary.PropositionalEquality.Core.html#2419" class="Module">≡-Reasoning</a>

    <a id="875" href="UTxO.GlobalPreservation.html#875" class="Function">view-pv</a> <a id="883" class="Symbol">:</a> <a id="885" class="Symbol">∀</a> <a id="887" class="Symbol">{</a><a id="888" href="UTxO.GlobalPreservation.html#888" class="Bound">A</a> <a id="890" class="Symbol">:</a> <a id="892" class="PrimitiveType">Set</a><a id="895" class="Symbol">}</a> <a id="897" class="Symbol">{</a><a id="898" href="UTxO.GlobalPreservation.html#898" class="Bound">mx</a> <a id="901" class="Symbol">:</a> <a id="903" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="909" href="UTxO.GlobalPreservation.html#888" class="Bound">A</a><a id="910" class="Symbol">}</a> <a id="912" class="Symbol">{</a><a id="913" href="UTxO.GlobalPreservation.html#913" class="Bound">P</a> <a id="915" class="Symbol">:</a> <a id="917" href="UTxO.GlobalPreservation.html#888" class="Bound">A</a> <a id="919" class="Symbol">→</a> <a id="921" class="PrimitiveType">Set</a><a id="924" class="Symbol">}</a>
      <a id="932" class="Symbol">→</a> <a id="934" href="Data.Maybe.Relation.Unary.Any.html#830" class="Datatype">M.Any.Any</a> <a id="944" href="UTxO.GlobalPreservation.html#913" class="Bound">P</a> <a id="946" href="UTxO.GlobalPreservation.html#898" class="Bound">mx</a>
      <a id="955" class="Symbol">→</a> <a id="957" href="Data.Product.html#1788" class="Function">∃[</a> <a id="960" href="UTxO.GlobalPreservation.html#960" class="Bound">x</a> <a id="962" href="Data.Product.html#1788" class="Function">]</a> <a id="964" class="Symbol">((</a><a id="966" href="UTxO.GlobalPreservation.html#898" class="Bound">mx</a> <a id="969" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="971" href="Category.Applicative.Indexed.html#985" class="Function">pure</a> <a id="976" href="UTxO.GlobalPreservation.html#960" class="Bound">x</a><a id="977" class="Symbol">)</a> <a id="979" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="981" href="UTxO.GlobalPreservation.html#913" class="Bound">P</a> <a id="983" href="UTxO.GlobalPreservation.html#960" class="Bound">x</a><a id="984" class="Symbol">)</a>
    <a id="990" href="UTxO.GlobalPreservation.html#875" class="Function">view-pv</a> <a id="998" class="Symbol">(</a><a id="999" href="Data.Maybe.Relation.Unary.Any.html#900" class="InductiveConstructor">M.Any.just</a> <a id="1010" href="UTxO.GlobalPreservation.html#1010" class="Bound">p</a><a id="1011" class="Symbol">)</a> <a id="1013" class="Symbol">=</a> <a id="1015" class="Symbol">_</a> <a id="1017" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1019" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1024" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1026" href="UTxO.GlobalPreservation.html#1010" class="Bound">p</a>

    <a id="1033" href="UTxO.GlobalPreservation.html#1033" class="Function">∑in</a> <a id="1037" class="Symbol">:</a> <a id="1039" class="Symbol">∀</a> <a id="1041" class="Symbol">{</a><a id="1042" href="UTxO.GlobalPreservation.html#1042" class="Bound">l</a> <a id="1044" href="UTxO.GlobalPreservation.html#1044" class="Bound">tx</a><a id="1046" class="Symbol">}</a> <a id="1048" class="Symbol">→</a> <a id="1050" href="UTxO.Validity.html#2109" class="Datatype">ValidLedger</a> <a id="1062" class="Symbol">(</a><a id="1063" href="UTxO.GlobalPreservation.html#1044" class="Bound">tx</a> <a id="1066" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1068" href="UTxO.GlobalPreservation.html#1042" class="Bound">l</a><a id="1069" class="Symbol">)</a> <a id="1071" class="Symbol">→</a> <a id="1073" href="UTxO.Value.html#825" class="Function">Value</a>
    <a id="1083" href="UTxO.GlobalPreservation.html#1033" class="Function">∑in</a> <a id="1087" class="Symbol">(_</a> <a id="1090" href="UTxO.Validity.html#2167" class="InductiveConstructor Operator">⊕</a> <a id="1092" class="Symbol">_</a> <a id="1094" href="UTxO.Validity.html#2167" class="InductiveConstructor Operator">∶-</a> <a id="1097" href="UTxO.GlobalPreservation.html#1097" class="Bound">vtx</a><a id="1100" class="Symbol">)</a> <a id="1102" class="Symbol">=</a> <a id="1104" class="Symbol">(</a><a id="1105" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="1111" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1113" href="UTxO.GlobalPreservation.html#875" class="Function">view-pv</a> <a id="1121" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1123" href="UTxO.Validity.html#1385" class="Field">preservesValues</a><a id="1138" class="Symbol">)</a> <a id="1140" href="UTxO.GlobalPreservation.html#1097" class="Bound">vtx</a>

    <a id="1149" href="UTxO.GlobalPreservation.html#1149" class="Function">∑-outRef</a> <a id="1158" class="Symbol">:</a> <a id="1160" class="Symbol">∀</a> <a id="1162" class="Symbol">{</a><a id="1163" href="UTxO.GlobalPreservation.html#1163" class="Bound">l</a><a id="1164" class="Symbol">}</a> <a id="1166" class="Symbol">{</a><a id="1167" href="UTxO.GlobalPreservation.html#1167" class="Bound">tx</a><a id="1169" class="Symbol">}</a> <a id="1171" class="Symbol">{</a><a id="1172" href="UTxO.GlobalPreservation.html#1172" class="Bound">vl</a> <a id="1175" class="Symbol">:</a> <a id="1177" href="UTxO.Validity.html#2109" class="Datatype">ValidLedger</a> <a id="1189" class="Symbol">(</a><a id="1190" href="UTxO.GlobalPreservation.html#1167" class="Bound">tx</a> <a id="1193" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1195" href="UTxO.GlobalPreservation.html#1163" class="Bound">l</a><a id="1196" class="Symbol">)}</a>
      <a id="1205" class="Symbol">→</a> <a id="1207" href="UTxO.GlobalPreservation.html#1033" class="Function">∑in</a> <a id="1211" href="UTxO.GlobalPreservation.html#1172" class="Bound">vl</a>
      <a id="1220" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1222" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="1224" class="Symbol">(</a><a id="1225" href="Data.List.Base.html#7436" class="Function">filter</a> <a id="1232" class="Symbol">((</a><a id="1234" href="Data.List.Membership.DecSetoid.html#762" class="Function Operator">_∈?</a> <a id="1238" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="1249" href="UTxO.GlobalPreservation.html#1167" class="Bound">tx</a><a id="1251" class="Symbol">)</a> <a id="1253" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1255" href="UTxO.TxUtilities.html#471" class="Field">outRef</a><a id="1261" class="Symbol">)</a> <a id="1263" class="Symbol">(</a><a id="1264" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="1269" href="UTxO.GlobalPreservation.html#1163" class="Bound">l</a><a id="1270" class="Symbol">))</a> <a id="1273" class="Symbol">(</a><a id="1274" href="UTxO.Types.html#4728" class="Field">value</a> <a id="1280" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1282" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="1285" class="Symbol">)</a>
    <a id="1291" href="UTxO.GlobalPreservation.html#1149" class="Function">∑-outRef</a> <a id="1300" class="Symbol">{</a><a id="1301" href="UTxO.GlobalPreservation.html#1301" class="Bound">l</a><a id="1302" class="Symbol">}</a> <a id="1304" class="Symbol">{</a><a id="1305" href="UTxO.GlobalPreservation.html#1305" class="Bound">tx</a><a id="1307" class="Symbol">}</a> <a id="1309" class="Symbol">{</a><a id="1310" href="UTxO.GlobalPreservation.html#1310" class="Bound">vl₀</a><a id="1313" class="Symbol">@(</a><a id="1315" href="UTxO.GlobalPreservation.html#1315" class="Bound">vl</a> <a id="1318" href="UTxO.Validity.html#2167" class="InductiveConstructor Operator">⊕</a> <a id="1320" class="Symbol">_</a> <a id="1322" href="UTxO.Validity.html#2167" class="InductiveConstructor Operator">∶-</a> <a id="1325" href="UTxO.GlobalPreservation.html#1325" class="Bound">vtx</a><a id="1328" class="Symbol">@(</a><a id="1330" class="Keyword">record</a> <a id="1337" class="Symbol">{</a> <a id="1339" href="UTxO.Validity.html#1320" class="Field">validOutputRefs</a>  <a id="1356" class="Symbol">=</a> <a id="1358" href="UTxO.GlobalPreservation.html#1358" class="Bound">vor</a>
                                                  <a id="1412" class="Symbol">;</a> <a id="1414" href="UTxO.Validity.html#1385" class="Field">preservesValues</a>  <a id="1431" class="Symbol">=</a> <a id="1433" href="UTxO.GlobalPreservation.html#1433" class="Bound">pv</a>
                                                  <a id="1486" class="Symbol">;</a> <a id="1488" href="UTxO.Validity.html#1525" class="Field">noDoubleSpending</a> <a id="1505" class="Symbol">=</a> <a id="1507" href="UTxO.GlobalPreservation.html#1507" class="Bound">ndp</a> <a id="1511" class="Symbol">}))}</a>
      <a id="1522" class="Symbol">=</a> <a id="1524" href="Data.Maybe.Properties.html#937" class="Function">M.just-injective</a> <a id="1541" class="Symbol">(</a><a id="1542" href="Relation.Binary.PropositionalEquality.Core.html#2517" class="Function Operator">begin</a>
          <a id="1558" href="Category.Applicative.Indexed.html#985" class="Function">pure</a> <a id="1563" class="Symbol">(</a><a id="1564" href="UTxO.GlobalPreservation.html#1033" class="Function">∑in</a> <a id="1568" href="UTxO.GlobalPreservation.html#1310" class="Bound">vl₀</a><a id="1571" class="Symbol">)</a>
        <a id="1581" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">≡⟨</a> <a id="1584" href="Relation.Binary.PropositionalEquality.Core.html#980" class="Function">sym</a> <a id="1588" class="Symbol">(</a><a id="1589" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="1595" class="Symbol">(</a><a id="1596" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="1602" class="Symbol">(</a><a id="1603" href="UTxO.GlobalPreservation.html#875" class="Function">view-pv</a> <a id="1611" href="UTxO.GlobalPreservation.html#1433" class="Bound">pv</a><a id="1613" class="Symbol">)))</a> <a id="1617" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">⟩</a>
          <a id="1629" href="UTxO.Value.html#2589" class="Function">∑M</a> <a id="1632" class="Symbol">(</a><a id="1633" href="Data.List.Base.html#1497" class="Function">map</a> <a id="1637" class="Symbol">(</a><a id="1638" href="UTxO.TxUtilities.html#5016" class="Function">getSpentOutput</a> <a id="1653" href="UTxO.GlobalPreservation.html#1301" class="Bound">l</a><a id="1654" class="Symbol">)</a> <a id="1656" class="Symbol">(</a><a id="1657" href="UTxO.Types.html#7415" class="Field">inputs</a> <a id="1664" href="UTxO.GlobalPreservation.html#1305" class="Bound">tx</a><a id="1666" class="Symbol">))</a> <a id="1669" href="UTxO.Types.html#4728" class="Field">value</a>
        <a id="1683" href="Relation.Binary.PropositionalEquality.Core.html#2575" class="Function Operator">≡⟨⟩</a>
          <a id="1697" href="UTxO.Value.html#2589" class="Function">∑M</a> <a id="1700" class="Symbol">(</a><a id="1701" href="Data.List.Base.html#1497" class="Function">map</a> <a id="1705" class="Symbol">(</a><a id="1706" href="UTxO.TxUtilities.html#4883" class="Function">getSpentOutputRef</a> <a id="1724" href="UTxO.GlobalPreservation.html#1301" class="Bound">l</a> <a id="1726" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1728" href="UTxO.Types.html#7268" class="Field">outputRef</a><a id="1737" class="Symbol">)</a> <a id="1739" class="Symbol">(</a><a id="1740" href="UTxO.Types.html#7415" class="Field">inputs</a> <a id="1747" href="UTxO.GlobalPreservation.html#1305" class="Bound">tx</a><a id="1749" class="Symbol">))</a> <a id="1752" href="UTxO.Types.html#4728" class="Field">value</a>
        <a id="1766" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">≡⟨</a> <a id="1769" href="Relation.Binary.PropositionalEquality.Core.html#1131" class="Function">cong</a> <a id="1774" class="Symbol">(λ</a> <a id="1777" href="UTxO.GlobalPreservation.html#1777" class="Bound">x</a> <a id="1779" class="Symbol">→</a> <a id="1781" href="UTxO.Value.html#2589" class="Function">∑M</a> <a id="1784" href="UTxO.GlobalPreservation.html#1777" class="Bound">x</a> <a id="1786" href="UTxO.Types.html#4728" class="Field">value</a><a id="1791" class="Symbol">)</a> <a id="1793" class="Symbol">(</a><a id="1794" href="Data.List.Properties.html#3709" class="Function">map-compose</a> <a id="1806" class="Symbol">{</a><a id="1807" class="Argument">g</a> <a id="1809" class="Symbol">=</a> <a id="1811" href="UTxO.TxUtilities.html#4883" class="Function">getSpentOutputRef</a> <a id="1829" href="UTxO.GlobalPreservation.html#1301" class="Bound">l</a><a id="1830" class="Symbol">}</a> <a id="1832" class="Symbol">{</a><a id="1833" class="Argument">f</a> <a id="1835" class="Symbol">=</a> <a id="1837" href="UTxO.Types.html#7268" class="Field">outputRef</a><a id="1846" class="Symbol">}</a> <a id="1848" class="Symbol">(</a><a id="1849" href="UTxO.Types.html#7415" class="Field">inputs</a> <a id="1856" href="UTxO.GlobalPreservation.html#1305" class="Bound">tx</a><a id="1858" class="Symbol">))</a> <a id="1861" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">⟩</a>
          <a id="1873" href="UTxO.Value.html#2589" class="Function">∑M</a> <a id="1876" class="Symbol">(</a><a id="1877" href="Data.List.Base.html#1497" class="Function">map</a> <a id="1881" class="Symbol">(</a><a id="1882" href="UTxO.TxUtilities.html#4883" class="Function">getSpentOutputRef</a> <a id="1900" href="UTxO.GlobalPreservation.html#1301" class="Bound">l</a><a id="1901" class="Symbol">)</a> <a id="1903" class="Symbol">(</a><a id="1904" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="1915" href="UTxO.GlobalPreservation.html#1305" class="Bound">tx</a><a id="1917" class="Symbol">))</a> <a id="1920" href="UTxO.Types.html#4728" class="Field">value</a>
        <a id="1934" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">≡⟨</a> <a id="1937" href="UTxO.Value.html#5042" class="Postulate">∑M-just</a> <a id="1945" href="UTxO.GlobalPreservation.html#2607" class="Function">getSpent≡</a> <a id="1955" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">⟩</a>
          <a id="1967" href="Category.Applicative.Indexed.html#985" class="Function">pure</a> <a id="1972" class="Symbol">(</a><a id="1973" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="1975" class="Symbol">(</a><a id="1976" href="Data.List.Membership.Setoid.html#1123" class="Function">mapWith∈</a> <a id="1985" class="Symbol">(</a><a id="1986" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="1997" href="UTxO.GlobalPreservation.html#1305" class="Bound">tx</a><a id="1999" class="Symbol">)</a> <a id="2001" class="Symbol">(</a><a id="2002" href="UTxO.TxUtilities.html#498" class="Field">out</a> <a id="2006" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2008" href="UTxO.GlobalPreservation.html#2505" class="Function">getUTXO</a><a id="2015" class="Symbol">))</a> <a id="2018" href="UTxO.Types.html#4728" class="Field">value</a><a id="2023" class="Symbol">)</a>
        <a id="2033" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">≡⟨</a> <a id="2036" href="Relation.Binary.PropositionalEquality.Core.html#1131" class="Function">cong</a> <a id="2041" href="Category.Applicative.Indexed.html#985" class="Function">pure</a> <a id="2046" class="Symbol">(</a><a id="2047" href="Relation.Binary.PropositionalEquality.Core.html#2517" class="Function Operator">begin</a>
              <a id="2067" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="2069" class="Symbol">(</a><a id="2070" href="Data.List.Membership.Setoid.html#1123" class="Function">mapWith∈</a> <a id="2079" class="Symbol">(</a><a id="2080" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="2091" href="UTxO.GlobalPreservation.html#1305" class="Bound">tx</a><a id="2093" class="Symbol">)</a> <a id="2095" class="Symbol">(</a><a id="2096" href="UTxO.TxUtilities.html#498" class="Field">out</a> <a id="2100" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2102" href="UTxO.GlobalPreservation.html#2505" class="Function">getUTXO</a><a id="2109" class="Symbol">))</a> <a id="2112" href="UTxO.Types.html#4728" class="Field">value</a>
            <a id="2130" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">≡⟨</a> <a id="2133" href="UTxO.Value.html#4481" class="Postulate">∑-∘</a> <a id="2137" class="Symbol">{</a><a id="2138" class="Argument">xs</a> <a id="2141" class="Symbol">=</a> <a id="2143" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="2154" href="UTxO.GlobalPreservation.html#1305" class="Bound">tx</a><a id="2156" class="Symbol">}</a> <a id="2158" class="Symbol">{</a><a id="2159" class="Argument">g</a> <a id="2161" class="Symbol">=</a> <a id="2163" href="UTxO.GlobalPreservation.html#2505" class="Function">getUTXO</a><a id="2170" class="Symbol">}</a> <a id="2172" class="Symbol">{</a><a id="2173" class="Argument">g′</a> <a id="2176" class="Symbol">=</a> <a id="2178" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="2181" class="Symbol">}</a> <a id="2183" class="Symbol">{</a><a id="2184" class="Argument">f</a> <a id="2186" class="Symbol">=</a> <a id="2188" href="UTxO.Types.html#4728" class="Field">value</a><a id="2193" class="Symbol">}</a> <a id="2195" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">⟩</a>
              <a id="2211" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="2213" class="Symbol">(</a><a id="2214" href="Data.List.Membership.Setoid.html#1123" class="Function">mapWith∈</a> <a id="2223" class="Symbol">(</a><a id="2224" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="2235" href="UTxO.GlobalPreservation.html#1305" class="Bound">tx</a><a id="2237" class="Symbol">)</a> <a id="2239" href="UTxO.GlobalPreservation.html#2505" class="Function">getUTXO</a><a id="2246" class="Symbol">)</a> <a id="2248" class="Symbol">(</a><a id="2249" href="UTxO.Types.html#4728" class="Field">value</a> <a id="2255" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2257" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="2260" class="Symbol">)</a>
            <a id="2274" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">≡⟨</a> <a id="2277" href="UTxO.GlobalPreservation.html#3050" class="Function">∑map≡∑filter</a> <a id="2290" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">⟩</a>
              <a id="2306" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="2308" class="Symbol">(</a><a id="2309" href="Data.List.Base.html#7436" class="Function">filter</a> <a id="2316" class="Symbol">((</a><a id="2318" href="Data.List.Membership.DecSetoid.html#762" class="Function Operator">_∈?</a> <a id="2322" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="2333" href="UTxO.GlobalPreservation.html#1305" class="Bound">tx</a><a id="2335" class="Symbol">)</a> <a id="2337" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2339" href="UTxO.TxUtilities.html#471" class="Field">outRef</a><a id="2345" class="Symbol">)</a> <a id="2347" class="Symbol">(</a><a id="2348" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="2353" href="UTxO.GlobalPreservation.html#1301" class="Bound">l</a><a id="2354" class="Symbol">))</a> <a id="2357" class="Symbol">(</a><a id="2358" href="UTxO.Types.html#4728" class="Field">value</a> <a id="2364" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2366" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="2369" class="Symbol">)</a>
            <a id="2383" href="Relation.Binary.PropositionalEquality.Core.html#2816" class="Function Operator">∎</a><a id="2384" class="Symbol">)</a> <a id="2386" href="Relation.Binary.PropositionalEquality.Core.html#2634" class="Function">⟩</a>
          <a id="2398" href="Category.Applicative.Indexed.html#985" class="Function">pure</a> <a id="2403" class="Symbol">(</a><a id="2404" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="2406" class="Symbol">(</a><a id="2407" href="Data.List.Base.html#7436" class="Function">filter</a> <a id="2414" class="Symbol">((</a><a id="2416" href="Data.List.Membership.DecSetoid.html#762" class="Function Operator">_∈?</a> <a id="2420" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="2431" href="UTxO.GlobalPreservation.html#1305" class="Bound">tx</a><a id="2433" class="Symbol">)</a> <a id="2435" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2437" href="UTxO.TxUtilities.html#471" class="Field">outRef</a><a id="2443" class="Symbol">)</a> <a id="2445" class="Symbol">(</a><a id="2446" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="2451" href="UTxO.GlobalPreservation.html#1301" class="Bound">l</a><a id="2452" class="Symbol">))</a> <a id="2455" class="Symbol">(</a><a id="2456" href="UTxO.Types.html#4728" class="Field">value</a> <a id="2462" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2464" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="2467" class="Symbol">))</a>
        <a id="2478" href="Relation.Binary.PropositionalEquality.Core.html#2816" class="Function Operator">∎</a><a id="2479" class="Symbol">)</a>
        <a id="2489" class="Keyword">where</a>
          <a id="2505" href="UTxO.GlobalPreservation.html#2505" class="Function">getUTXO</a> <a id="2513" class="Symbol">:</a> <a id="2515" class="Symbol">∀</a> <a id="2517" class="Symbol">{</a><a id="2518" href="UTxO.GlobalPreservation.html#2518" class="Bound">o</a><a id="2519" class="Symbol">}</a> <a id="2521" class="Symbol">→</a> <a id="2523" href="UTxO.GlobalPreservation.html#2518" class="Bound">o</a> <a id="2525" href="Data.List.Membership.Setoid.html#882" class="Function Operator">∈</a> <a id="2527" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="2538" href="UTxO.GlobalPreservation.html#1305" class="Bound">tx</a> <a id="2541" class="Symbol">→</a> <a id="2543" href="UTxO.TxUtilities.html#442" class="Record">UTXO</a>
          <a id="2558" href="UTxO.GlobalPreservation.html#2505" class="Function">getUTXO</a> <a id="2566" class="Symbol">=</a> <a id="2568" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="2574" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2576" href="Data.List.Membership.Propositional.Properties.html#3429" class="Function">∈-map⁻</a> <a id="2583" href="UTxO.TxUtilities.html#471" class="Field">outRef</a> <a id="2590" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2592" href="UTxO.GlobalPreservation.html#1358" class="Bound">vor</a>

          <a id="2607" href="UTxO.GlobalPreservation.html#2607" class="Function">getSpent≡</a> <a id="2617" class="Symbol">:</a> <a id="2619" class="Symbol">∀</a> <a id="2621" class="Symbol">{</a><a id="2622" href="UTxO.GlobalPreservation.html#2622" class="Bound">o</a><a id="2623" class="Symbol">}</a> <a id="2625" class="Symbol">→</a> <a id="2627" class="Symbol">(</a><a id="2628" href="UTxO.GlobalPreservation.html#2628" class="Bound">o∈</a> <a id="2631" class="Symbol">:</a> <a id="2633" href="UTxO.GlobalPreservation.html#2622" class="Bound">o</a> <a id="2635" href="Data.List.Membership.Setoid.html#882" class="Function Operator">∈</a> <a id="2637" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="2648" href="UTxO.GlobalPreservation.html#1305" class="Bound">tx</a><a id="2650" class="Symbol">)</a> <a id="2652" class="Symbol">→</a> <a id="2654" href="UTxO.TxUtilities.html#4883" class="Function">getSpentOutputRef</a> <a id="2672" href="UTxO.GlobalPreservation.html#1301" class="Bound">l</a> <a id="2674" href="UTxO.GlobalPreservation.html#2622" class="Bound">o</a> <a id="2676" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2678" href="Category.Applicative.Indexed.html#985" class="Function">pure</a> <a id="2683" class="Symbol">((</a><a id="2685" href="UTxO.TxUtilities.html#498" class="Field">out</a> <a id="2689" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2691" href="UTxO.GlobalPreservation.html#2505" class="Function">getUTXO</a><a id="2698" class="Symbol">)</a> <a id="2700" href="UTxO.GlobalPreservation.html#2628" class="Bound">o∈</a><a id="2702" class="Symbol">)</a>
          <a id="2714" href="UTxO.GlobalPreservation.html#2607" class="Function">getSpent≡</a> <a id="2724" href="UTxO.GlobalPreservation.html#2724" class="Bound">o∈</a>
            <a id="2739" class="Keyword">with</a> <a id="2744" href="Data.List.Membership.Propositional.Properties.html#3429" class="Function">∈-map⁻</a> <a id="2751" href="UTxO.TxUtilities.html#471" class="Field">outRef</a> <a id="2758" class="Symbol">(</a><a id="2759" href="UTxO.GlobalPreservation.html#1358" class="Bound">vor</a> <a id="2763" href="UTxO.GlobalPreservation.html#2724" class="Bound">o∈</a><a id="2765" class="Symbol">)</a>
          <a id="2777" class="Symbol">...</a> <a id="2781" class="Symbol">|</a> <a id="2783" href="UTxO.GlobalPreservation.html#2783" class="Bound">u</a> <a id="2785" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2787" href="UTxO.GlobalPreservation.html#2787" class="Bound">u∈</a> <a id="2790" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2792" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
              <a id="2811" class="Symbol">=</a> <a id="2813" href="UTxO.TxUtilities.html#5123" class="Function">utxo-getSpent</a> <a id="2827" class="Symbol">{</a><a id="2828" href="UTxO.GlobalPreservation.html#1301" class="Bound">l</a><a id="2829" class="Symbol">}</a> <a id="2831" class="Symbol">{</a><a id="2832" href="UTxO.GlobalPreservation.html#2783" class="Bound">u</a><a id="2833" class="Symbol">}</a> <a id="2835" href="UTxO.GlobalPreservation.html#2787" class="Bound">u∈</a>

          <a id="2849" href="UTxO.GlobalPreservation.html#2849" class="Function">map↭filter</a> <a id="2860" class="Symbol">:</a> <a id="2862" href="Data.List.Membership.Setoid.html#1123" class="Function">mapWith∈</a> <a id="2871" class="Symbol">(</a><a id="2872" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="2883" href="UTxO.GlobalPreservation.html#1305" class="Bound">tx</a><a id="2885" class="Symbol">)</a> <a id="2887" href="UTxO.GlobalPreservation.html#2505" class="Function">getUTXO</a>
                     <a id="2916" href="Data.List.Relation.Binary.Permutation.Propositional.html#1041" class="Datatype Operator">↭</a> <a id="2918" href="Data.List.Base.html#7436" class="Function">filter</a> <a id="2925" class="Symbol">((</a><a id="2927" href="Data.List.Membership.DecSetoid.html#762" class="Function Operator">_∈?</a> <a id="2931" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="2942" href="UTxO.GlobalPreservation.html#1305" class="Bound">tx</a><a id="2944" class="Symbol">)</a> <a id="2946" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2948" href="UTxO.TxUtilities.html#471" class="Field">outRef</a><a id="2954" class="Symbol">)</a> <a id="2956" class="Symbol">(</a><a id="2957" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="2962" href="UTxO.GlobalPreservation.html#1301" class="Bound">l</a><a id="2963" class="Symbol">)</a>
          <a id="2975" href="UTxO.GlobalPreservation.html#2849" class="Function">map↭filter</a> <a id="2986" class="Symbol">=</a> <a id="2988" href="Prelude.Lists.html#12376" class="Function">mapWith∈↭filter</a> <a id="3004" class="Symbol">{</a><a id="3005" class="Argument">_∈?_</a> <a id="3010" class="Symbol">=</a> <a id="3012" href="Data.List.Membership.DecSetoid.html#762" class="Function Operator">_∈?_</a><a id="3016" class="Symbol">}</a> <a id="3018" href="UTxO.GlobalPreservation.html#1358" class="Bound">vor</a> <a id="3022" class="Symbol">(</a><a id="3023" href="UTxO.Uniqueness.html#1383" class="Function">Unique-utxo</a> <a id="3035" href="UTxO.GlobalPreservation.html#1315" class="Bound">vl</a><a id="3037" class="Symbol">)</a>

          <a id="3050" href="UTxO.GlobalPreservation.html#3050" class="Function">∑map≡∑filter</a> <a id="3063" class="Symbol">:</a> <a id="3065" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="3067" class="Symbol">(</a><a id="3068" href="Data.List.Membership.Setoid.html#1123" class="Function">mapWith∈</a> <a id="3077" class="Symbol">(</a><a id="3078" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="3089" href="UTxO.GlobalPreservation.html#1305" class="Bound">tx</a><a id="3091" class="Symbol">)</a> <a id="3093" href="UTxO.GlobalPreservation.html#2505" class="Function">getUTXO</a><a id="3100" class="Symbol">)</a> <a id="3102" class="Symbol">(</a><a id="3103" href="UTxO.Types.html#4728" class="Field">value</a> <a id="3109" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3111" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="3114" class="Symbol">)</a>
                       <a id="3139" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3141" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="3143" class="Symbol">(</a><a id="3144" href="Data.List.Base.html#7436" class="Function">filter</a> <a id="3151" class="Symbol">((</a><a id="3153" href="Data.List.Membership.DecSetoid.html#762" class="Function Operator">_∈?</a> <a id="3157" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="3168" href="UTxO.GlobalPreservation.html#1305" class="Bound">tx</a><a id="3170" class="Symbol">)</a> <a id="3172" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3174" href="UTxO.TxUtilities.html#471" class="Field">outRef</a><a id="3180" class="Symbol">)</a> <a id="3182" class="Symbol">(</a><a id="3183" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="3188" href="UTxO.GlobalPreservation.html#1301" class="Bound">l</a><a id="3189" class="Symbol">))</a> <a id="3192" class="Symbol">(</a><a id="3193" href="UTxO.Types.html#4728" class="Field">value</a> <a id="3199" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3201" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="3204" class="Symbol">)</a>
          <a id="3216" href="UTxO.GlobalPreservation.html#3050" class="Function">∑map≡∑filter</a> <a id="3229" class="Symbol">=</a> <a id="3231" href="Prelude.Lists.html#13302" class="Function">↭⇒≡</a> <a id="3235" href="UTxO.Value.html#8154" class="Function">+ᶜ-identity</a> <a id="3247" href="UTxO.Value.html#3676" class="Postulate">+ᶜ-comm</a> <a id="3255" class="Symbol">(</a><a id="3256" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html#2953" class="Function">map⁺</a> <a id="3261" class="Symbol">(</a><a id="3262" href="UTxO.Types.html#4728" class="Field">value</a> <a id="3268" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3270" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="3273" class="Symbol">)</a> <a id="3275" href="UTxO.GlobalPreservation.html#2849" class="Function">map↭filter</a><a id="3285" class="Symbol">)</a>

    <a id="3292" href="UTxO.GlobalPreservation.html#3292" class="Function">pv</a> <a id="3295" class="Symbol">:</a> <a id="3297" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="3303" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a> <a id="3306" href="UTxO.Value.html#1833" class="Function Operator">+ᶜ</a> <a id="3309" href="UTxO.GlobalPreservation.html#1033" class="Function">∑in</a> <a id="3313" href="UTxO.GlobalPreservation.html#813" class="Bound">vl₀</a> <a id="3317" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3319" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="3321" class="Symbol">(</a><a id="3322" href="UTxO.Types.html#7520" class="Field">outputs</a> <a id="3330" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a><a id="3332" class="Symbol">)</a> <a id="3334" href="UTxO.Types.html#4728" class="Field">value</a>
    <a id="3344" href="UTxO.GlobalPreservation.html#3292" class="Function">pv</a> <a id="3347" class="Symbol">=</a> <a id="3349" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="3355" class="Symbol">(</a><a id="3356" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="3362" class="Symbol">(</a><a id="3363" href="UTxO.GlobalPreservation.html#875" class="Function">view-pv</a> <a id="3371" class="Symbol">(</a><a id="3372" href="UTxO.Validity.html#1385" class="Field">preservesValues</a> <a id="3388" href="UTxO.GlobalPreservation.html#830" class="Bound">vtx</a><a id="3391" class="Symbol">)))</a>

    <a id="3400" href="UTxO.GlobalPreservation.html#3400" class="Function">gpv</a> <a id="3404" class="Symbol">:</a> <a id="3406" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="3408" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a> <a id="3410" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="3416" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3418" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="3420" class="Symbol">(</a><a id="3421" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="3426" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a><a id="3427" class="Symbol">)</a> <a id="3429" class="Symbol">(</a><a id="3430" href="UTxO.Types.html#4728" class="Field">value</a> <a id="3436" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3438" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="3441" class="Symbol">)</a>
    <a id="3447" href="UTxO.GlobalPreservation.html#3400" class="Function">gpv</a> <a id="3451" class="Symbol">=</a> <a id="3453" href="UTxO.GlobalPreservation.html#626" class="Function">globalPreservation</a> <a id="3472" class="Symbol">{</a><a id="3473" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a><a id="3474" class="Symbol">}</a> <a id="3476" class="Symbol">{</a><a id="3477" href="UTxO.GlobalPreservation.html#818" class="Bound">vl</a><a id="3479" class="Symbol">}</a>

    <a id="3486" href="UTxO.GlobalPreservation.html#3486" class="Function">+ᶜ-helper</a> <a id="3496" class="Symbol">:</a> <a id="3498" class="Symbol">∀</a> <a id="3500" class="Symbol">{</a><a id="3501" href="UTxO.GlobalPreservation.html#3501" class="Bound">x</a> <a id="3503" href="UTxO.GlobalPreservation.html#3503" class="Bound">x′</a> <a id="3506" href="UTxO.GlobalPreservation.html#3506" class="Bound">y</a> <a id="3508" href="UTxO.GlobalPreservation.html#3508" class="Bound">y′</a> <a id="3511" class="Symbol">:</a> <a id="3513" href="UTxO.Value.html#825" class="Function">Value</a><a id="3518" class="Symbol">}</a> <a id="3520" class="Symbol">→</a> <a id="3522" href="UTxO.GlobalPreservation.html#3501" class="Bound">x</a> <a id="3524" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3526" href="UTxO.GlobalPreservation.html#3503" class="Bound">x′</a> <a id="3529" class="Symbol">→</a> <a id="3531" href="UTxO.GlobalPreservation.html#3506" class="Bound">y</a> <a id="3533" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3535" href="UTxO.GlobalPreservation.html#3508" class="Bound">y′</a> <a id="3538" class="Symbol">→</a> <a id="3540" href="UTxO.GlobalPreservation.html#3501" class="Bound">x</a> <a id="3542" href="UTxO.Value.html#1833" class="Function Operator">+ᶜ</a> <a id="3545" href="UTxO.GlobalPreservation.html#3506" class="Bound">y</a> <a id="3547" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3549" href="UTxO.GlobalPreservation.html#3503" class="Bound">x′</a> <a id="3552" href="UTxO.Value.html#1833" class="Function Operator">+ᶜ</a> <a id="3555" href="UTxO.GlobalPreservation.html#3508" class="Bound">y′</a>
    <a id="3562" href="UTxO.GlobalPreservation.html#3486" class="Function">+ᶜ-helper</a> <a id="3572" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="3577" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="3582" class="Symbol">=</a> <a id="3584" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

    <a id="3594" href="UTxO.GlobalPreservation.html#3594" class="Function">pv-gpv</a> <a id="3601" class="Symbol">:</a> <a id="3603" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="3609" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a> <a id="3612" href="UTxO.Value.html#1833" class="Function Operator">+ᶜ</a> <a id="3615" href="UTxO.GlobalPreservation.html#1033" class="Function">∑in</a> <a id="3619" href="UTxO.GlobalPreservation.html#813" class="Bound">vl₀</a> <a id="3623" href="UTxO.Value.html#1833" class="Function Operator">+ᶜ</a> <a id="3626" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="3628" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a> <a id="3630" href="UTxO.Types.html#7555" class="Field">forge</a>
           <a id="3647" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3649" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="3651" class="Symbol">(</a><a id="3652" href="UTxO.Types.html#7520" class="Field">outputs</a> <a id="3660" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a><a id="3662" class="Symbol">)</a> <a id="3664" href="UTxO.Types.html#4728" class="Field">value</a> <a id="3670" href="UTxO.Value.html#1833" class="Function Operator">+ᶜ</a> <a id="3673" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="3675" class="Symbol">(</a><a id="3676" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="3681" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a><a id="3682" class="Symbol">)</a> <a id="3684" class="Symbol">(</a><a id="3685" href="UTxO.Types.html#4728" class="Field">value</a> <a id="3691" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3693" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="3696" class="Symbol">)</a>
    <a id="3702" href="UTxO.GlobalPreservation.html#3594" class="Function">pv-gpv</a> <a id="3709" class="Symbol">=</a> <a id="3711" href="UTxO.GlobalPreservation.html#3486" class="Function">+ᶜ-helper</a> <a id="3721" class="Symbol">{</a><a id="3722" class="Argument">x</a> <a id="3724" class="Symbol">=</a> <a id="3726" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="3732" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a> <a id="3735" href="UTxO.Value.html#1833" class="Function Operator">+ᶜ</a> <a id="3738" href="UTxO.GlobalPreservation.html#1033" class="Function">∑in</a> <a id="3742" href="UTxO.GlobalPreservation.html#813" class="Bound">vl₀</a><a id="3745" class="Symbol">}</a> <a id="3747" class="Symbol">{</a><a id="3748" class="Argument">x′</a> <a id="3751" class="Symbol">=</a> <a id="3753" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="3755" class="Symbol">(</a><a id="3756" href="UTxO.Types.html#7520" class="Field">outputs</a> <a id="3764" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a><a id="3766" class="Symbol">)</a> <a id="3768" href="UTxO.Types.html#4728" class="Field">value</a><a id="3773" class="Symbol">}</a>
                       <a id="3798" class="Symbol">{</a><a id="3799" class="Argument">y</a> <a id="3801" class="Symbol">=</a> <a id="3803" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="3805" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a> <a id="3807" href="UTxO.Types.html#7555" class="Field">forge</a><a id="3812" class="Symbol">}</a> <a id="3814" class="Symbol">{</a><a id="3815" class="Argument">y′</a> <a id="3818" class="Symbol">=</a> <a id="3820" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="3822" class="Symbol">(</a><a id="3823" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="3828" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a><a id="3829" class="Symbol">)</a> <a id="3831" class="Symbol">(</a><a id="3832" href="UTxO.Types.html#4728" class="Field">value</a> <a id="3838" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3840" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="3843" class="Symbol">)}</a>
                       <a id="3869" href="UTxO.GlobalPreservation.html#3292" class="Function">pv</a> <a id="3872" href="UTxO.GlobalPreservation.html#3400" class="Function">gpv</a>

    <a id="3881" href="UTxO.GlobalPreservation.html#3881" class="Function">pv-gpv′</a> <a id="3889" class="Symbol">:</a> <a id="3891" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="3897" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a> <a id="3900" href="UTxO.Value.html#1833" class="Function Operator">+ᶜ</a> <a id="3903" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="3905" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a> <a id="3907" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="3913" href="UTxO.Value.html#1833" class="Function Operator">+ᶜ</a> <a id="3916" href="UTxO.GlobalPreservation.html#1033" class="Function">∑in</a> <a id="3920" href="UTxO.GlobalPreservation.html#813" class="Bound">vl₀</a>
            <a id="3936" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3938" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="3940" class="Symbol">(</a><a id="3941" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="3946" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a><a id="3947" class="Symbol">)</a> <a id="3949" class="Symbol">(</a><a id="3950" href="UTxO.Types.html#4728" class="Field">value</a> <a id="3956" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3958" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="3961" class="Symbol">)</a> <a id="3963" href="UTxO.Value.html#1833" class="Function Operator">+ᶜ</a> <a id="3966" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="3968" class="Symbol">(</a><a id="3969" href="UTxO.Types.html#7520" class="Field">outputs</a> <a id="3977" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a><a id="3979" class="Symbol">)</a> <a id="3981" href="UTxO.Types.html#4728" class="Field">value</a>
    <a id="3991" href="UTxO.GlobalPreservation.html#3881" class="Function">pv-gpv′</a> <a id="3999" class="Keyword">rewrite</a> <a id="4007" href="UTxO.Value.html#3706" class="Postulate">+ᶜ-assoc</a> <a id="4016" class="Symbol">(</a><a id="4017" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="4023" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a><a id="4025" class="Symbol">)</a> <a id="4027" class="Symbol">(</a><a id="4028" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="4030" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a> <a id="4032" href="UTxO.Types.html#7555" class="Field">forge</a><a id="4037" class="Symbol">)</a> <a id="4039" class="Symbol">(</a><a id="4040" href="UTxO.GlobalPreservation.html#1033" class="Function">∑in</a> <a id="4044" href="UTxO.GlobalPreservation.html#813" class="Bound">vl₀</a><a id="4047" class="Symbol">)</a>
                  <a id="4067" class="Symbol">|</a> <a id="4069" href="UTxO.Value.html#3676" class="Postulate">+ᶜ-comm</a> <a id="4077" class="Symbol">(</a><a id="4078" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="4080" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a> <a id="4082" href="UTxO.Types.html#7555" class="Field">forge</a><a id="4087" class="Symbol">)</a> <a id="4089" class="Symbol">(</a><a id="4090" href="UTxO.GlobalPreservation.html#1033" class="Function">∑in</a> <a id="4094" href="UTxO.GlobalPreservation.html#813" class="Bound">vl₀</a><a id="4097" class="Symbol">)</a>
                  <a id="4117" class="Symbol">|</a> <a id="4119" href="Relation.Binary.PropositionalEquality.Core.html#980" class="Function">sym</a> <a id="4123" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="4125" href="UTxO.Value.html#3706" class="Postulate">+ᶜ-assoc</a> <a id="4134" class="Symbol">(</a><a id="4135" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="4141" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a><a id="4143" class="Symbol">)</a> <a id="4145" class="Symbol">(</a><a id="4146" href="UTxO.GlobalPreservation.html#1033" class="Function">∑in</a> <a id="4150" href="UTxO.GlobalPreservation.html#813" class="Bound">vl₀</a><a id="4153" class="Symbol">)</a> <a id="4155" class="Symbol">(</a><a id="4156" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="4158" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a> <a id="4160" href="UTxO.Types.html#7555" class="Field">forge</a><a id="4165" class="Symbol">)</a>
                  <a id="4185" class="Symbol">|</a> <a id="4187" href="UTxO.Value.html#3676" class="Postulate">+ᶜ-comm</a> <a id="4195" class="Symbol">(</a><a id="4196" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="4198" class="Symbol">(</a><a id="4199" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="4204" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a><a id="4205" class="Symbol">)</a> <a id="4207" class="Symbol">(</a><a id="4208" href="UTxO.Types.html#4728" class="Field">value</a> <a id="4214" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="4216" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="4219" class="Symbol">))</a> <a id="4222" class="Symbol">(</a><a id="4223" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="4225" class="Symbol">(</a><a id="4226" href="UTxO.Types.html#7520" class="Field">outputs</a> <a id="4234" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a><a id="4236" class="Symbol">)</a> <a id="4238" href="UTxO.Types.html#4728" class="Field">value</a><a id="4243" class="Symbol">)</a>
                  <a id="4263" class="Symbol">=</a> <a id="4265" href="UTxO.GlobalPreservation.html#3594" class="Function">pv-gpv</a>

    <a id="4277" href="UTxO.GlobalPreservation.html#4277" class="Function">pv-gpv″</a> <a id="4285" class="Symbol">:</a> <a id="4287" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="4289" href="UTxO.GlobalPreservation.html#799" class="Bound">l₀</a> <a id="4292" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="4298" href="UTxO.Value.html#1833" class="Function Operator">+ᶜ</a> <a id="4301" href="UTxO.GlobalPreservation.html#1033" class="Function">∑in</a> <a id="4305" href="UTxO.GlobalPreservation.html#813" class="Bound">vl₀</a>
            <a id="4321" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4323" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="4325" class="Symbol">(</a><a id="4326" href="UTxO.Types.html#7520" class="Field">outputs</a> <a id="4334" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a><a id="4336" class="Symbol">)</a> <a id="4338" href="UTxO.Types.html#4728" class="Field">value</a> <a id="4344" href="UTxO.Value.html#1833" class="Function Operator">+ᶜ</a> <a id="4347" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="4349" class="Symbol">(</a><a id="4350" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="4355" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a><a id="4356" class="Symbol">)</a> <a id="4358" class="Symbol">(</a><a id="4359" href="UTxO.Types.html#4728" class="Field">value</a> <a id="4365" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="4367" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="4370" class="Symbol">)</a>
    <a id="4376" href="UTxO.GlobalPreservation.html#4277" class="Function">pv-gpv″</a>
      <a id="4390" class="Keyword">rewrite</a> <a id="4398" href="UTxO.Value.html#3676" class="Postulate">+ᶜ-comm</a> <a id="4406" class="Symbol">(</a><a id="4407" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="4409" class="Symbol">(</a><a id="4410" href="UTxO.Types.html#7520" class="Field">outputs</a> <a id="4418" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a><a id="4420" class="Symbol">)</a> <a id="4422" href="UTxO.Types.html#4728" class="Field">value</a><a id="4427" class="Symbol">)</a> <a id="4429" class="Symbol">(</a><a id="4430" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="4432" class="Symbol">(</a><a id="4433" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="4438" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a><a id="4439" class="Symbol">)</a> <a id="4441" class="Symbol">(</a><a id="4442" href="UTxO.Types.html#4728" class="Field">value</a> <a id="4448" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="4450" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="4453" class="Symbol">))</a>
            <a id="4468" class="Symbol">=</a> <a id="4470" href="UTxO.GlobalPreservation.html#3881" class="Function">pv-gpv′</a>

    <a id="4483" href="UTxO.GlobalPreservation.html#4483" class="Function">helper</a> <a id="4490" class="Symbol">:</a> <a id="4492" class="Symbol">∀</a> <a id="4494" class="Symbol">{</a><a id="4495" href="UTxO.GlobalPreservation.html#4495" class="Bound">l</a> <a id="4497" href="UTxO.GlobalPreservation.html#4497" class="Bound">tx</a><a id="4499" class="Symbol">}</a> <a id="4501" class="Symbol">{</a><a id="4502" href="UTxO.GlobalPreservation.html#4502" class="Bound">vl</a> <a id="4505" class="Symbol">:</a> <a id="4507" href="UTxO.Validity.html#2109" class="Datatype">ValidLedger</a> <a id="4519" class="Symbol">(</a><a id="4520" href="UTxO.GlobalPreservation.html#4497" class="Bound">tx</a> <a id="4523" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4525" href="UTxO.GlobalPreservation.html#4495" class="Bound">l</a><a id="4526" class="Symbol">)}</a> <a id="4529" class="Symbol">{</a><a id="4530" href="UTxO.GlobalPreservation.html#4530" class="Bound">x</a> <a id="4532" href="UTxO.GlobalPreservation.html#4532" class="Bound">y</a> <a id="4534" class="Symbol">:</a> <a id="4536" href="UTxO.Value.html#825" class="Function">Value</a><a id="4541" class="Symbol">}</a>
      <a id="4549" class="Symbol">→</a> <a id="4551" href="UTxO.GlobalPreservation.html#4530" class="Bound">x</a> <a id="4553" href="UTxO.Value.html#1833" class="Function Operator">+ᶜ</a> <a id="4556" href="UTxO.GlobalPreservation.html#1033" class="Function">∑in</a> <a id="4560" href="UTxO.GlobalPreservation.html#4502" class="Bound">vl</a> <a id="4563" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4565" href="UTxO.GlobalPreservation.html#4532" class="Bound">y</a> <a id="4567" href="UTxO.Value.html#1833" class="Function Operator">+ᶜ</a> <a id="4570" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="4572" class="Symbol">(</a><a id="4573" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="4578" href="UTxO.GlobalPreservation.html#4495" class="Bound">l</a><a id="4579" class="Symbol">)</a> <a id="4581" class="Symbol">(</a><a id="4582" href="UTxO.Types.html#4728" class="Field">value</a> <a id="4588" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="4590" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="4593" class="Symbol">)</a>
      <a id="4601" class="Symbol">→</a> <a id="4603" href="UTxO.GlobalPreservation.html#4530" class="Bound">x</a> <a id="4605" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4607" href="UTxO.GlobalPreservation.html#4532" class="Bound">y</a> <a id="4609" href="UTxO.Value.html#1833" class="Function Operator">+ᶜ</a> <a id="4612" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="4614" class="Symbol">(</a><a id="4615" href="Data.List.Base.html#7436" class="Function">filter</a> <a id="4622" class="Symbol">((</a><a id="4624" href="Prelude.DecEq.html#2123" class="Function Operator">_∉?</a> <a id="4628" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="4639" href="UTxO.GlobalPreservation.html#4497" class="Bound">tx</a><a id="4641" class="Symbol">)</a> <a id="4643" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="4645" href="UTxO.TxUtilities.html#471" class="Field">outRef</a><a id="4651" class="Symbol">)</a> <a id="4653" class="Symbol">(</a><a id="4654" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="4659" href="UTxO.GlobalPreservation.html#4495" class="Bound">l</a><a id="4660" class="Symbol">))</a> <a id="4663" class="Symbol">(</a><a id="4664" href="UTxO.Types.html#4728" class="Field">value</a> <a id="4670" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="4672" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="4675" class="Symbol">)</a>
    <a id="4681" href="UTxO.GlobalPreservation.html#4483" class="Function">helper</a> <a id="4688" class="Symbol">{</a><a id="4689" href="UTxO.GlobalPreservation.html#4689" class="Bound">l</a><a id="4690" class="Symbol">}</a> <a id="4692" class="Symbol">{</a><a id="4693" href="UTxO.GlobalPreservation.html#4693" class="Bound">tx</a><a id="4695" class="Symbol">}</a> <a id="4697" class="Symbol">{</a><a id="4698" href="UTxO.GlobalPreservation.html#4698" class="Bound">vl</a><a id="4700" class="Symbol">}</a> <a id="4702" class="Symbol">{</a><a id="4703" href="UTxO.GlobalPreservation.html#4703" class="Bound">x</a><a id="4704" class="Symbol">}</a> <a id="4706" class="Symbol">{</a><a id="4707" href="UTxO.GlobalPreservation.html#4707" class="Bound">y</a><a id="4708" class="Symbol">}</a> <a id="4710" href="UTxO.GlobalPreservation.html#4710" class="Bound">p</a>
      <a id="4718" class="Keyword">rewrite</a> <a id="4726" href="UTxO.GlobalPreservation.html#1149" class="Function">∑-outRef</a> <a id="4735" class="Symbol">{</a><a id="4736" href="UTxO.GlobalPreservation.html#4689" class="Bound">l</a><a id="4737" class="Symbol">}</a> <a id="4739" class="Symbol">{</a><a id="4740" href="UTxO.GlobalPreservation.html#4693" class="Bound">tx</a><a id="4742" class="Symbol">}</a> <a id="4744" class="Symbol">{</a><a id="4745" href="UTxO.GlobalPreservation.html#4698" class="Bound">vl</a><a id="4747" class="Symbol">}</a>
            <a id="4761" class="Symbol">|</a> <a id="4763" href="UTxO.Value.html#4313" class="Postulate">∑-filter</a> <a id="4772" class="Symbol">{</a><a id="4773" class="Argument">xs</a> <a id="4776" class="Symbol">=</a> <a id="4778" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="4783" href="UTxO.GlobalPreservation.html#4689" class="Bound">l</a><a id="4784" class="Symbol">}</a> <a id="4786" class="Symbol">{</a><a id="4787" class="Argument">q</a> <a id="4789" class="Symbol">=</a> <a id="4791" class="Symbol">(</a><a id="4792" href="Data.List.Membership.DecSetoid.html#762" class="Function Operator">_∈?</a> <a id="4796" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="4807" href="UTxO.GlobalPreservation.html#4693" class="Bound">tx</a><a id="4809" class="Symbol">)</a> <a id="4811" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="4813" href="UTxO.TxUtilities.html#471" class="Field">outRef</a><a id="4819" class="Symbol">}</a>
                       <a id="4844" class="Symbol">{</a><a id="4845" class="Argument">f</a> <a id="4847" class="Symbol">=</a> <a id="4849" href="UTxO.Types.html#4728" class="Field">value</a> <a id="4855" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="4857" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="4860" class="Symbol">}</a> <a id="4862" class="Symbol">{</a><a id="4863" class="Argument">x</a> <a id="4865" class="Symbol">=</a> <a id="4867" href="UTxO.GlobalPreservation.html#4703" class="Bound">x</a><a id="4868" class="Symbol">}</a> <a id="4870" class="Symbol">{</a><a id="4871" class="Argument">y</a> <a id="4873" class="Symbol">=</a> <a id="4875" href="UTxO.GlobalPreservation.html#4707" class="Bound">y</a><a id="4876" class="Symbol">}</a> <a id="4878" href="UTxO.GlobalPreservation.html#4710" class="Bound">p</a>
            <a id="4892" class="Symbol">=</a> <a id="4894" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

    <a id="4904" href="UTxO.GlobalPreservation.html#4904" class="Function">h</a> <a id="4906" class="Symbol">:</a> <a id="4908" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="4910" href="UTxO.GlobalPreservation.html#799" class="Bound">l₀</a> <a id="4913" href="UTxO.Types.html#7555" class="Field">forge</a>
      <a id="4925" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a>  <a id="4928" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="4930" class="Symbol">(</a><a id="4931" href="UTxO.Types.html#7520" class="Field">outputs</a> <a id="4939" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a><a id="4941" class="Symbol">)</a> <a id="4943" href="UTxO.Types.html#4728" class="Field">value</a>
      <a id="4955" href="UTxO.Value.html#1833" class="Function Operator">+ᶜ</a> <a id="4958" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="4960" class="Symbol">(</a><a id="4961" href="Data.List.Base.html#7436" class="Function">filter</a> <a id="4968" class="Symbol">((</a><a id="4970" href="Prelude.DecEq.html#2123" class="Function Operator">_∉?</a> <a id="4974" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="4985" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a><a id="4987" class="Symbol">)</a> <a id="4989" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="4991" href="UTxO.TxUtilities.html#471" class="Field">outRef</a><a id="4997" class="Symbol">)</a> <a id="4999" class="Symbol">(</a><a id="5000" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="5005" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a><a id="5006" class="Symbol">))</a> <a id="5009" class="Symbol">(</a><a id="5010" href="UTxO.Types.html#4728" class="Field">value</a> <a id="5016" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5018" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="5021" class="Symbol">)</a>
    <a id="5027" href="UTxO.GlobalPreservation.html#4904" class="Function">h</a> <a id="5029" class="Symbol">=</a> <a id="5031" href="UTxO.GlobalPreservation.html#4483" class="Function">helper</a> <a id="5038" class="Symbol">{</a><a id="5039" class="Argument">l</a> <a id="5041" class="Symbol">=</a> <a id="5043" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a><a id="5044" class="Symbol">}</a> <a id="5046" class="Symbol">{</a><a id="5047" class="Argument">tx</a> <a id="5050" class="Symbol">=</a> <a id="5052" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a><a id="5054" class="Symbol">}</a> <a id="5056" class="Symbol">{</a><a id="5057" class="Argument">vl</a> <a id="5060" class="Symbol">=</a> <a id="5062" href="UTxO.GlobalPreservation.html#813" class="Bound">vl₀</a><a id="5065" class="Symbol">}</a>
               <a id="5082" class="Symbol">{</a><a id="5083" class="Argument">x</a> <a id="5085" class="Symbol">=</a> <a id="5087" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="5089" href="UTxO.GlobalPreservation.html#799" class="Bound">l₀</a> <a id="5092" href="UTxO.Types.html#7555" class="Field">forge</a><a id="5097" class="Symbol">}</a>
               <a id="5114" class="Symbol">{</a><a id="5115" class="Argument">y</a> <a id="5117" class="Symbol">=</a> <a id="5119" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="5121" class="Symbol">(</a><a id="5122" href="UTxO.Types.html#7520" class="Field">outputs</a> <a id="5130" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a><a id="5132" class="Symbol">)</a> <a id="5134" href="UTxO.Types.html#4728" class="Field">value</a><a id="5139" class="Symbol">}</a> <a id="5141" href="UTxO.GlobalPreservation.html#4277" class="Function">pv-gpv″</a>

    <a id="5154" href="UTxO.GlobalPreservation.html#5154" class="Function">h′</a> <a id="5157" class="Symbol">:</a> <a id="5159" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="5161" href="UTxO.GlobalPreservation.html#799" class="Bound">l₀</a> <a id="5164" href="UTxO.Types.html#7555" class="Field">forge</a>
       <a id="5177" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5179" class="Symbol">(</a> <a id="5181" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="5183" class="Symbol">(</a><a id="5184" href="Data.List.Base.html#7436" class="Function">filter</a> <a id="5191" class="Symbol">((</a><a id="5193" href="Prelude.DecEq.html#2123" class="Function Operator">_∉?</a> <a id="5197" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="5208" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a><a id="5210" class="Symbol">)</a> <a id="5212" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5214" href="UTxO.TxUtilities.html#471" class="Field">outRef</a><a id="5220" class="Symbol">)</a> <a id="5222" class="Symbol">(</a><a id="5223" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="5228" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a><a id="5229" class="Symbol">))</a> <a id="5232" class="Symbol">(</a><a id="5233" href="UTxO.Types.html#4728" class="Field">value</a> <a id="5239" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5241" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="5244" class="Symbol">)</a>
         <a id="5255" href="UTxO.Value.html#1833" class="Function Operator">+ᶜ</a> <a id="5258" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="5260" class="Symbol">(</a><a id="5261" href="UTxO.Types.html#7520" class="Field">outputs</a> <a id="5269" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a><a id="5271" class="Symbol">)</a> <a id="5273" href="UTxO.Types.html#4728" class="Field">value</a> <a id="5279" class="Symbol">)</a>
    <a id="5285" href="UTxO.GlobalPreservation.html#5154" class="Function">h′</a> <a id="5288" class="Keyword">rewrite</a> <a id="5296" href="UTxO.Value.html#3676" class="Postulate">+ᶜ-comm</a> <a id="5304" class="Symbol">(</a><a id="5305" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="5307" class="Symbol">(</a><a id="5308" href="Data.List.Base.html#7436" class="Function">filter</a> <a id="5315" class="Symbol">((</a><a id="5317" href="Prelude.DecEq.html#2123" class="Function Operator">_∉?</a> <a id="5321" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="5332" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a><a id="5334" class="Symbol">)</a> <a id="5336" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5338" href="UTxO.TxUtilities.html#471" class="Field">outRef</a><a id="5344" class="Symbol">)</a> <a id="5346" class="Symbol">(</a><a id="5347" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="5352" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a><a id="5353" class="Symbol">))</a> <a id="5356" class="Symbol">(</a><a id="5357" href="UTxO.Types.html#4728" class="Field">value</a> <a id="5363" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5365" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="5368" class="Symbol">))</a>
                       <a id="5394" class="Symbol">(</a><a id="5395" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="5397" class="Symbol">(</a><a id="5398" href="UTxO.Types.html#7520" class="Field">outputs</a> <a id="5406" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a><a id="5408" class="Symbol">)</a> <a id="5410" href="UTxO.Types.html#4728" class="Field">value</a><a id="5415" class="Symbol">)</a>
             <a id="5430" class="Symbol">=</a> <a id="5432" href="UTxO.GlobalPreservation.html#4904" class="Function">h</a>

    <a id="5439" href="UTxO.GlobalPreservation.html#5439" class="Function">∑-utxo</a> <a id="5446" class="Symbol">:</a> <a id="5448" class="Symbol">∀</a> <a id="5450" class="Symbol">{</a><a id="5451" href="UTxO.GlobalPreservation.html#5451" class="Bound">l</a> <a id="5453" href="UTxO.GlobalPreservation.html#5453" class="Bound">tx</a><a id="5455" class="Symbol">}</a>
      <a id="5463" class="Symbol">→</a> <a id="5465" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="5467" class="Symbol">(</a><a id="5468" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="5473" class="Symbol">(</a><a id="5474" href="UTxO.GlobalPreservation.html#5453" class="Bound">tx</a> <a id="5477" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5479" href="UTxO.GlobalPreservation.html#5451" class="Bound">l</a><a id="5480" class="Symbol">))</a> <a id="5483" class="Symbol">(</a><a id="5484" href="UTxO.Types.html#4728" class="Field">value</a> <a id="5490" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5492" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="5495" class="Symbol">)</a>
      <a id="5503" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5505" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="5507" class="Symbol">(</a><a id="5508" href="Data.List.Base.html#7436" class="Function">filter</a> <a id="5515" class="Symbol">((</a><a id="5517" href="Prelude.DecEq.html#2123" class="Function Operator">_∉?</a> <a id="5521" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="5532" href="UTxO.GlobalPreservation.html#5453" class="Bound">tx</a><a id="5534" class="Symbol">)</a> <a id="5536" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5538" href="UTxO.TxUtilities.html#471" class="Field">outRef</a><a id="5544" class="Symbol">)</a> <a id="5546" class="Symbol">(</a><a id="5547" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="5552" href="UTxO.GlobalPreservation.html#5451" class="Bound">l</a><a id="5553" class="Symbol">))</a> <a id="5556" class="Symbol">(</a><a id="5557" href="UTxO.Types.html#4728" class="Field">value</a> <a id="5563" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5565" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="5568" class="Symbol">)</a> <a id="5570" href="UTxO.Value.html#1833" class="Function Operator">+ᶜ</a> <a id="5573" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="5575" class="Symbol">(</a><a id="5576" href="UTxO.Types.html#7520" class="Field">outputs</a> <a id="5584" href="UTxO.GlobalPreservation.html#5453" class="Bound">tx</a><a id="5586" class="Symbol">)</a> <a id="5588" href="UTxO.Types.html#4728" class="Field">value</a>
    <a id="5598" href="UTxO.GlobalPreservation.html#5439" class="Function">∑-utxo</a> <a id="5605" class="Symbol">{</a><a id="5606" href="UTxO.GlobalPreservation.html#5606" class="Bound">l</a><a id="5607" class="Symbol">}</a> <a id="5609" class="Symbol">{</a><a id="5610" href="UTxO.GlobalPreservation.html#5610" class="Bound">tx</a><a id="5612" class="Symbol">}</a>
      <a id="5620" class="Keyword">rewrite</a> <a id="5628" href="UTxO.Value.html#4076" class="Postulate">∑-++</a> <a id="5633" class="Symbol">{</a><a id="5634" class="Argument">xs</a> <a id="5637" class="Symbol">=</a> <a id="5639" href="Data.List.Base.html#7436" class="Function">filter</a> <a id="5646" class="Symbol">((</a><a id="5648" href="Prelude.DecEq.html#2123" class="Function Operator">_∉?</a> <a id="5652" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="5663" href="UTxO.GlobalPreservation.html#5610" class="Bound">tx</a><a id="5665" class="Symbol">)</a> <a id="5667" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5669" href="UTxO.TxUtilities.html#471" class="Field">outRef</a><a id="5675" class="Symbol">)</a> <a id="5677" class="Symbol">(</a><a id="5678" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="5683" href="UTxO.GlobalPreservation.html#5606" class="Bound">l</a><a id="5684" class="Symbol">)}</a>
                   <a id="5706" class="Symbol">{</a><a id="5707" class="Argument">ys</a> <a id="5710" class="Symbol">=</a> <a id="5712" href="Data.List.Membership.Setoid.html#1123" class="Function">mapWith∈</a> <a id="5721" class="Symbol">(</a><a id="5722" href="UTxO.Types.html#7520" class="Field">outputs</a> <a id="5730" href="UTxO.GlobalPreservation.html#5610" class="Bound">tx</a><a id="5732" class="Symbol">)</a> <a id="5734" class="Symbol">(</a><a id="5735" href="UTxO.TxUtilities.html#555" class="Function">mkUtxo</a> <a id="5742" href="UTxO.GlobalPreservation.html#5610" class="Bound">tx</a><a id="5744" class="Symbol">)}</a>
                   <a id="5766" class="Symbol">{</a><a id="5767" class="Argument">fv</a> <a id="5770" class="Symbol">=</a> <a id="5772" href="UTxO.Types.html#4728" class="Field">value</a> <a id="5778" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5780" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="5783" class="Symbol">}</a>
            <a id="5797" class="Symbol">|</a> <a id="5799" href="UTxO.Value.html#4147" class="Postulate">∑-mapWith∈</a> <a id="5810" class="Symbol">{</a><a id="5811" class="Argument">xs</a> <a id="5814" class="Symbol">=</a> <a id="5816" href="UTxO.Types.html#7520" class="Field">outputs</a> <a id="5824" href="UTxO.GlobalPreservation.html#5610" class="Bound">tx</a><a id="5826" class="Symbol">}</a> <a id="5828" class="Symbol">{</a><a id="5829" class="Argument">fv</a> <a id="5832" class="Symbol">=</a> <a id="5834" href="UTxO.Types.html#4728" class="Field">value</a><a id="5839" class="Symbol">}</a> <a id="5841" class="Symbol">{</a><a id="5842" class="Argument">gv</a> <a id="5845" class="Symbol">=</a> <a id="5847" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="5850" class="Symbol">}</a> <a id="5852" class="Symbol">{</a><a id="5853" class="Argument">f</a> <a id="5855" class="Symbol">=</a> <a id="5857" href="UTxO.TxUtilities.html#555" class="Function">mkUtxo</a> <a id="5864" href="UTxO.GlobalPreservation.html#5610" class="Bound">tx</a><a id="5866" class="Symbol">}</a> <a id="5868" class="Symbol">(λ</a> <a id="5871" href="UTxO.GlobalPreservation.html#5871" class="Bound">_</a> <a id="5873" class="Symbol">→</a> <a id="5875" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="5879" class="Symbol">)</a>
            <a id="5893" class="Symbol">=</a> <a id="5895" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

    <a id="5905" href="UTxO.GlobalPreservation.html#5905" class="Function">h″</a> <a id="5908" class="Symbol">:</a> <a id="5910" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="5912" href="UTxO.GlobalPreservation.html#799" class="Bound">l₀</a> <a id="5915" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="5921" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="5923" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="5925" class="Symbol">(</a><a id="5926" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="5931" href="UTxO.GlobalPreservation.html#799" class="Bound">l₀</a><a id="5933" class="Symbol">)</a> <a id="5935" class="Symbol">(</a><a id="5936" href="UTxO.Types.html#4728" class="Field">value</a> <a id="5942" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5944" href="UTxO.TxUtilities.html#498" class="Field">out</a><a id="5947" class="Symbol">)</a>
    <a id="5953" href="UTxO.GlobalPreservation.html#5905" class="Function">h″</a> <a id="5956" class="Keyword">rewrite</a> <a id="5964" href="UTxO.GlobalPreservation.html#5439" class="Function">∑-utxo</a> <a id="5971" class="Symbol">{</a><a id="5972" href="UTxO.GlobalPreservation.html#808" class="Bound">l</a><a id="5973" class="Symbol">}</a> <a id="5975" class="Symbol">{</a><a id="5976" href="UTxO.GlobalPreservation.html#803" class="Bound">tx</a><a id="5978" class="Symbol">}</a> <a id="5980" class="Symbol">=</a> <a id="5982" href="UTxO.GlobalPreservation.html#5154" class="Function">h′</a>
</pre></body></html>