<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>StateMachine.Base</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">{-
A State Machine library for smart contracts, based on very similar
library for Plutus Smart contracts

Specification of a state machine, consisting of a transition
function that determines the next state from the current state and
an input, and a checking function that checks the validity of the
transition in the context of the current transaction.
-}</a>
<a id="358" class="Keyword">module</a> <a id="365" href="StateMachine.Base.html" class="Module">StateMachine.Base</a> <a id="383" class="Keyword">where</a>

<a id="390" class="Keyword">open</a> <a id="395" class="Keyword">import</a> <a id="402" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="413" class="Keyword">using</a> <a id="419" class="Symbol">(</a><a id="420" href="Data.Maybe.Base.html#1651" class="Function">fromMaybe</a><a id="429" class="Symbol">)</a>
<a id="431" class="Keyword">open</a> <a id="436" class="Keyword">import</a> <a id="443" href="Data.List.Relation.Binary.Pointwise.html" class="Module">Data.List.Relation.Binary.Pointwise</a> <a id="479" class="Keyword">using</a> <a id="485" class="Symbol">(</a><a id="486" href="Data.List.Relation.Binary.Pointwise.html#12819" class="Function">≡⇒Pointwise-≡</a><a id="499" class="Symbol">)</a>
<a id="501" class="Keyword">open</a> <a id="506" class="Keyword">import</a> <a id="513" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="533" class="Keyword">using</a> <a id="539" class="Symbol">(</a><a id="540" href="Data.Nat.Properties.html#12591" class="Function">+-identityˡ</a><a id="551" class="Symbol">;</a> <a id="553" href="Data.Nat.Properties.html#6653" class="Function">&lt;⇒≢</a><a id="556" class="Symbol">;</a> <a id="558" href="Data.Nat.Properties.html#11809" class="Function">≤⇒pred≤</a><a id="565" class="Symbol">)</a>

<a id="568" class="Keyword">open</a> <a id="573" class="Keyword">import</a> <a id="580" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="593" class="Keyword">open</a> <a id="598" class="Keyword">import</a> <a id="605" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="621" class="Keyword">open</a> <a id="626" class="Keyword">import</a> <a id="633" href="Prelude.Lists.html" class="Module">Prelude.Lists</a> <a id="647" class="Keyword">using</a> <a id="653" class="Symbol">(</a><a id="654" href="Prelude.Lists.html#2067" class="Function">enumerate</a><a id="663" class="Symbol">)</a>
<a id="665" class="Keyword">open</a> <a id="670" class="Keyword">import</a> <a id="677" href="Prelude.Default.html" class="Module">Prelude.Default</a>
<a id="693" class="Keyword">open</a> <a id="698" class="Keyword">import</a> <a id="705" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="719" class="Keyword">open</a> <a id="724" class="Keyword">import</a> <a id="731" href="Prelude.Set%2527.html" class="Module">Prelude.Set&#39;</a>
<a id="744" class="Keyword">open</a> <a id="749" class="Keyword">import</a> <a id="756" href="Prelude.Monad.html" class="Module">Prelude.Monad</a>

<a id="771" class="Keyword">open</a> <a id="776" class="Keyword">import</a> <a id="783" href="UTxO.Hashing.html" class="Module">UTxO.Hashing</a>
<a id="796" class="Keyword">open</a> <a id="801" class="Keyword">import</a> <a id="808" href="UTxO.Value.html" class="Module">UTxO.Value</a>
<a id="819" class="Keyword">open</a> <a id="824" class="Keyword">import</a> <a id="831" href="UTxO.Types.html" class="Module">UTxO.Types</a> <a id="842" class="Keyword">hiding</a> <a id="849" class="Symbol">(</a><a id="850" href="UTxO.Types.html#751" class="InductiveConstructor">I</a><a id="851" class="Symbol">)</a>
<a id="853" class="Keyword">open</a> <a id="858" class="Keyword">import</a> <a id="865" href="UTxO.TxUtilities.html" class="Module">UTxO.TxUtilities</a>
<a id="882" class="Keyword">open</a> <a id="887" class="Keyword">import</a> <a id="894" href="UTxO.Validity.html" class="Module">UTxO.Validity</a>
<a id="908" class="Keyword">open</a> <a id="913" class="Keyword">import</a> <a id="920" href="UTxO.Defaults.html" class="Module">UTxO.Defaults</a>


<a id="936" class="Comment">--------------------------</a>
<a id="963" class="Comment">-- Transaction constraints</a>

<a id="991" class="Keyword">record</a> <a id="TxConstraints"></a><a id="998" href="StateMachine.Base.html#998" class="Record">TxConstraints</a> <a id="1012" class="Symbol">:</a> <a id="1014" class="PrimitiveType">Set</a> <a id="1018" class="Keyword">where</a>
  <a id="1026" class="Keyword">field</a>
    <a id="TxConstraints.forge≡"></a><a id="1036" href="StateMachine.Base.html#1036" class="Field">forge≡</a> <a id="1043" class="Symbol">:</a> <a id="1045" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="1051" href="UTxO.Types.html#7136" class="Function">ValueS</a>
    <a id="TxConstraints.range≡"></a><a id="1062" href="StateMachine.Base.html#1062" class="Field">range≡</a> <a id="1069" class="Symbol">:</a> <a id="1071" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="1077" href="UTxO.Types.html#3422" class="Datatype">SlotRange</a>
    <a id="TxConstraints.spent≥"></a><a id="1091" href="StateMachine.Base.html#1091" class="Field">spent≥</a> <a id="1098" class="Symbol">:</a> <a id="1100" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="1106" href="UTxO.Value.html#825" class="Function">Value</a>

<a id="1113" class="Keyword">open</a> <a id="1118" href="StateMachine.Base.html#998" class="Module">TxConstraints</a> <a id="1132" class="Keyword">public</a>

<a id="1140" class="Keyword">instance</a>
  <a id="Default-TxConstraints"></a><a id="1151" href="StateMachine.Base.html#1151" class="Function">Default-TxConstraints</a> <a id="1173" class="Symbol">:</a> <a id="1175" href="Prelude.Default.html#676" class="Record">Default</a> <a id="1183" href="StateMachine.Base.html#998" class="Record">TxConstraints</a>
  <a id="1199" href="StateMachine.Base.html#1151" class="Function">Default-TxConstraints</a> <a id="1221" class="Symbol">=</a> <a id="1223" href="Prelude.Default.html#720" class="InductiveConstructor Operator">⌞</a> <a id="1225" class="Keyword">record</a>
    <a id="1236" class="Symbol">{</a> <a id="1238" href="StateMachine.Base.html#1036" class="Field">forge≡</a> <a id="1245" class="Symbol">=</a> <a id="1247" href="Prelude.Default.html#736" class="Field">def</a>
    <a id="1255" class="Symbol">;</a> <a id="1257" href="StateMachine.Base.html#1062" class="Field">range≡</a> <a id="1264" class="Symbol">=</a> <a id="1266" href="Prelude.Default.html#736" class="Field">def</a>
    <a id="1274" class="Symbol">;</a> <a id="1276" href="StateMachine.Base.html#1091" class="Field">spent≥</a> <a id="1283" class="Symbol">=</a> <a id="1285" href="Prelude.Default.html#736" class="Field">def</a> <a id="1289" class="Symbol">}</a> <a id="1291" href="Prelude.Default.html#720" class="InductiveConstructor Operator">⌟</a>

<a id="_&gt;&gt;=ₜ_"></a><a id="1294" href="StateMachine.Base.html#1294" class="Function Operator">_&gt;&gt;=ₜ_</a> <a id="1301" class="Symbol">:</a> <a id="1303" class="Symbol">∀</a> <a id="1305" class="Symbol">{</a><a id="1306" href="StateMachine.Base.html#1306" class="Bound">a</a> <a id="1308" class="Symbol">:</a> <a id="1310" class="PrimitiveType">Set</a><a id="1313" class="Symbol">}</a> <a id="1315" class="Symbol">→</a> <a id="1317" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="1323" href="StateMachine.Base.html#1306" class="Bound">a</a> <a id="1325" class="Symbol">→</a> <a id="1327" class="Symbol">(</a><a id="1328" href="StateMachine.Base.html#1306" class="Bound">a</a> <a id="1330" class="Symbol">→</a> <a id="1332" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="1336" class="Symbol">)</a> <a id="1338" class="Symbol">→</a> <a id="1340" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="1345" href="StateMachine.Base.html#1345" class="Bound">ma</a> <a id="1348" href="StateMachine.Base.html#1294" class="Function Operator">&gt;&gt;=ₜ</a> <a id="1353" href="StateMachine.Base.html#1353" class="Bound">f</a> <a id="1355" class="Symbol">=</a> <a id="1357" href="Data.Maybe.Base.html#1651" class="Function">fromMaybe</a> <a id="1367" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="1372" class="Symbol">(</a><a id="1373" href="StateMachine.Base.html#1345" class="Bound">ma</a> <a id="1376" href="Category.Monad.Indexed.html#677" class="Field Operator">&gt;&gt;=</a> <a id="1380" href="Category.Applicative.Indexed.html#985" class="Function">pure</a> <a id="1385" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="1387" href="StateMachine.Base.html#1353" class="Bound">f</a><a id="1388" class="Symbol">)</a>

<a id="verifyTxInfo"></a><a id="1391" href="StateMachine.Base.html#1391" class="Function">verifyTxInfo</a> <a id="1404" class="Symbol">:</a> <a id="1406" href="UTxO.Types.html#4892" class="Record">TxInfo</a> <a id="1413" class="Symbol">→</a> <a id="1415" href="StateMachine.Base.html#998" class="Record">TxConstraints</a> <a id="1429" class="Symbol">→</a> <a id="1431" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="1436" href="StateMachine.Base.html#1391" class="Function">verifyTxInfo</a> <a id="1449" href="StateMachine.Base.html#1449" class="Bound">tx</a> <a id="1452" href="StateMachine.Base.html#1452" class="Bound">tx≡</a> <a id="1456" class="Symbol">=</a>
  <a id="1460" class="Symbol">(</a><a id="1461" href="StateMachine.Base.html#1036" class="Field">forge≡</a> <a id="1468" href="StateMachine.Base.html#1452" class="Bound">tx≡</a> <a id="1472" href="StateMachine.Base.html#1294" class="Function Operator">&gt;&gt;=ₜ</a> <a id="1477" class="Symbol">λ</a> <a id="1479" href="StateMachine.Base.html#1479" class="Bound">v</a> <a id="1481" class="Symbol">→</a> <a id="1483" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="1485" href="UTxO.Types.html#4994" class="Field">TxInfo.forge</a> <a id="1498" href="StateMachine.Base.html#1449" class="Bound">tx</a> <a id="1501" href="Prelude.DecEq.html#590" class="Field Operator">≟</a> <a id="1503" href="UTxO.Types.html#7179" class="Function">toValue</a> <a id="1511" href="StateMachine.Base.html#1479" class="Bound">v</a> <a id="1513" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a><a id="1514" class="Symbol">)</a> <a id="1516" href="Data.Bool.Base.html#986" class="Function Operator">∧</a>
  <a id="1520" class="Symbol">(</a><a id="1521" href="StateMachine.Base.html#1062" class="Field">range≡</a> <a id="1528" href="StateMachine.Base.html#1452" class="Bound">tx≡</a> <a id="1532" href="StateMachine.Base.html#1294" class="Function Operator">&gt;&gt;=ₜ</a> <a id="1537" class="Symbol">λ</a> <a id="1539" href="StateMachine.Base.html#1539" class="Bound">r</a> <a id="1541" class="Symbol">→</a> <a id="1543" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="1545" href="UTxO.Types.html#5062" class="Field">TxInfo.range</a> <a id="1558" href="StateMachine.Base.html#1449" class="Bound">tx</a> <a id="1561" href="Prelude.DecEq.html#590" class="Field Operator">≟</a> <a id="1563" href="StateMachine.Base.html#1539" class="Bound">r</a> <a id="1565" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a><a id="1566" class="Symbol">)</a> <a id="1568" href="Data.Bool.Base.html#986" class="Function Operator">∧</a>
  <a id="1572" class="Symbol">(</a><a id="1573" href="StateMachine.Base.html#1091" class="Field">spent≥</a> <a id="1580" href="StateMachine.Base.html#1452" class="Bound">tx≡</a> <a id="1584" href="StateMachine.Base.html#1294" class="Function Operator">&gt;&gt;=ₜ</a> <a id="1589" class="Symbol">λ</a> <a id="1591" href="StateMachine.Base.html#1591" class="Bound">v</a> <a id="1593" class="Symbol">→</a> <a id="1595" href="UTxO.Types.html#5715" class="Function">valueSpent</a> <a id="1606" href="StateMachine.Base.html#1449" class="Bound">tx</a> <a id="1609" href="UTxO.Value.html#2174" class="Function Operator">≥ᶜ</a> <a id="1612" href="StateMachine.Base.html#1591" class="Bound">v</a><a id="1613" class="Symbol">)</a>

<a id="verifyTx"></a><a id="1616" href="StateMachine.Base.html#1616" class="Function">verifyTx</a> <a id="1625" class="Symbol">:</a> <a id="1627" href="UTxO.Types.html#7708" class="Function">Ledger</a> <a id="1634" class="Symbol">→</a> <a id="1636" href="UTxO.Types.html#7388" class="Record">Tx</a> <a id="1639" class="Symbol">→</a> <a id="1641" href="StateMachine.Base.html#998" class="Record">TxConstraints</a> <a id="1655" class="Symbol">→</a> <a id="1657" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="1662" href="StateMachine.Base.html#1616" class="Function">verifyTx</a> <a id="1671" href="StateMachine.Base.html#1671" class="Bound">l</a> <a id="1673" href="StateMachine.Base.html#1673" class="Bound">tx</a> <a id="1676" class="Symbol">=</a> <a id="1678" href="StateMachine.Base.html#1391" class="Function">verifyTxInfo</a> <a id="1691" class="Symbol">(</a><a id="1692" href="UTxO.TxUtilities.html#5851" class="Function">mkTxInfo</a> <a id="1701" href="StateMachine.Base.html#1671" class="Bound">l</a> <a id="1703" href="StateMachine.Base.html#1673" class="Bound">tx</a><a id="1705" class="Symbol">)</a>


<a id="1709" class="Comment">-------------------------------------</a>
<a id="1747" class="Comment">-- Constraint Emitting Machines (CEM)</a>

<a id="1786" class="Keyword">record</a> <a id="StateMachine"></a><a id="1793" href="StateMachine.Base.html#1793" class="Record">StateMachine</a> <a id="1806" class="Symbol">(</a><a id="1807" href="StateMachine.Base.html#1807" class="Bound">S</a> <a id="1809" href="StateMachine.Base.html#1809" class="Bound">I</a> <a id="1811" class="Symbol">:</a> <a id="1813" class="PrimitiveType">Set</a><a id="1816" class="Symbol">)</a> <a id="1818" class="Symbol">{{</a><a id="1820" href="StateMachine.Base.html#1820" class="Bound">_</a> <a id="1822" class="Symbol">:</a> <a id="1824" href="UTxO.Types.html#981" class="Record">IsData</a> <a id="1831" href="StateMachine.Base.html#1807" class="Bound">S</a><a id="1832" class="Symbol">}}</a> <a id="1835" class="Symbol">{{</a><a id="1837" href="StateMachine.Base.html#1837" class="Bound">_</a> <a id="1839" class="Symbol">:</a> <a id="1841" href="UTxO.Types.html#981" class="Record">IsData</a> <a id="1848" href="StateMachine.Base.html#1809" class="Bound">I</a><a id="1849" class="Symbol">}}</a> <a id="1852" class="Symbol">:</a> <a id="1854" class="PrimitiveType">Set</a> <a id="1858" class="Keyword">where</a>
  <a id="1866" class="Keyword">constructor</a> <a id="SM[_,_,_]"></a><a id="1878" href="StateMachine.Base.html#1878" class="InductiveConstructor Operator">SM[_,_,_]</a>
  <a id="1890" class="Keyword">field</a>
    <a id="StateMachine.isInitial"></a><a id="1900" href="StateMachine.Base.html#1900" class="Field">isInitial</a> <a id="1910" class="Symbol">:</a> <a id="1912" href="StateMachine.Base.html#1807" class="Bound">S</a> <a id="1914" class="Symbol">→</a> <a id="1916" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
    <a id="StateMachine.step"></a><a id="1925" href="StateMachine.Base.html#1925" class="Field">step</a>      <a id="1935" class="Symbol">:</a> <a id="1937" href="StateMachine.Base.html#1807" class="Bound">S</a> <a id="1939" class="Symbol">→</a> <a id="1941" href="StateMachine.Base.html#1809" class="Bound">I</a> <a id="1943" class="Symbol">→</a> <a id="1945" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="1951" class="Symbol">(</a><a id="1952" href="StateMachine.Base.html#1807" class="Bound">S</a> <a id="1954" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1956" href="StateMachine.Base.html#998" class="Record">TxConstraints</a><a id="1969" class="Symbol">)</a>
    <a id="StateMachine.origin"></a><a id="1975" href="StateMachine.Base.html#1975" class="Field">origin</a>    <a id="1985" class="Symbol">:</a> <a id="1987" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="1993" href="UTxO.Types.html#4026" class="Record">TxOutputRef</a>

<a id="2006" class="Keyword">open</a> <a id="2011" href="StateMachine.Base.html#1793" class="Module">StateMachine</a> <a id="2024" class="Keyword">public</a>

<a id="2032" class="Keyword">module</a> <a id="CEM"></a><a id="2039" href="StateMachine.Base.html#2039" class="Module">CEM</a>
  <a id="2045" class="Symbol">{</a><a id="2046" href="StateMachine.Base.html#2046" class="Bound">S</a> <a id="2048" href="StateMachine.Base.html#2048" class="Bound">I</a> <a id="2050" class="Symbol">:</a> <a id="2052" class="PrimitiveType">Set</a><a id="2055" class="Symbol">}</a> <a id="2057" class="Symbol">{{</a><a id="2059" href="StateMachine.Base.html#2059" class="Bound">_</a> <a id="2061" class="Symbol">:</a> <a id="2063" href="UTxO.Types.html#981" class="Record">IsData</a> <a id="2070" href="StateMachine.Base.html#2046" class="Bound">S</a><a id="2071" class="Symbol">}}</a> <a id="2074" class="Symbol">{{</a><a id="2076" href="StateMachine.Base.html#2076" class="Bound">_</a> <a id="2078" class="Symbol">:</a> <a id="2080" href="UTxO.Types.html#981" class="Record">IsData</a> <a id="2087" href="StateMachine.Base.html#2048" class="Bound">I</a><a id="2088" class="Symbol">}}</a> <a id="2091" class="Symbol">{</a><a id="2092" href="StateMachine.Base.html#2092" class="Bound">sm</a> <a id="2095" class="Symbol">:</a> <a id="2097" href="StateMachine.Base.html#1793" class="Record">StateMachine</a> <a id="2110" href="StateMachine.Base.html#2046" class="Bound">S</a> <a id="2112" href="StateMachine.Base.html#2048" class="Bound">I</a><a id="2113" class="Symbol">}</a>
  <a id="2117" class="Keyword">where</a>

  <a id="CEM.initₛₘ"></a><a id="2126" href="StateMachine.Base.html#2126" class="Function">initₛₘ</a>   <a id="2135" class="Symbol">=</a> <a id="2137" href="StateMachine.Base.html#1900" class="Field">isInitial</a> <a id="2147" href="StateMachine.Base.html#2092" class="Bound">sm</a>
  <a id="CEM.stepₛₘ"></a><a id="2152" href="StateMachine.Base.html#2152" class="Function">stepₛₘ</a>   <a id="2161" class="Symbol">=</a> <a id="2163" href="StateMachine.Base.html#1925" class="Field">step</a> <a id="2168" href="StateMachine.Base.html#2092" class="Bound">sm</a>
  <a id="CEM.originₛₘ"></a><a id="2173" href="StateMachine.Base.html#2173" class="Function">originₛₘ</a> <a id="2182" class="Symbol">=</a> <a id="2184" href="StateMachine.Base.html#1975" class="Field">origin</a> <a id="2191" href="StateMachine.Base.html#2092" class="Bound">sm</a>

  <a id="CEM.Init"></a><a id="2197" href="StateMachine.Base.html#2197" class="Function">Init</a> <a id="2202" class="Symbol">:</a> <a id="2204" href="Relation.Unary.html#1101" class="Function">Pred</a> <a id="2209" href="StateMachine.Base.html#2046" class="Bound">S</a> <a id="2211" href="Level.html#512" class="Function">0ℓ</a>
  <a id="2216" href="StateMachine.Base.html#2197" class="Function">Init</a> <a id="2221" class="Symbol">=</a> <a id="2223" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="2225" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2227" href="StateMachine.Base.html#2126" class="Function">initₛₘ</a>

  <a id="CEM.spentsOrigin"></a><a id="2237" href="StateMachine.Base.html#2237" class="Function">spentsOrigin</a> <a id="2250" class="Symbol">:</a> <a id="2252" href="UTxO.Types.html#4892" class="Record">TxInfo</a> <a id="2259" class="Symbol">→</a> <a id="2261" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
  <a id="2268" href="StateMachine.Base.html#2237" class="Function">spentsOrigin</a> <a id="2281" href="StateMachine.Base.html#2281" class="Bound">txi</a> <a id="2285" class="Symbol">=</a>
    <a id="2291" href="StateMachine.Base.html#2173" class="Function">originₛₘ</a> <a id="2300" href="StateMachine.Base.html#1294" class="Function Operator">&gt;&gt;=ₜ</a> <a id="2305" class="Symbol">λ</a> <a id="2307" href="StateMachine.Base.html#2307" class="Bound">o</a> <a id="2309" class="Symbol">→</a> <a id="2311" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="2313" href="StateMachine.Base.html#2307" class="Bound">o</a> <a id="2315" href="Data.List.Membership.DecSetoid.html#762" class="Function Operator">∈?</a> <a id="2318" href="Data.List.Base.html#1497" class="Function">map</a> <a id="2322" href="UTxO.Types.html#4493" class="Field">InputInfo.outputRef</a> <a id="2342" class="Symbol">(</a><a id="2343" href="UTxO.Types.html#4923" class="Field">TxInfo.inputInfo</a> <a id="2360" href="StateMachine.Base.html#2281" class="Bound">txi</a><a id="2363" class="Symbol">)</a> <a id="2365" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a>

  <a id="CEM.𝕍"></a><a id="2370" href="StateMachine.Base.html#2370" class="Function">𝕍</a> <a id="2372" class="Symbol">:</a> <a id="2374" href="UTxO.Hashing.Base.html#214" class="Function">HashId</a>

  <a id="CEM.policyₛₘ"></a><a id="2384" href="StateMachine.Base.html#2384" class="Function">policyₛₘ</a> <a id="2393" class="Symbol">:</a> <a id="2395" href="UTxO.Types.html#7000" class="Function">MonetaryPolicy</a>
  <a id="2412" href="StateMachine.Base.html#2384" class="Function">policyₛₘ</a> <a id="2421" href="StateMachine.Base.html#2421" class="Bound">pti</a><a id="2424" class="Symbol">@(</a><a id="2426" class="Keyword">record</a> <a id="2433" class="Symbol">{</a><a id="2434" href="UTxO.Types.html#5210" class="Field">this</a> <a id="2439" class="Symbol">=</a> <a id="2441" href="StateMachine.Base.html#2441" class="Bound">c</a><a id="2442" class="Symbol">;</a> <a id="2444" href="UTxO.Types.html#5190" class="Field">txInfo</a> <a id="2451" class="Symbol">=</a> <a id="2453" href="StateMachine.Base.html#2453" class="Bound">txi</a><a id="2456" class="Symbol">})</a>
    <a id="2463" class="Symbol">=</a> <a id="2465" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="2467" href="UTxO.Value.html#1959" class="Function">lookupQuantity</a> <a id="2482" class="Symbol">(</a><a id="2483" href="StateMachine.Base.html#2441" class="Bound">c</a> <a id="2485" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2487" href="StateMachine.Base.html#2790" class="Function">𝕋</a><a id="2488" class="Symbol">)</a> <a id="2490" class="Symbol">(</a><a id="2491" href="UTxO.Types.html#4994" class="Field">TxInfo.forge</a> <a id="2504" href="StateMachine.Base.html#2453" class="Bound">txi</a><a id="2507" class="Symbol">)</a> <a id="2509" href="Prelude.DecEq.html#590" class="Field Operator">≟</a> <a id="2511" class="Number">1</a> <a id="2513" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a>
    <a id="2519" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="2521" href="StateMachine.Base.html#2237" class="Function">spentsOrigin</a> <a id="2534" href="StateMachine.Base.html#2453" class="Bound">txi</a>
    <a id="2542" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="2544" class="Symbol">(</a><a id="2545" href="Function.Base.html#3544" class="Function Operator">case</a> <a id="2550" href="UTxO.Types.html#6478" class="Function">outputsOf</a> <a id="2560" class="Symbol">(</a><a id="2561" href="StateMachine.Base.html#2441" class="Bound">c</a> <a id="2563" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2565" href="StateMachine.Base.html#2790" class="Function">𝕋</a><a id="2566" class="Symbol">)</a> <a id="2568" href="StateMachine.Base.html#2421" class="Bound">pti</a> <a id="2572" href="Function.Base.html#3544" class="Function Operator">of</a> <a id="2575" class="Symbol">λ</a>
        <a id="2585" class="Symbol">{</a> <a id="2587" class="Symbol">(</a><a id="2588" class="Keyword">record</a> <a id="2595" class="Symbol">{</a><a id="2596" href="UTxO.Types.html#4728" class="Field">value</a> <a id="2602" class="Symbol">=</a> <a id="2604" href="StateMachine.Base.html#2604" class="Bound">v</a><a id="2605" class="Symbol">;</a> <a id="2607" href="UTxO.Types.html#4669" class="Field">address</a> <a id="2615" class="Symbol">=</a> <a id="2617" href="StateMachine.Base.html#2617" class="Bound">v♯</a><a id="2619" class="Symbol">;</a> <a id="2621" href="UTxO.Types.html#4750" class="Field">datumHash</a> <a id="2631" class="Symbol">=</a> <a id="2633" href="StateMachine.Base.html#2633" class="Bound">d♯</a><a id="2635" class="Symbol">}</a> <a id="2637" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2639" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2641" class="Symbol">)</a>
          <a id="2653" class="Symbol">→</a> <a id="2655" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="2657" href="StateMachine.Base.html#2617" class="Bound">v♯</a> <a id="2660" href="Prelude.DecEq.html#590" class="Field Operator">≟</a> <a id="2662" href="StateMachine.Base.html#2370" class="Function">𝕍</a> <a id="2664" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a>
          <a id="2676" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="2678" class="Symbol">(</a><a id="2679" href="Data.Maybe.Base.html#1651" class="Function">fromMaybe</a> <a id="2689" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="2695" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="2697" href="UTxO.Types.html#5454" class="Function">lookupDatumPtx</a> <a id="2712" href="StateMachine.Base.html#2633" class="Bound">d♯</a> <a id="2715" href="StateMachine.Base.html#2421" class="Bound">pti</a> <a id="2719" href="Category.Monad.Indexed.html#677" class="Field Operator">&gt;&gt;=</a> <a id="2723" href="UTxO.Types.html#1046" class="Field">fromData</a> <a id="2732" href="Category.Monad.Indexed.html#677" class="Field Operator">&gt;&gt;=</a> <a id="2736" href="Category.Applicative.Indexed.html#985" class="Function">pure</a> <a id="2741" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2743" href="StateMachine.Base.html#2126" class="Function">initₛₘ</a><a id="2749" class="Symbol">)</a>
        <a id="2759" class="Symbol">;</a> <a id="2761" class="CatchallClause Symbol">_</a> <a id="2763" class="Symbol">→</a> <a id="2765" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="2771" class="Symbol">})</a>
    <a id="2778" class="Keyword">where</a>
      <a id="2790" href="StateMachine.Base.html#2790" class="Function">𝕋</a> <a id="2792" class="Symbol">=</a> <a id="2794" href="Data.Maybe.Base.html#1651" class="Function">fromMaybe</a> <a id="2804" href="StateMachine.Base.html#2441" class="Bound">c</a> <a id="2806" class="Symbol">⦇</a> <a id="2808" href="StateMachine.Base.html#2173" class="Function">originₛₘ</a> <a id="2817" href="UTxO.Hashing.Types.html#326" class="Function Operator">♯ₒᵣ</a> <a id="2821" class="Symbol">⦈</a>

  <a id="CEM.ℂ"></a><a id="2826" href="StateMachine.Base.html#2826" class="Function">ℂ</a> <a id="2828" class="Symbol">:</a> <a id="2830" href="UTxO.Value.html#296" class="Function">CurrencySymbol</a>
  <a id="2847" href="StateMachine.Base.html#2826" class="Function">ℂ</a> <a id="2849" class="Symbol">=</a> <a id="2851" href="StateMachine.Base.html#2384" class="Function">policyₛₘ</a> <a id="2860" href="UTxO.Hashing.Base.html#1212" class="Postulate Operator">♯</a>

  <a id="CEM.𝕋"></a><a id="2865" href="StateMachine.Base.html#2865" class="Function">𝕋</a> <a id="2867" class="Symbol">:</a> <a id="2869" href="UTxO.Value.html#320" class="Function">TokenName</a>
  <a id="2881" href="StateMachine.Base.html#2865" class="Function">𝕋</a> <a id="2883" class="Symbol">=</a> <a id="2885" href="Data.Maybe.Base.html#1651" class="Function">fromMaybe</a> <a id="2895" href="StateMachine.Base.html#2826" class="Function">ℂ</a> <a id="2897" class="Symbol">⦇</a> <a id="2899" href="StateMachine.Base.html#2173" class="Function">originₛₘ</a> <a id="2908" href="UTxO.Hashing.Types.html#326" class="Function Operator">♯ₒᵣ</a> <a id="2912" class="Symbol">⦈</a>

  <a id="CEM.nftₛₘ"></a><a id="2917" href="StateMachine.Base.html#2917" class="Function">nftₛₘ</a> <a id="2923" class="Symbol">:</a> <a id="2925" href="UTxO.Value.html#364" class="Function">TokenClass</a>
  <a id="2938" href="StateMachine.Base.html#2917" class="Function">nftₛₘ</a> <a id="2944" class="Symbol">=</a> <a id="2946" href="StateMachine.Base.html#2826" class="Function">ℂ</a> <a id="2948" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2950" href="StateMachine.Base.html#2865" class="Function">𝕋</a>

  <a id="CEM.threadₛₘ"></a><a id="2955" href="StateMachine.Base.html#2955" class="Function">threadₛₘ</a> <a id="2964" class="Symbol">:</a> <a id="2966" href="UTxO.Value.html#825" class="Function">Value</a>
  <a id="2974" href="StateMachine.Base.html#2955" class="Function">threadₛₘ</a> <a id="2983" class="Symbol">=</a> <a id="2985" href="Data.List.Base.html#4458" class="Function Operator">[</a> <a id="2987" href="StateMachine.Base.html#2826" class="Function">ℂ</a> <a id="2989" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2991" href="Data.List.Base.html#4458" class="Function Operator">[</a> <a id="2993" href="StateMachine.Base.html#2865" class="Function">𝕋</a> <a id="2995" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2997" class="Number">1</a> <a id="2999" href="Data.List.Base.html#4458" class="Function Operator">]</a> <a id="3001" href="Data.List.Base.html#4458" class="Function Operator">]</a>

  <a id="CEM.validatorₛₘ"></a><a id="3006" href="StateMachine.Base.html#3006" class="Function">validatorₛₘ</a> <a id="3018" class="Symbol">:</a> <a id="3020" href="UTxO.Types.html#6772" class="Function">Validator</a>
  <a id="3032" href="StateMachine.Base.html#3006" class="Function">validatorₛₘ</a> <a id="3044" href="StateMachine.Base.html#3044" class="Bound">ptx</a> <a id="3048" href="StateMachine.Base.html#3048" class="Bound">di</a> <a id="3051" href="StateMachine.Base.html#3051" class="Bound">ds</a>
    <a id="3058" class="Symbol">=</a> <a id="3060" href="Data.Maybe.Base.html#1651" class="Function">fromMaybe</a> <a id="3070" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="3076" class="Keyword">do</a> <a id="3079" class="Symbol">(</a><a id="3080" href="StateMachine.Base.html#3080" class="Bound">s′</a> <a id="3083" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3085" href="StateMachine.Base.html#3085" class="Bound">tx≡</a><a id="3088" class="Symbol">)</a> <a id="3090" href="Category.Monad.Indexed.html#677" class="Field Operator">←</a> <a id="3092" href="Category.Monad.Indexed.html#1073" class="Function">join</a> <a id="3097" class="Symbol">⦇</a> <a id="3099" href="StateMachine.Base.html#2152" class="Function">stepₛₘ</a> <a id="3106" class="Symbol">(</a><a id="3107" href="UTxO.Types.html#1046" class="Field">fromData</a> <a id="3116" href="StateMachine.Base.html#3051" class="Bound">ds</a><a id="3118" class="Symbol">)</a> <a id="3120" class="Symbol">(</a><a id="3121" href="UTxO.Types.html#1046" class="Field">fromData</a> <a id="3130" href="StateMachine.Base.html#3048" class="Bound">di</a><a id="3132" class="Symbol">)</a> <a id="3134" class="Symbol">⦈</a>
                         <a id="3161" href="Category.Applicative.Indexed.html#985" class="Function">pure</a> <a id="3166" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="3168" href="StateMachine.Base.html#3324" class="Function">outputsOK</a> <a id="3178" href="StateMachine.Base.html#3080" class="Bound">s′</a>
                              <a id="3211" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="3213" href="StateMachine.Base.html#1391" class="Function">verifyTxInfo</a> <a id="3226" class="Symbol">(</a><a id="3227" href="UTxO.Types.html#5190" class="Field">txInfo</a> <a id="3234" href="StateMachine.Base.html#3044" class="Bound">ptx</a><a id="3237" class="Symbol">)</a> <a id="3239" href="StateMachine.Base.html#3085" class="Bound">tx≡</a>
                              <a id="3273" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="3275" href="UTxO.Types.html#6316" class="Function">propagates</a> <a id="3286" href="StateMachine.Base.html#2955" class="Function">threadₛₘ</a> <a id="3295" href="StateMachine.Base.html#3044" class="Bound">ptx</a>
    <a id="3303" class="Keyword">module</a> <a id="3310" href="StateMachine.Base.html#3310" class="Module">_</a> <a id="3312" class="Keyword">where</a>
      <a id="3324" href="StateMachine.Base.html#3324" class="Function">outputsOK</a> <a id="3334" class="Symbol">:</a> <a id="3336" href="StateMachine.Base.html#2046" class="Bound">S</a> <a id="3338" class="Symbol">→</a> <a id="3340" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
      <a id="3351" href="StateMachine.Base.html#3324" class="Function">outputsOK</a> <a id="3361" href="StateMachine.Base.html#3361" class="Bound">st</a> <a id="3364" class="Symbol">=</a> <a id="3366" href="Function.Base.html#3544" class="Function Operator">case</a> <a id="3371" href="UTxO.Types.html#6027" class="Function">getContinuingOutputs</a> <a id="3392" href="StateMachine.Base.html#3044" class="Bound">ptx</a> <a id="3396" href="Function.Base.html#3544" class="Function Operator">of</a> <a id="3399" class="Symbol">λ</a>
        <a id="3409" class="Symbol">{</a> <a id="3411" class="Symbol">(</a><a id="3412" href="StateMachine.Base.html#3412" class="Bound">o</a> <a id="3414" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3416" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="3418" class="Symbol">)</a> <a id="3420" class="Symbol">→</a> <a id="3422" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="3424" href="UTxO.Types.html#4750" class="Field">datumHash</a> <a id="3434" href="StateMachine.Base.html#3412" class="Bound">o</a> <a id="3436" href="Prelude.DecEq.html#590" class="Field Operator">≟</a> <a id="3438" href="UTxO.Types.html#1022" class="Field">toData</a> <a id="3445" href="StateMachine.Base.html#3361" class="Bound">st</a> <a id="3448" href="UTxO.Hashing.Types.html#592" class="Function Operator">♯ᵈ</a> <a id="3451" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a>
        <a id="3461" class="Symbol">;</a> <a id="3463" class="CatchallClause Symbol">_</a>        <a id="3472" class="Symbol">→</a> <a id="3474" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="3480" class="Symbol">}</a>

  <a id="3485" href="StateMachine.Base.html#2370" class="Function">𝕍</a> <a id="3487" class="Symbol">=</a> <a id="3489" href="StateMachine.Base.html#3006" class="Function">validatorₛₘ</a> <a id="3501" href="UTxO.Hashing.Base.html#1212" class="Postulate Operator">♯</a>

  <a id="3506" class="Comment">-- Create a transaction input.</a>
  <a id="3539" class="Keyword">infix</a> <a id="3545" class="Number">5</a> <a id="3547" href="StateMachine.Base.html#3554" class="Function Operator">_←—_</a>
  <a id="CEM._←—_"></a><a id="3554" href="StateMachine.Base.html#3554" class="Function Operator">_←—_</a> <a id="3559" class="Symbol">:</a> <a id="3561" href="UTxO.Types.html#4026" class="Record">TxOutputRef</a> <a id="3573" class="Symbol">→</a> <a id="3575" href="StateMachine.Base.html#2048" class="Bound">I</a> <a id="3577" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3579" href="StateMachine.Base.html#2046" class="Bound">S</a> <a id="3581" class="Symbol">→</a> <a id="3583" href="UTxO.Types.html#7236" class="Record">TxInput</a>
  <a id="3593" href="UTxO.Types.html#7268" class="Field">outputRef</a> <a id="3603" class="Symbol">(</a><a id="3604" href="StateMachine.Base.html#3604" class="Bound">r</a> <a id="3606" href="StateMachine.Base.html#3554" class="Function Operator">←—</a> <a id="3609" class="Symbol">_</a>      <a id="3616" class="Symbol">)</a> <a id="3618" class="Symbol">=</a> <a id="3620" href="StateMachine.Base.html#3604" class="Bound">r</a>
  <a id="3624" href="UTxO.Types.html#7322" class="Field">redeemer</a>  <a id="3634" class="Symbol">(_</a> <a id="3637" href="StateMachine.Base.html#3554" class="Function Operator">←—</a> <a id="3640" class="Symbol">(</a><a id="3641" href="StateMachine.Base.html#3641" class="Bound">i</a> <a id="3643" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3645" class="Symbol">_))</a> <a id="3649" class="Symbol">=</a> <a id="3651" href="UTxO.Types.html#1022" class="Field">toData</a> <a id="3658" href="StateMachine.Base.html#3641" class="Bound">i</a>
  <a id="3662" href="UTxO.Types.html#7296" class="Field">validator</a> <a id="3672" class="Symbol">(_</a> <a id="3675" href="StateMachine.Base.html#3554" class="Function Operator">←—</a> <a id="3678" class="Symbol">_</a>      <a id="3685" class="Symbol">)</a> <a id="3687" class="Symbol">=</a> <a id="3689" href="StateMachine.Base.html#3006" class="Function">validatorₛₘ</a>
  <a id="3703" href="UTxO.Types.html#7343" class="Field">datum</a>     <a id="3713" class="Symbol">(_</a> <a id="3716" href="StateMachine.Base.html#3554" class="Function Operator">←—</a> <a id="3719" class="Symbol">(_</a> <a id="3722" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3724" href="StateMachine.Base.html#3724" class="Bound">d</a><a id="3725" class="Symbol">))</a> <a id="3728" class="Symbol">=</a> <a id="3730" href="UTxO.Types.html#1022" class="Field">toData</a> <a id="3737" href="StateMachine.Base.html#3724" class="Bound">d</a>

  <a id="3742" class="Comment">-- Create a transaction output.</a>
  <a id="3776" class="Keyword">infix</a> <a id="3782" class="Number">5</a> <a id="3784" href="StateMachine.Base.html#3791" class="Function Operator">_—→_</a>
  <a id="CEM._—→_"></a><a id="3791" href="StateMachine.Base.html#3791" class="Function Operator">_—→_</a> <a id="3796" class="Symbol">:</a> <a id="3798" href="StateMachine.Base.html#2046" class="Bound">S</a> <a id="3800" class="Symbol">→</a> <a id="3802" href="UTxO.Value.html#825" class="Function">Value</a> <a id="3808" class="Symbol">→</a> <a id="3810" href="UTxO.Types.html#4636" class="Record">TxOutput</a>
  <a id="3821" href="UTxO.Types.html#4728" class="Field">value</a>     <a id="3831" class="Symbol">(_</a> <a id="3834" href="StateMachine.Base.html#3791" class="Function Operator">—→</a> <a id="3837" href="StateMachine.Base.html#3837" class="Bound">v</a><a id="3838" class="Symbol">)</a> <a id="3840" class="Symbol">=</a> <a id="3842" href="StateMachine.Base.html#3837" class="Bound">v</a>
  <a id="3846" href="UTxO.Types.html#4669" class="Field">address</a>   <a id="3856" class="Symbol">(_</a> <a id="3859" href="StateMachine.Base.html#3791" class="Function Operator">—→</a> <a id="3862" class="Symbol">_)</a> <a id="3865" class="Symbol">=</a> <a id="3867" href="StateMachine.Base.html#2370" class="Function">𝕍</a>
  <a id="3871" href="UTxO.Types.html#4750" class="Field">datumHash</a> <a id="3881" class="Symbol">(</a><a id="3882" href="StateMachine.Base.html#3882" class="Bound">d</a> <a id="3884" href="StateMachine.Base.html#3791" class="Function Operator">—→</a> <a id="3887" class="Symbol">_)</a> <a id="3890" class="Symbol">=</a> <a id="3892" href="UTxO.Types.html#1022" class="Field">toData</a> <a id="3899" href="StateMachine.Base.html#3882" class="Bound">d</a> <a id="3901" href="UTxO.Hashing.Types.html#592" class="Function Operator">♯ᵈ</a>

  <a id="CEM.withOutputs"></a><a id="3907" href="StateMachine.Base.html#3907" class="Function">withOutputs</a> <a id="3919" class="Symbol">:</a> <a id="3921" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3926" href="StateMachine.Base.html#2046" class="Bound">S</a> <a id="3928" class="Symbol">→</a> <a id="3930" href="UTxO.Types.html#7388" class="Record">Tx</a>
  <a id="3935" href="StateMachine.Base.html#3907" class="Function">withOutputs</a> <a id="3947" href="StateMachine.Base.html#3947" class="Bound">ss</a> <a id="3950" class="Symbol">=</a> <a id="3952" class="Keyword">record</a> <a id="3959" href="Prelude.Default.html#736" class="Field">def</a>
    <a id="3967" class="Symbol">{</a> <a id="3969" href="UTxO.Types.html#7520" class="Field">outputs</a>        <a id="3984" class="Symbol">=</a> <a id="3986" href="Data.List.Base.html#1497" class="Function">map</a> <a id="3990" class="Symbol">(</a><a id="3991" href="StateMachine.Base.html#3791" class="Function Operator">_—→</a> <a id="3995" href="StateMachine.Base.html#2955" class="Function">threadₛₘ</a><a id="4003" class="Symbol">)</a> <a id="4005" href="StateMachine.Base.html#3947" class="Bound">ss</a>
    <a id="4012" class="Symbol">;</a> <a id="4014" href="UTxO.Types.html#7654" class="Field">datumWitnesses</a> <a id="4029" class="Symbol">=</a> <a id="4031" href="Data.List.Base.html#1497" class="Function">map</a> <a id="4035" class="Symbol">(λ</a> <a id="4038" href="StateMachine.Base.html#4038" class="Bound">s</a> <a id="4040" class="Symbol">→</a> <a id="4042" href="UTxO.Types.html#1022" class="Field">toData</a> <a id="4049" href="StateMachine.Base.html#4038" class="Bound">s</a> <a id="4051" href="UTxO.Hashing.Types.html#592" class="Function Operator">♯ᵈ</a> <a id="4054" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4056" href="UTxO.Types.html#1022" class="Field">toData</a> <a id="4063" href="StateMachine.Base.html#4038" class="Bound">s</a><a id="4064" class="Symbol">)</a> <a id="4066" href="StateMachine.Base.html#3947" class="Bound">ss</a> <a id="4069" class="Symbol">}</a>

  <a id="4074" class="Comment">-- Lemmas</a>
  <a id="4086" class="Keyword">open</a> <a id="4091" href="UTxO.Value.html#5762" class="Module">FocusTokenClass</a> <a id="4107" href="StateMachine.Base.html#2917" class="Function">nftₛₘ</a>

  <a id="CEM.fromMaybe≡"></a><a id="4116" href="StateMachine.Base.html#4116" class="Function">fromMaybe≡</a> <a id="4127" class="Symbol">:</a> <a id="4129" class="Symbol">{</a><a id="4130" href="StateMachine.Base.html#4130" class="Bound">A</a> <a id="4132" href="StateMachine.Base.html#4132" class="Bound">B</a> <a id="4134" class="Symbol">:</a> <a id="4136" class="PrimitiveType">Set</a><a id="4139" class="Symbol">}</a> <a id="4141" class="Symbol">{</a><a id="4142" href="StateMachine.Base.html#4142" class="Bound">mx</a> <a id="4145" class="Symbol">:</a> <a id="4147" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="4153" href="StateMachine.Base.html#4130" class="Bound">A</a><a id="4154" class="Symbol">}</a> <a id="4156" class="Symbol">{</a><a id="4157" href="StateMachine.Base.html#4157" class="Bound">f</a> <a id="4159" class="Symbol">:</a> <a id="4161" href="StateMachine.Base.html#4130" class="Bound">A</a> <a id="4163" class="Symbol">→</a> <a id="4165" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="4171" href="StateMachine.Base.html#4132" class="Bound">B</a><a id="4172" class="Symbol">}</a> <a id="4174" class="Symbol">{</a><a id="4175" href="StateMachine.Base.html#4175" class="Bound">g</a> <a id="4177" class="Symbol">:</a> <a id="4179" href="StateMachine.Base.html#4132" class="Bound">B</a> <a id="4181" class="Symbol">→</a> <a id="4183" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="4187" class="Symbol">}</a>
    <a id="4193" class="Symbol">→</a> <a id="4195" href="Data.Maybe.Base.html#1651" class="Function">fromMaybe</a> <a id="4205" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="4211" class="Symbol">(</a><a id="4212" href="StateMachine.Base.html#4142" class="Bound">mx</a> <a id="4215" href="Category.Monad.Indexed.html#677" class="Field Operator">&gt;&gt;=</a> <a id="4219" href="StateMachine.Base.html#4157" class="Bound">f</a> <a id="4221" href="Category.Monad.Indexed.html#677" class="Field Operator">&gt;&gt;=</a> <a id="4225" href="Category.Applicative.Indexed.html#985" class="Function">pure</a> <a id="4230" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="4232" href="StateMachine.Base.html#4175" class="Bound">g</a><a id="4233" class="Symbol">)</a> <a id="4235" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4237" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
    <a id="4246" class="Symbol">→</a> <a id="4248" href="Data.Product.html#1369" class="Function">∃</a> <a id="4250" class="Symbol">λ</a> <a id="4252" href="StateMachine.Base.html#4252" class="Bound">y</a> <a id="4254" class="Symbol">→</a>
          <a id="4266" class="Symbol">((</a><a id="4268" href="StateMachine.Base.html#4142" class="Bound">mx</a> <a id="4271" href="Category.Monad.Indexed.html#677" class="Field Operator">&gt;&gt;=</a> <a id="4275" href="StateMachine.Base.html#4157" class="Bound">f</a><a id="4276" class="Symbol">)</a> <a id="4278" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4280" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="4285" href="StateMachine.Base.html#4252" class="Bound">y</a><a id="4286" class="Symbol">)</a>
        <a id="4296" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4298" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="4300" class="Symbol">(</a><a id="4301" href="StateMachine.Base.html#4175" class="Bound">g</a> <a id="4303" href="StateMachine.Base.html#4252" class="Bound">y</a><a id="4304" class="Symbol">)</a>
  <a id="4308" href="StateMachine.Base.html#4116" class="Function">fromMaybe≡</a> <a id="4319" class="Symbol">{</a><a id="4320" class="Argument">mx</a> <a id="4323" class="Symbol">=</a> <a id="4325" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="4330" href="StateMachine.Base.html#4330" class="Bound">x</a><a id="4331" class="Symbol">}{</a><a id="4333" href="StateMachine.Base.html#4333" class="Bound">f</a><a id="4334" class="Symbol">}{</a><a id="4336" href="StateMachine.Base.html#4336" class="Bound">g</a><a id="4337" class="Symbol">}</a> <a id="4339" href="StateMachine.Base.html#4339" class="Bound">p</a>
    <a id="4345" class="Keyword">with</a> <a id="4350" href="StateMachine.Base.html#4333" class="Bound">f</a> <a id="4352" href="StateMachine.Base.html#4330" class="Bound">x</a> <a id="4354" class="Symbol">|</a> <a id="4356" href="Relation.Binary.PropositionalEquality.html#3845" class="Function">inspect</a> <a id="4364" href="StateMachine.Base.html#4333" class="Bound">f</a> <a id="4366" href="StateMachine.Base.html#4330" class="Bound">x</a>
  <a id="4370" class="Symbol">...</a> <a id="4374" class="Symbol">|</a> <a id="4376" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="4381" href="StateMachine.Base.html#4381" class="Bound">y</a> <a id="4383" class="Symbol">|</a> <a id="4385" href="Relation.Binary.PropositionalEquality.html#3819" class="InductiveConstructor Operator">≡[</a> <a id="4388" href="StateMachine.Base.html#4388" class="Bound">f≡</a> <a id="4391" href="Relation.Binary.PropositionalEquality.html#3819" class="InductiveConstructor Operator">]</a>
    <a id="4397" class="Keyword">with</a> <a id="4402" class="Bound">g</a> <a id="4404" href="StateMachine.Base.html#4381" class="Bound">y</a> <a id="4406" class="Symbol">|</a> <a id="4408" href="Relation.Binary.PropositionalEquality.html#3845" class="Function">inspect</a> <a id="4416" class="Bound">g</a> <a id="4418" href="StateMachine.Base.html#4381" class="Bound">y</a>
  <a id="4422" class="Symbol">...</a> <a id="4426" class="Symbol">|</a> <a id="4428" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="4433" class="Symbol">|</a> <a id="4435" href="Relation.Binary.PropositionalEquality.html#3819" class="InductiveConstructor Operator">≡[</a> <a id="4438" href="StateMachine.Base.html#4438" class="Bound">g≡</a> <a id="4441" href="Relation.Binary.PropositionalEquality.html#3819" class="InductiveConstructor Operator">]</a>
       <a id="4450" class="Symbol">=</a> <a id="4452" class="Bound">y</a> <a id="4454" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4456" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="4461" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4463" href="Prelude.General.html#511" class="Function">true⇒T</a> <a id="4470" href="StateMachine.Base.html#4438" class="Bound">g≡</a>

  <a id="CEM.Tpolicy⇒"></a><a id="4476" href="StateMachine.Base.html#4476" class="Function">Tpolicy⇒</a> <a id="4485" class="Symbol">:</a> <a id="4487" class="Symbol">∀</a> <a id="4489" class="Symbol">{</a><a id="4490" href="StateMachine.Base.html#4490" class="Bound">tx</a> <a id="4493" href="StateMachine.Base.html#4493" class="Bound">l</a> <a id="4495" href="StateMachine.Base.html#4495" class="Bound">pti</a><a id="4498" class="Symbol">}</a>
    <a id="4504" class="Symbol">→</a> <a id="4506" href="UTxO.Types.html#5210" class="Field">this</a> <a id="4511" href="StateMachine.Base.html#4495" class="Bound">pti</a> <a id="4515" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4517" href="StateMachine.Base.html#2826" class="Function">ℂ</a>
    <a id="4523" class="Symbol">→</a> <a id="4525" href="UTxO.Types.html#5190" class="Field">txInfo</a> <a id="4532" href="StateMachine.Base.html#4495" class="Bound">pti</a> <a id="4536" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4538" href="UTxO.TxUtilities.html#5851" class="Function">mkTxInfo</a> <a id="4547" href="StateMachine.Base.html#4493" class="Bound">l</a> <a id="4549" href="StateMachine.Base.html#4490" class="Bound">tx</a>
    <a id="4556" class="Symbol">→</a> <a id="4558" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="4560" class="Symbol">(</a><a id="4561" href="StateMachine.Base.html#2384" class="Function">policyₛₘ</a> <a id="4570" href="StateMachine.Base.html#4495" class="Bound">pti</a><a id="4573" class="Symbol">)</a>
    <a id="4579" class="Symbol">→</a> <a id="4581" href="Data.Product.html#1369" class="Function">∃</a> <a id="4583" class="Symbol">λ</a> <a id="4585" href="StateMachine.Base.html#4585" class="Bound">v</a> <a id="4587" class="Symbol">→</a> <a id="4589" href="Data.Product.html#1369" class="Function">∃</a> <a id="4591" class="Symbol">λ</a> <a id="4593" href="StateMachine.Base.html#4593" class="Bound">s</a> <a id="4595" class="Symbol">→</a>
          <a id="4607" class="Symbol">(</a><a id="4608" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="4614" href="StateMachine.Base.html#4490" class="Bound">tx</a> <a id="4617" href="UTxO.Value.html#5805" class="Function Operator">◆</a> <a id="4619" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4621" class="Number">1</a><a id="4622" class="Symbol">)</a>
        <a id="4632" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4634" href="UTxO.Types.html#6478" class="Function">outputsOf</a> <a id="4644" href="StateMachine.Base.html#2917" class="Function">nftₛₘ</a> <a id="4650" href="StateMachine.Base.html#4495" class="Bound">pti</a> <a id="4654" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="4656" href="Data.List.Base.html#4458" class="Function Operator">[</a> <a id="4658" class="Keyword">record</a> <a id="4665" class="Symbol">{</a><a id="4666" href="UTxO.Types.html#4728" class="Field">value</a> <a id="4672" class="Symbol">=</a> <a id="4674" href="StateMachine.Base.html#4585" class="Bound">v</a><a id="4675" class="Symbol">;</a> <a id="4677" href="UTxO.Types.html#4669" class="Field">address</a> <a id="4685" class="Symbol">=</a> <a id="4687" href="StateMachine.Base.html#2370" class="Function">𝕍</a><a id="4688" class="Symbol">;</a> <a id="4690" href="UTxO.Types.html#4750" class="Field">datumHash</a> <a id="4700" class="Symbol">=</a> <a id="4702" href="UTxO.Types.html#1022" class="Field">toData</a> <a id="4709" href="StateMachine.Base.html#4593" class="Bound">s</a> <a id="4711" href="UTxO.Hashing.Types.html#592" class="Function Operator">♯ᵈ</a><a id="4713" class="Symbol">}</a> <a id="4715" href="Data.List.Base.html#4458" class="Function Operator">]</a>
        <a id="4725" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4727" href="StateMachine.Base.html#2197" class="Function">Init</a> <a id="4732" href="StateMachine.Base.html#4593" class="Bound">s</a>
  <a id="4736" href="StateMachine.Base.html#4476" class="Function">Tpolicy⇒</a> <a id="4745" class="Symbol">{</a><a id="4746" class="Argument">tx</a> <a id="4749" class="Symbol">=</a> <a id="4751" href="StateMachine.Base.html#4751" class="Bound">tx</a><a id="4753" class="Symbol">}{</a><a id="4755" href="StateMachine.Base.html#4755" class="Bound">l</a><a id="4756" class="Symbol">}{</a><a id="4758" href="StateMachine.Base.html#4758" class="Bound">pti</a><a id="4761" class="Symbol">@(</a><a id="4763" class="Keyword">record</a> <a id="4770" class="Symbol">{</a><a id="4771" href="UTxO.Types.html#5210" class="Field">this</a> <a id="4776" class="Symbol">=</a> <a id="4778" class="DottedPattern Symbol">.</a><a id="4779" href="StateMachine.Base.html#2826" class="DottedPattern Function">ℂ</a><a id="4780" class="Symbol">;</a> <a id="4782" href="UTxO.Types.html#5190" class="Field">txInfo</a> <a id="4789" class="Symbol">=</a> <a id="4791" href="StateMachine.Base.html#4791" class="Bound">txi</a><a id="4794" class="Symbol">})}</a> <a id="4798" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="4803" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="4808" href="StateMachine.Base.html#4808" class="Bound">h₀</a>
    <a id="4815" class="Keyword">with</a> <a id="4820" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="4826" href="StateMachine.Base.html#4751" class="Bound">tx</a> <a id="4829" href="UTxO.Value.html#5805" class="Function Operator">◆</a> <a id="4831" href="Prelude.DecEq.html#590" class="Field Operator">≟</a> <a id="4833" class="Number">1</a> <a id="4835" class="Symbol">|</a> <a id="4837" href="StateMachine.Base.html#4808" class="Bound">h₀</a>
  <a id="4842" class="Symbol">...</a> <a id="4846" class="Symbol">|</a> <a id="4848" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a>  <a id="4852" class="Symbol">_</a>    <a id="4857" class="Symbol">|</a> <a id="4859" class="Symbol">()</a>
  <a id="4864" class="Symbol">...</a> <a id="4868" class="Symbol">|</a> <a id="4870" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="4874" href="StateMachine.Base.html#4874" class="Bound">frg≡</a> <a id="4879" class="Symbol">|</a> <a id="4881" href="StateMachine.Base.html#4881" class="Bound">h₁</a>
    <a id="4888" class="Keyword">with</a> <a id="4893" href="StateMachine.Base.html#2237" class="Function">spentsOrigin</a> <a id="4906" class="Bound">txi</a> <a id="4910" class="Symbol">|</a> <a id="4912" href="StateMachine.Base.html#4881" class="Bound">h₁</a>
  <a id="4917" class="Symbol">...</a> <a id="4921" class="Symbol">|</a> <a id="4923" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="4929" class="Symbol">|</a> <a id="4931" class="Symbol">()</a>
  <a id="4936" class="Symbol">...</a> <a id="4940" class="Symbol">|</a> <a id="4942" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>  <a id="4948" class="Symbol">|</a> <a id="4950" href="StateMachine.Base.html#4950" class="Bound">h₂</a>
    <a id="4957" class="Keyword">with</a> <a id="4962" href="UTxO.Types.html#6478" class="Function">outputsOf</a> <a id="4972" href="StateMachine.Base.html#2917" class="Function">nftₛₘ</a> <a id="4978" class="Bound">pti</a> <a id="4982" class="Symbol">|</a> <a id="4984" href="StateMachine.Base.html#4950" class="Bound">h₂</a>
  <a id="4989" class="Symbol">...</a> <a id="4993" class="Symbol">|</a> <a id="4995" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="4998" class="Symbol">|</a> <a id="5000" class="Symbol">()</a>
  <a id="5005" class="Symbol">...</a> <a id="5009" class="Symbol">|</a> <a id="5011" class="Symbol">_</a> <a id="5013" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5015" class="Symbol">_</a> <a id="5017" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5019" class="Symbol">_</a> <a id="5021" class="Symbol">|</a> <a id="5023" class="Symbol">()</a>
  <a id="5028" class="Symbol">...</a> <a id="5032" class="Symbol">|</a> <a id="5034" class="Keyword">record</a> <a id="5041" class="Symbol">{</a><a id="5042" href="UTxO.Types.html#4728" class="Field">value</a> <a id="5048" class="Symbol">=</a> <a id="5050" href="StateMachine.Base.html#5050" class="Bound">v</a><a id="5051" class="Symbol">;</a> <a id="5053" href="UTxO.Types.html#4669" class="Field">address</a> <a id="5061" class="Symbol">=</a> <a id="5063" href="StateMachine.Base.html#5063" class="Bound">v♯</a><a id="5065" class="Symbol">;</a> <a id="5067" href="UTxO.Types.html#4750" class="Field">datumHash</a> <a id="5077" class="Symbol">=</a> <a id="5079" href="StateMachine.Base.html#5079" class="Bound">d♯</a><a id="5081" class="Symbol">}</a> <a id="5083" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5085" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="5088" class="Symbol">|</a> <a id="5090" href="StateMachine.Base.html#5090" class="Bound">h₃</a>
    <a id="5097" class="Keyword">with</a> <a id="5102" href="StateMachine.Base.html#5063" class="Bound">v♯</a> <a id="5105" href="Prelude.DecEq.html#590" class="Field Operator">≟</a> <a id="5107" href="StateMachine.Base.html#2370" class="Function">𝕍</a> <a id="5109" class="Symbol">|</a> <a id="5111" href="StateMachine.Base.html#5090" class="Bound">h₃</a>
  <a id="5116" class="Symbol">...</a> <a id="5120" class="Symbol">|</a> <a id="5122" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a>  <a id="5126" class="Symbol">_</a>    <a id="5131" class="Symbol">|</a> <a id="5133" class="Symbol">()</a>
  <a id="5138" class="Symbol">...</a> <a id="5142" class="Symbol">|</a> <a id="5144" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="5148" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="5153" class="Symbol">|</a> <a id="5155" href="StateMachine.Base.html#5155" class="Bound">h₄</a>
    <a id="5162" class="Keyword">with</a> <a id="5167" href="Data.Maybe.Base.html#1651" class="Function">fromMaybe</a> <a id="5177" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="5183" class="Symbol">(</a><a id="5184" href="UTxO.Types.html#5454" class="Function">lookupDatumPtx</a> <a id="5199" class="Bound">d♯</a> <a id="5202" class="Bound">pti</a> <a id="5206" href="Category.Monad.Indexed.html#677" class="Field Operator">&gt;&gt;=</a> <a id="5210" href="UTxO.Types.html#1046" class="Field">fromData</a> <a id="5219" href="Category.Monad.Indexed.html#677" class="Field Operator">&gt;&gt;=</a> <a id="5223" href="Category.Applicative.Indexed.html#985" class="Function">pure</a> <a id="5228" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5230" href="StateMachine.Base.html#2126" class="Function">initₛₘ</a><a id="5236" class="Symbol">)</a>
       <a id="5245" class="Symbol">|</a> <a id="5247" href="Relation.Binary.PropositionalEquality.html#3845" class="Function">inspect</a> <a id="5255" class="Symbol">(</a><a id="5256" href="Data.Maybe.Base.html#1651" class="Function">fromMaybe</a> <a id="5266" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="5271" class="Symbol">)</a> <a id="5273" class="Symbol">(</a><a id="5274" href="UTxO.Types.html#5454" class="Function">lookupDatumPtx</a> <a id="5289" class="Bound">d♯</a> <a id="5292" class="Bound">pti</a> <a id="5296" href="Category.Monad.Indexed.html#677" class="Field Operator">&gt;&gt;=</a> <a id="5300" href="UTxO.Types.html#1046" class="Field">fromData</a> <a id="5309" href="Category.Monad.Indexed.html#677" class="Field Operator">&gt;&gt;=</a> <a id="5313" href="Category.Applicative.Indexed.html#985" class="Function">pure</a> <a id="5318" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5320" href="StateMachine.Base.html#2126" class="Function">initₛₘ</a><a id="5326" class="Symbol">)</a>
       <a id="5335" class="Symbol">|</a> <a id="5337" href="StateMachine.Base.html#5155" class="Bound">h₄</a>
  <a id="5342" class="Symbol">...</a> <a id="5346" class="Symbol">|</a> <a id="5348" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="5354" class="Symbol">|</a> <a id="5356" class="Symbol">_</a>        <a id="5365" class="Symbol">|</a> <a id="5367" class="Symbol">()</a>
  <a id="5372" class="Symbol">...</a> <a id="5376" class="Symbol">|</a> <a id="5378" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>  <a id="5384" class="Symbol">|</a> <a id="5386" href="Relation.Binary.PropositionalEquality.html#3819" class="InductiveConstructor Operator">≡[</a> <a id="5389" href="StateMachine.Base.html#5389" class="Bound">fm≡</a> <a id="5393" href="Relation.Binary.PropositionalEquality.html#3819" class="InductiveConstructor Operator">]</a> <a id="5395" class="Symbol">|</a> <a id="5397" class="Symbol">_</a>
    <a id="5403" class="Keyword">with</a> <a id="5408" href="StateMachine.Base.html#5408" class="Bound">s</a> <a id="5410" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5412" href="StateMachine.Base.html#5412" class="Bound">fm≡′</a> <a id="5417" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5419" href="StateMachine.Base.html#5419" class="Bound">Tinit</a> ← <a id="5427" href="StateMachine.Base.html#4116" class="Function">fromMaybe≡</a> <a id="5438" class="Symbol">{</a><a id="5439" class="Argument">mx</a> <a id="5442" class="Symbol">=</a> <a id="5444" href="UTxO.Types.html#5454" class="Function">lookupDatumPtx</a> <a id="5459" class="Bound">d♯</a> <a id="5462" class="Bound">pti</a><a id="5465" class="Symbol">}{</a><a id="5467" href="UTxO.Types.html#1046" class="Field">fromData</a><a id="5475" class="Symbol">}{</a><a id="5477" href="StateMachine.Base.html#2126" class="Function">initₛₘ</a><a id="5483" class="Symbol">}</a> <a id="5485" href="StateMachine.Base.html#5389" class="Bound">fm≡</a>
      <a id="5495" class="Symbol">=</a> <a id="5497" class="Bound">v</a> <a id="5499" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5501" href="StateMachine.Base.html#5408" class="Bound">s</a> <a id="5503" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5505" class="Bound">frg≡</a>
      <a id="5516" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5518" href="Relation.Binary.PropositionalEquality.Core.html#1131" class="Function">cong</a> <a id="5523" class="Symbol">(λ</a> <a id="5526" href="StateMachine.Base.html#5526" class="Bound">x</a> <a id="5528" class="Symbol">→</a> <a id="5530" href="Data.List.Base.html#4458" class="Function Operator">[</a> <a id="5532" class="Keyword">record</a> <a id="5539" class="Symbol">{</a><a id="5540" href="UTxO.Types.html#4728" class="Field">value</a> <a id="5546" class="Symbol">=</a> <a id="5548" class="Bound">v</a><a id="5549" class="Symbol">;</a> <a id="5551" href="UTxO.Types.html#4669" class="Field">address</a> <a id="5559" class="Symbol">=</a> <a id="5561" class="Bound">v♯</a><a id="5563" class="Symbol">;</a> <a id="5565" href="UTxO.Types.html#4750" class="Field">datumHash</a> <a id="5575" class="Symbol">=</a> <a id="5577" href="StateMachine.Base.html#5526" class="Bound">x</a><a id="5578" class="Symbol">}</a> <a id="5580" href="Data.List.Base.html#4458" class="Function Operator">]</a><a id="5581" class="Symbol">)</a>
             <a id="5596" class="Symbol">(</a><a id="5597" href="UTxO.TxUtilities.html#8045" class="Function">lookupDatum≡</a> <a id="5610" class="Symbol">{</a><a id="5611" class="Argument">x</a> <a id="5613" class="Symbol">=</a> <a id="5615" href="StateMachine.Base.html#5408" class="Bound">s</a><a id="5616" class="Symbol">}{</a><a id="5618" class="Bound">d♯</a><a id="5620" class="Symbol">}{</a><a id="5622" class="Bound">txi</a><a id="5625" class="Symbol">}{</a><a id="5627" href="UTxO.Types.html#5093" class="Field">TxInfo.datumWitnesses</a> <a id="5649" class="Bound">txi</a><a id="5652" class="Symbol">}</a> <a id="5654" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="5659" href="StateMachine.Base.html#5412" class="Bound">fm≡′</a><a id="5663" class="Symbol">)</a>
      <a id="5671" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5673" href="StateMachine.Base.html#5419" class="Bound">Tinit</a>

  <a id="CEM.◆∈⇒Tpolicy"></a><a id="5682" href="StateMachine.Base.html#5682" class="Function">◆∈⇒Tpolicy</a> <a id="5693" class="Symbol">:</a> <a id="5695" class="Symbol">∀</a> <a id="5697" class="Symbol">{</a><a id="5698" href="StateMachine.Base.html#5698" class="Bound">tx</a> <a id="5701" href="StateMachine.Base.html#5701" class="Bound">l</a><a id="5702" class="Symbol">}</a>
    <a id="5708" class="Symbol">→</a> <a id="5710" href="UTxO.Validity.html#1184" class="Record">IsValidTx</a> <a id="5720" href="StateMachine.Base.html#5698" class="Bound">tx</a> <a id="5723" href="StateMachine.Base.html#5701" class="Bound">l</a>
    <a id="5729" class="Symbol">→</a> <a id="5731" href="UTxO.Value.html#5879" class="Function Operator">◆∈</a> <a id="5734" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="5740" href="StateMachine.Base.html#5698" class="Bound">tx</a>
    <a id="5747" class="Symbol">→</a> <a id="5749" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="5751" class="Symbol">(</a><a id="5752" href="StateMachine.Base.html#2384" class="Function">policyₛₘ</a> <a id="5761" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="5763" href="UTxO.TxUtilities.html#6316" class="Function">toPendingMPS</a> <a id="5776" href="StateMachine.Base.html#5701" class="Bound">l</a> <a id="5778" href="StateMachine.Base.html#5698" class="Bound">tx</a> <a id="5781" href="StateMachine.Base.html#2826" class="Function">ℂ</a><a id="5782" class="Symbol">)</a>
  <a id="5786" href="StateMachine.Base.html#5682" class="Function">◆∈⇒Tpolicy</a> <a id="5797" class="Symbol">{</a><a id="5798" href="StateMachine.Base.html#5798" class="Bound">tx</a><a id="5800" class="Symbol">}</a> <a id="5802" class="Symbol">{</a><a id="5803" href="StateMachine.Base.html#5803" class="Bound">l</a><a id="5804" class="Symbol">}</a> <a id="5806" href="StateMachine.Base.html#5806" class="Bound">vtx</a> <a id="5810" href="StateMachine.Base.html#5810" class="Bound">◆∈</a> <a id="5813" class="Symbol">=</a> <a id="5815" href="StateMachine.Base.html#5839" class="Function">policy≡</a>
    <a id="5827" class="Keyword">where</a>
      <a id="5839" href="StateMachine.Base.html#5839" class="Function">policy≡</a> <a id="5847" class="Symbol">:</a> <a id="5849" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="5851" class="Symbol">(</a><a id="5852" href="StateMachine.Base.html#2384" class="Function">policyₛₘ</a> <a id="5861" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="5863" href="UTxO.TxUtilities.html#6316" class="Function">toPendingMPS</a> <a id="5876" href="StateMachine.Base.html#5803" class="Bound">l</a> <a id="5878" href="StateMachine.Base.html#5798" class="Bound">tx</a> <a id="5881" href="StateMachine.Base.html#2826" class="Function">ℂ</a><a id="5882" class="Symbol">)</a>
      <a id="5890" href="StateMachine.Base.html#5839" class="Function">policy≡</a> <a id="5898" class="Symbol">=</a> <a id="5900" href="Data.List.Relation.Unary.All.html#5949" class="Function">L.All.lookup</a> <a id="5913" class="Symbol">(</a><a id="5914" href="UTxO.Validity.html#1724" class="Field">allPoliciesValidate</a> <a id="5934" href="StateMachine.Base.html#5806" class="Bound">vtx</a><a id="5937" class="Symbol">)</a> <a id="5939" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="5941" href="UTxO.Hashing.Base.html#1298" class="Function">∈♯</a> <a id="5944" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="5946" href="Data.List.Relation.Unary.All.html#5949" class="Function">L.All.lookup</a> <a id="5959" class="Symbol">(</a><a id="5960" href="UTxO.Validity.html#1984" class="Field">forging</a> <a id="5968" href="StateMachine.Base.html#5806" class="Bound">vtx</a><a id="5971" class="Symbol">)</a> <a id="5973" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="5975" href="UTxO.Value.html#6327" class="Function">◆-currencies∈</a> <a id="5989" href="StateMachine.Base.html#5810" class="Bound">◆∈</a>

  <a id="5995" class="Keyword">module</a> <a id="JustOrigin"></a><a id="6002" href="StateMachine.Base.html#6002" class="Module">JustOrigin</a> <a id="6013" class="Symbol">(</a><a id="6014" href="StateMachine.Base.html#6014" class="Bound">just-origin</a> <a id="6026" class="Symbol">:</a> <a id="6028" href="Data.Maybe.html#801" class="Function">Is-just</a> <a id="6036" href="StateMachine.Base.html#2173" class="Function">originₛₘ</a><a id="6044" class="Symbol">)</a> <a id="6046" class="Keyword">where</a>

    <a id="CEM.JustOrigin.𝕆"></a><a id="6057" href="StateMachine.Base.html#6057" class="Function">𝕆</a> <a id="6059" class="Symbol">:</a> <a id="6061" href="UTxO.Types.html#4026" class="Record">TxOutputRef</a>
    <a id="6077" href="StateMachine.Base.html#6057" class="Function">𝕆</a> <a id="6079" class="Symbol">=</a> <a id="6081" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="6087" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="6089" href="Prelude.General.html#3252" class="Function">destruct-Is-just</a> <a id="6106" href="StateMachine.Base.html#6014" class="Bound">just-origin</a>

    <a id="CEM.JustOrigin.o∈"></a><a id="6123" href="StateMachine.Base.html#6123" class="Function">o∈</a> <a id="6126" class="Symbol">:</a> <a id="6128" class="Symbol">∀</a> <a id="6130" class="Symbol">{</a><a id="6131" href="StateMachine.Base.html#6131" class="Bound">txi</a><a id="6134" class="Symbol">}</a> <a id="6136" class="Symbol">→</a> <a id="6138" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="6140" class="Symbol">(</a><a id="6141" href="StateMachine.Base.html#2237" class="Function">spentsOrigin</a> <a id="6154" href="StateMachine.Base.html#6131" class="Bound">txi</a><a id="6157" class="Symbol">)</a> <a id="6159" class="Symbol">→</a> <a id="6161" href="StateMachine.Base.html#6057" class="Function">𝕆</a> <a id="6163" href="Data.List.Membership.Setoid.html#882" class="Function Operator">∈</a> <a id="6165" href="Data.List.Base.html#1497" class="Function">map</a> <a id="6169" href="UTxO.Types.html#4493" class="Field">InputInfo.outputRef</a> <a id="6189" class="Symbol">(</a><a id="6190" href="UTxO.Types.html#4923" class="Field">TxInfo.inputInfo</a> <a id="6207" href="StateMachine.Base.html#6131" class="Bound">txi</a><a id="6210" class="Symbol">)</a>
    <a id="6216" href="StateMachine.Base.html#6123" class="Function">o∈</a> <a id="6219" href="StateMachine.Base.html#6219" class="Bound">p</a> <a id="6221" class="Keyword">with</a> <a id="6226" href="StateMachine.Base.html#2173" class="Function">originₛₘ</a>
    <a id="6239" class="Symbol">...</a> <a id="6243" class="Symbol">|</a> <a id="6245" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a> <a id="6253" class="Symbol">=</a> <a id="6255" href="Data.Empty.html#628" class="Function">⊥-elim</a> <a id="6262" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="6264" href="Prelude.General.html#3104" class="Function">Is-just⇒≢nothing</a> <a id="6281" href="StateMachine.Base.html#6014" class="Bound">just-origin</a> <a id="6293" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
    <a id="6302" class="Symbol">...</a> <a id="6306" class="Symbol">|</a> <a id="6308" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="6313" class="Symbol">_</a>  <a id="6316" class="Symbol">=</a> <a id="6318" href="Relation.Nullary.Decidable.Core.html#1484" class="Function">toWitness</a> <a id="6328" class="Bound">p</a>

    <a id="CEM.JustOrigin.frg◆≤1"></a><a id="6335" href="StateMachine.Base.html#6335" class="Function">frg◆≤1</a> <a id="6342" class="Symbol">:</a> <a id="6344" class="Symbol">∀</a> <a id="6346" class="Symbol">{</a><a id="6347" href="StateMachine.Base.html#6347" class="Bound">tx</a><a id="6349" class="Symbol">}</a> <a id="6351" class="Symbol">{</a><a id="6352" href="StateMachine.Base.html#6352" class="Bound">l</a><a id="6353" class="Symbol">}</a> <a id="6355" class="Symbol">→</a> <a id="6357" href="UTxO.Validity.html#1184" class="Record">IsValidTx</a> <a id="6367" href="StateMachine.Base.html#6347" class="Bound">tx</a> <a id="6370" href="StateMachine.Base.html#6352" class="Bound">l</a> <a id="6372" class="Symbol">→</a> <a id="6374" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="6380" href="StateMachine.Base.html#6347" class="Bound">tx</a> <a id="6383" href="UTxO.Value.html#5805" class="Function Operator">◆</a> <a id="6385" href="Data.Nat.Base.html#937" class="Datatype Operator">≤</a> <a id="6387" class="Number">1</a>
    <a id="6393" href="StateMachine.Base.html#6335" class="Function">frg◆≤1</a> <a id="6400" class="Symbol">{</a><a id="6401" href="StateMachine.Base.html#6401" class="Bound">tx</a><a id="6403" class="Symbol">}</a> <a id="6405" class="Symbol">{</a><a id="6406" href="StateMachine.Base.html#6406" class="Bound">l</a><a id="6407" class="Symbol">}</a> <a id="6409" href="StateMachine.Base.html#6409" class="Bound">vtx</a> <a id="6413" class="Symbol">=</a> <a id="6415" href="Prelude.General.html#1831" class="Postulate">¬&gt;⇒≤</a> <a id="6420" href="StateMachine.Base.html#6448" class="Function">¬frg◆&gt;1</a>
      <a id="6434" class="Keyword">where</a>
        <a id="6448" href="StateMachine.Base.html#6448" class="Function">¬frg◆&gt;1</a> <a id="6456" class="Symbol">:</a> <a id="6458" href="Relation.Nullary.html#653" class="Function Operator">¬</a> <a id="6460" class="Symbol">(</a><a id="6461" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="6467" href="StateMachine.Base.html#6401" class="Bound">tx</a> <a id="6470" href="UTxO.Value.html#5805" class="Function Operator">◆</a> <a id="6472" href="Data.Nat.Base.html#1111" class="Function Operator">&gt;</a> <a id="6474" class="Number">1</a><a id="6475" class="Symbol">)</a>
        <a id="6485" href="StateMachine.Base.html#6448" class="Function">¬frg◆&gt;1</a> <a id="6493" href="StateMachine.Base.html#6493" class="Bound">frg◆&gt;1</a> <a id="6500" class="Symbol">=</a> <a id="6502" href="Data.Nat.Properties.html#6653" class="Function">&lt;⇒≢</a> <a id="6506" href="StateMachine.Base.html#6493" class="Bound">frg◆&gt;1</a> <a id="6513" class="Symbol">(</a><a id="6514" href="Relation.Binary.PropositionalEquality.Core.html#980" class="Function">sym</a> <a id="6518" href="StateMachine.Base.html#6722" class="Function">frg≡1</a><a id="6523" class="Symbol">)</a>
          <a id="6535" class="Keyword">where</a>
            <a id="6553" href="StateMachine.Base.html#6553" class="Function">◆∈frg</a> <a id="6559" class="Symbol">:</a> <a id="6561" href="UTxO.Value.html#5879" class="Function Operator">◆∈</a> <a id="6564" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="6570" href="StateMachine.Base.html#6401" class="Bound">tx</a>
            <a id="6585" href="StateMachine.Base.html#6553" class="Function">◆∈frg</a> <a id="6591" class="Symbol">=</a> <a id="6593" href="Data.Nat.Properties.html#11809" class="Function">≤⇒pred≤</a> <a id="6601" href="StateMachine.Base.html#6493" class="Bound">frg◆&gt;1</a>

            <a id="6621" href="StateMachine.Base.html#6621" class="Function">Tpolicy</a> <a id="6629" class="Symbol">:</a> <a id="6631" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="6633" class="Symbol">(</a><a id="6634" href="StateMachine.Base.html#2384" class="Function">policyₛₘ</a> <a id="6643" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="6645" href="UTxO.TxUtilities.html#6316" class="Function">toPendingMPS</a> <a id="6658" href="StateMachine.Base.html#6406" class="Bound">l</a> <a id="6660" href="StateMachine.Base.html#6401" class="Bound">tx</a> <a id="6663" href="StateMachine.Base.html#2826" class="Function">ℂ</a><a id="6664" class="Symbol">)</a>
            <a id="6678" href="StateMachine.Base.html#6621" class="Function">Tpolicy</a> <a id="6686" class="Symbol">=</a> <a id="6688" href="StateMachine.Base.html#5682" class="Function">◆∈⇒Tpolicy</a> <a id="6699" href="StateMachine.Base.html#6409" class="Bound">vtx</a> <a id="6703" href="StateMachine.Base.html#6553" class="Function">◆∈frg</a>

            <a id="6722" href="StateMachine.Base.html#6722" class="Function">frg≡1</a> <a id="6728" class="Symbol">:</a> <a id="6730" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="6736" href="StateMachine.Base.html#6401" class="Bound">tx</a> <a id="6739" href="UTxO.Value.html#5805" class="Function Operator">◆</a> <a id="6741" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6743" class="Number">1</a>
            <a id="6757" href="StateMachine.Base.html#6722" class="Function">frg≡1</a> <a id="6763" class="Symbol">=</a> <a id="6765" href="Relation.Nullary.Decidable.Core.html#1484" class="Function">toWitness</a> <a id="6775" class="Symbol">{</a><a id="6776" class="Argument">Q</a> <a id="6778" class="Symbol">=</a> <a id="6780" href="UTxO.Value.html#1959" class="Function">lookupQuantity</a> <a id="6795" class="Symbol">(</a><a id="6796" href="StateMachine.Base.html#2826" class="Function">ℂ</a> <a id="6798" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6800" href="StateMachine.Base.html#2865" class="Function">𝕋</a><a id="6801" class="Symbol">)</a> <a id="6803" class="Symbol">(</a><a id="6804" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="6810" href="StateMachine.Base.html#6401" class="Bound">tx</a><a id="6812" class="Symbol">)</a> <a id="6814" href="Prelude.DecEq.html#590" class="Field Operator">≟</a> <a id="6816" class="Number">1</a><a id="6817" class="Symbol">}</a> <a id="6819" class="Symbol">(</a><a id="6820" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="6826" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="6828" href="Prelude.General.html#703" class="Function">T-∧</a> <a id="6832" href="StateMachine.Base.html#6621" class="Function">Tpolicy</a><a id="6839" class="Symbol">)</a>

    <a id="CEM.JustOrigin.∃forging"></a><a id="6846" href="StateMachine.Base.html#6846" class="Function">∃forging</a> <a id="6855" class="Symbol">:</a> <a id="6857" class="Symbol">∀</a> <a id="6859" class="Symbol">{</a><a id="6860" href="StateMachine.Base.html#6860" class="Bound">l</a><a id="6861" class="Symbol">}</a>
      <a id="6869" class="Symbol">→</a> <a id="6871" href="UTxO.Validity.html#2109" class="Datatype">ValidLedger</a> <a id="6883" href="StateMachine.Base.html#6860" class="Bound">l</a>
      <a id="6891" class="Symbol">→</a> <a id="6893" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="6895" href="StateMachine.Base.html#6860" class="Bound">l</a> <a id="6897" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="6903" href="UTxO.Value.html#5805" class="Function Operator">◆</a> <a id="6905" href="Data.Nat.Base.html#1111" class="Function Operator">&gt;</a> <a id="6907" class="Number">0</a>
      <a id="6915" class="Symbol">→</a> <a id="6917" href="Data.Product.html#1369" class="Function">∃</a> <a id="6919" class="Symbol">λ</a> <a id="6921" href="StateMachine.Base.html#6921" class="Bound">tx</a> <a id="6924" class="Symbol">→</a> <a id="6926" href="Data.Product.html#1369" class="Function">∃</a> <a id="6928" class="Symbol">λ</a> <a id="6930" href="StateMachine.Base.html#6930" class="Bound">l′</a> <a id="6933" class="Symbol">→</a>
          <a id="6945" href="UTxO.Validity.html#2109" class="Datatype">ValidLedger</a> <a id="6957" class="Symbol">(</a><a id="6958" href="StateMachine.Base.html#6921" class="Bound">tx</a> <a id="6961" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6963" href="StateMachine.Base.html#6930" class="Bound">l′</a><a id="6965" class="Symbol">)</a>
        <a id="6975" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6977" href="StateMachine.Base.html#6921" class="Bound">tx</a> <a id="6980" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6982" href="StateMachine.Base.html#6930" class="Bound">l′</a> <a id="6985" href="UTxO.Validity.html#4150" class="Function Operator">≼</a> <a id="6987" href="StateMachine.Base.html#6860" class="Bound">l</a>
        <a id="6997" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6999" class="Symbol">(</a><a id="7000" href="UTxO.Value.html#5879" class="Function Operator">◆∈</a> <a id="7003" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="7009" href="StateMachine.Base.html#6921" class="Bound">tx</a><a id="7011" class="Symbol">)</a>
    <a id="7017" href="StateMachine.Base.html#6846" class="Function">∃forging</a> <a id="7026" class="Symbol">{</a><a id="7027" href="StateMachine.Base.html#7027" class="Bound">tx</a> <a id="7030" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7032" href="StateMachine.Base.html#7032" class="Bound">l</a><a id="7033" class="Symbol">}</a> <a id="7035" href="StateMachine.Base.html#7035" class="Bound">vl₀</a><a id="7038" class="Symbol">@(</a><a id="7040" href="StateMachine.Base.html#7040" class="Bound">vl</a> <a id="7043" href="UTxO.Validity.html#2167" class="InductiveConstructor Operator">⊕</a> <a id="7045" class="DottedPattern Symbol">.</a><a id="7046" href="StateMachine.Base.html#7027" class="DottedPattern Bound">tx</a> <a id="7049" href="UTxO.Validity.html#2167" class="InductiveConstructor Operator">∶-</a> <a id="7052" href="StateMachine.Base.html#7052" class="Bound">vtx</a><a id="7055" class="Symbol">)</a> <a id="7057" href="StateMachine.Base.html#7057" class="Bound">∑&gt;0</a>
      <a id="7067" class="Keyword">rewrite</a> <a id="7075" href="UTxO.Value.html#5986" class="Function">+ᶜ-◆</a> <a id="7080" class="Symbol">{</a><a id="7081" class="Argument">x</a> <a id="7083" class="Symbol">=</a> <a id="7085" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="7091" href="StateMachine.Base.html#7027" class="Bound">tx</a><a id="7093" class="Symbol">}</a> <a id="7095" class="Symbol">{</a><a id="7096" class="Argument">y</a> <a id="7098" class="Symbol">=</a> <a id="7100" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="7102" href="StateMachine.Base.html#7032" class="Bound">l</a> <a id="7104" href="UTxO.Types.html#7555" class="Field">forge</a><a id="7109" class="Symbol">}</a>
      <a id="7117" class="Keyword">with</a> <a id="7122" href="UTxO.Value.html#5895" class="Function Operator">◆∈?</a> <a id="7126" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="7132" href="StateMachine.Base.html#7027" class="Bound">tx</a>
    <a id="7139" class="Symbol">...</a> <a id="7143" class="Symbol">|</a> <a id="7145" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a>  <a id="7149" href="StateMachine.Base.html#7149" class="Bound">◆∉</a> <a id="7152" class="Keyword">rewrite</a> <a id="7160" href="Prelude.General.html#1553" class="Postulate">¬x&gt;0⇒x≡0</a> <a id="7169" href="StateMachine.Base.html#7149" class="Bound">◆∉</a> <a id="7172" class="Symbol">|</a> <a id="7174" href="Data.Nat.Properties.html#12591" class="Function">+-identityˡ</a> <a id="7186" class="Symbol">(</a><a id="7187" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="7189" class="Bound">l</a> <a id="7191" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="7197" href="UTxO.Value.html#5805" class="Function Operator">◆</a><a id="7198" class="Symbol">)</a>
                 <a id="7217" class="Keyword">with</a> <a id="7222" href="StateMachine.Base.html#7222" class="Bound">tx</a> <a id="7225" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7227" href="StateMachine.Base.html#7227" class="Bound">l′</a> <a id="7230" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7232" href="StateMachine.Base.html#7232" class="Bound">vl′</a> <a id="7236" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7238" href="StateMachine.Base.html#7238" class="Bound">l′≺</a> <a id="7242" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7244" href="StateMachine.Base.html#7244" class="Bound">◆∈</a> ← <a id="7249" href="StateMachine.Base.html#6846" class="Function">∃forging</a> <a id="7258" class="Bound">vl</a> <a id="7261" class="Bound">∑&gt;0</a>
                    <a id="7285" class="Symbol">=</a> <a id="7287" href="StateMachine.Base.html#7222" class="Bound">tx</a> <a id="7290" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7292" href="StateMachine.Base.html#7227" class="Bound">l′</a> <a id="7295" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7297" href="StateMachine.Base.html#7232" class="Bound">vl′</a> <a id="7301" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7303" href="Data.List.Relation.Binary.Suffix.Heterogeneous.html#733" class="InductiveConstructor">there</a> <a id="7309" href="StateMachine.Base.html#7238" class="Bound">l′≺</a> <a id="7313" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7315" href="StateMachine.Base.html#7244" class="Bound">◆∈</a>
    <a id="7322" class="Symbol">...</a> <a id="7326" class="Symbol">|</a> <a id="7328" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="7332" href="StateMachine.Base.html#7332" class="Bound">◆∈</a> <a id="7335" class="Symbol">=</a> <a id="7337" class="Bound">tx</a> <a id="7340" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7342" class="Bound">l</a> <a id="7344" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7346" class="Bound">vl₀</a> <a id="7350" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7352" href="Data.List.Relation.Binary.Suffix.Heterogeneous.html#676" class="InductiveConstructor">here</a> <a id="7357" class="Symbol">(</a><a id="7358" href="Data.List.Relation.Binary.Pointwise.html#12819" class="Function">≡⇒Pointwise-≡</a> <a id="7372" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="7376" class="Symbol">)</a> <a id="7378" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7380" href="StateMachine.Base.html#7332" class="Bound">◆∈</a>

    <a id="CEM.JustOrigin.∃forging²"></a><a id="7388" href="StateMachine.Base.html#7388" class="Function">∃forging²</a> <a id="7398" class="Symbol">:</a> <a id="7400" class="Symbol">∀</a> <a id="7402" class="Symbol">{</a><a id="7403" href="StateMachine.Base.html#7403" class="Bound">l</a><a id="7404" class="Symbol">}</a>
      <a id="7412" class="Symbol">→</a> <a id="7414" href="UTxO.Validity.html#2109" class="Datatype">ValidLedger</a> <a id="7426" href="StateMachine.Base.html#7403" class="Bound">l</a>
      <a id="7434" class="Symbol">→</a> <a id="7436" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="7438" href="StateMachine.Base.html#7403" class="Bound">l</a> <a id="7440" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="7446" href="UTxO.Value.html#5805" class="Function Operator">◆</a> <a id="7448" href="Data.Nat.Base.html#1111" class="Function Operator">&gt;</a> <a id="7450" class="Number">1</a>
      <a id="7458" class="Symbol">→</a> <a id="7460" href="Data.Product.html#1369" class="Function">∃</a> <a id="7462" class="Symbol">λ</a> <a id="7464" href="StateMachine.Base.html#7464" class="Bound">tx₁</a> <a id="7468" class="Symbol">→</a> <a id="7470" href="Data.Product.html#1369" class="Function">∃</a> <a id="7472" class="Symbol">λ</a> <a id="7474" href="StateMachine.Base.html#7474" class="Bound">l₁</a> <a id="7477" class="Symbol">→</a> <a id="7479" href="Data.Product.html#1369" class="Function">∃</a> <a id="7481" class="Symbol">λ</a> <a id="7483" href="StateMachine.Base.html#7483" class="Bound">tx₂</a> <a id="7487" class="Symbol">→</a> <a id="7489" href="Data.Product.html#1369" class="Function">∃</a> <a id="7491" class="Symbol">λ</a> <a id="7493" href="StateMachine.Base.html#7493" class="Bound">l₂</a>
          <a id="7506" class="Symbol">→</a> <a id="7508" href="UTxO.Validity.html#2109" class="Datatype">ValidLedger</a> <a id="7520" class="Symbol">(</a><a id="7521" href="StateMachine.Base.html#7464" class="Bound">tx₁</a> <a id="7525" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7527" href="StateMachine.Base.html#7474" class="Bound">l₁</a><a id="7529" class="Symbol">)</a>
          <a id="7541" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="7543" href="UTxO.Validity.html#2109" class="Datatype">ValidLedger</a> <a id="7555" class="Symbol">(</a><a id="7556" href="StateMachine.Base.html#7483" class="Bound">tx₂</a> <a id="7560" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7562" href="StateMachine.Base.html#7493" class="Bound">l₂</a><a id="7564" class="Symbol">)</a>
          <a id="7576" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="7578" href="StateMachine.Base.html#7464" class="Bound">tx₁</a> <a id="7582" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7584" href="StateMachine.Base.html#7474" class="Bound">l₁</a> <a id="7587" href="UTxO.Validity.html#4150" class="Function Operator">≼</a> <a id="7589" href="StateMachine.Base.html#7493" class="Bound">l₂</a>
          <a id="7602" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="7604" class="Symbol">(</a><a id="7605" href="UTxO.Value.html#5879" class="Function Operator">◆∈</a> <a id="7608" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="7614" href="StateMachine.Base.html#7464" class="Bound">tx₁</a><a id="7617" class="Symbol">)</a>
          <a id="7629" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="7631" class="Symbol">(</a><a id="7632" href="UTxO.Value.html#5879" class="Function Operator">◆∈</a> <a id="7635" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="7641" href="StateMachine.Base.html#7483" class="Bound">tx₂</a><a id="7644" class="Symbol">)</a>
    <a id="7650" href="StateMachine.Base.html#7388" class="Function">∃forging²</a> <a id="7660" class="Symbol">{</a><a id="7661" href="StateMachine.Base.html#7661" class="Bound">tx</a> <a id="7664" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7666" href="StateMachine.Base.html#7666" class="Bound">l</a><a id="7667" class="Symbol">}</a> <a id="7669" href="StateMachine.Base.html#7669" class="Bound">vl₀</a><a id="7672" class="Symbol">@(</a><a id="7674" href="StateMachine.Base.html#7674" class="Bound">vl</a> <a id="7677" href="UTxO.Validity.html#2167" class="InductiveConstructor Operator">⊕</a> <a id="7679" class="DottedPattern Symbol">.</a><a id="7680" href="StateMachine.Base.html#7661" class="DottedPattern Bound">tx</a> <a id="7683" href="UTxO.Validity.html#2167" class="InductiveConstructor Operator">∶-</a> <a id="7686" href="StateMachine.Base.html#7686" class="Bound">vtx</a><a id="7689" class="Symbol">)</a> <a id="7691" href="StateMachine.Base.html#7691" class="Bound">∑&gt;1</a>
      <a id="7701" class="Keyword">rewrite</a> <a id="7709" href="UTxO.Value.html#5986" class="Function">+ᶜ-◆</a> <a id="7714" class="Symbol">{</a><a id="7715" class="Argument">x</a> <a id="7717" class="Symbol">=</a> <a id="7719" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="7725" href="StateMachine.Base.html#7661" class="Bound">tx</a><a id="7727" class="Symbol">}</a> <a id="7729" class="Symbol">{</a><a id="7730" class="Argument">y</a> <a id="7732" class="Symbol">=</a> <a id="7734" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="7736" href="StateMachine.Base.html#7666" class="Bound">l</a> <a id="7738" href="UTxO.Types.html#7555" class="Field">forge</a><a id="7743" class="Symbol">}</a>
      <a id="7751" class="Keyword">with</a> <a id="7756" href="UTxO.Value.html#5895" class="Function Operator">◆∈?</a> <a id="7760" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="7766" href="StateMachine.Base.html#7661" class="Bound">tx</a>
    <a id="7773" class="Symbol">...</a> <a id="7777" class="Symbol">|</a> <a id="7779" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a>  <a id="7783" href="StateMachine.Base.html#7783" class="Bound">◆∉</a>
      <a id="7792" class="Keyword">rewrite</a> <a id="7800" href="Prelude.General.html#1553" class="Postulate">¬x&gt;0⇒x≡0</a> <a id="7809" href="StateMachine.Base.html#7783" class="Bound">◆∉</a> <a id="7812" class="Symbol">|</a> <a id="7814" href="Data.Nat.Properties.html#12591" class="Function">+-identityˡ</a> <a id="7826" class="Symbol">(</a><a id="7827" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="7829" class="Bound">l</a> <a id="7831" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="7837" href="UTxO.Value.html#5805" class="Function Operator">◆</a><a id="7838" class="Symbol">)</a> <a id="7840" class="Symbol">=</a> <a id="7842" href="StateMachine.Base.html#7388" class="Function">∃forging²</a> <a id="7852" class="Bound">vl</a> <a id="7855" class="Bound">∑&gt;1</a>
    <a id="7863" class="Symbol">...</a> <a id="7867" class="Symbol">|</a> <a id="7869" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="7873" href="StateMachine.Base.html#7873" class="Bound">◆∈</a>
      <a id="7882" class="Keyword">rewrite</a> <a id="7890" href="Prelude.General.html#1665" class="Postulate">x&gt;0,x≤1⇒x≡1</a> <a id="7902" href="StateMachine.Base.html#7873" class="Bound">◆∈</a> <a id="7905" class="Symbol">(</a><a id="7906" href="StateMachine.Base.html#6335" class="Function">frg◆≤1</a> <a id="7913" class="Bound">vtx</a><a id="7916" class="Symbol">)</a>
      <a id="7924" class="Keyword">with</a> <a id="7929" href="StateMachine.Base.html#7929" class="Bound">∑&gt;0</a> ← <a id="7935" href="Prelude.General.html#1868" class="Postulate">x+y&gt;x⇒y&gt;0</a> <a id="7945" class="Symbol">{</a><a id="7946" class="Argument">x</a> <a id="7948" class="Symbol">=</a> <a id="7950" class="Number">1</a><a id="7951" class="Symbol">}</a> <a id="7953" class="Symbol">{</a><a id="7954" class="Argument">y</a> <a id="7956" class="Symbol">=</a> <a id="7958" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="7960" class="Bound">l</a> <a id="7962" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="7968" href="UTxO.Value.html#5805" class="Function Operator">◆</a><a id="7969" class="Symbol">}</a> <a id="7971" class="Bound">∑&gt;1</a>
      <a id="7981" class="Keyword">with</a> <a id="7986" href="StateMachine.Base.html#7986" class="Bound">tx′</a> <a id="7990" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7992" href="StateMachine.Base.html#7992" class="Bound">l′</a> <a id="7995" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7997" href="StateMachine.Base.html#7997" class="Bound">vl′</a> <a id="8001" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8003" href="StateMachine.Base.html#8003" class="Bound">l′≺l</a> <a id="8008" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8010" href="StateMachine.Base.html#8010" class="Bound">◆∈′</a> ← <a id="8016" href="StateMachine.Base.html#6846" class="Function">∃forging</a> <a id="8025" class="Bound">vl</a> <a id="8028" href="StateMachine.Base.html#7929" class="Bound">∑&gt;0</a>
         <a id="8041" class="Symbol">=</a> <a id="8043" href="StateMachine.Base.html#7986" class="Bound">tx′</a> <a id="8047" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8049" href="StateMachine.Base.html#7992" class="Bound">l′</a> <a id="8052" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8054" class="Bound">tx</a> <a id="8057" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8059" class="Bound">l</a> <a id="8061" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8063" href="StateMachine.Base.html#7997" class="Bound">vl′</a> <a id="8067" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8069" class="Bound">vl₀</a> <a id="8073" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8075" href="StateMachine.Base.html#8003" class="Bound">l′≺l</a> <a id="8080" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8082" href="StateMachine.Base.html#8010" class="Bound">◆∈′</a> <a id="8086" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8088" href="StateMachine.Base.html#7873" class="Bound">◆∈</a>

    <a id="CEM.JustOrigin.◆∈⇒𝕆∈"></a><a id="8096" href="StateMachine.Base.html#8096" class="Function">◆∈⇒𝕆∈</a> <a id="8102" class="Symbol">:</a> <a id="8104" class="Symbol">∀</a> <a id="8106" class="Symbol">{</a><a id="8107" href="StateMachine.Base.html#8107" class="Bound">tx</a> <a id="8110" href="StateMachine.Base.html#8110" class="Bound">l</a><a id="8111" class="Symbol">}</a>
      <a id="8119" class="Symbol">→</a> <a id="8121" href="UTxO.Validity.html#1184" class="Record">IsValidTx</a> <a id="8131" href="StateMachine.Base.html#8107" class="Bound">tx</a> <a id="8134" href="StateMachine.Base.html#8110" class="Bound">l</a>
      <a id="8142" class="Symbol">→</a> <a id="8144" href="UTxO.Value.html#5879" class="Function Operator">◆∈</a> <a id="8147" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="8153" href="StateMachine.Base.html#8107" class="Bound">tx</a>
      <a id="8162" class="Symbol">→</a> <a id="8164" href="StateMachine.Base.html#6057" class="Function">𝕆</a> <a id="8166" href="Data.List.Membership.Setoid.html#882" class="Function Operator">∈</a> <a id="8168" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="8179" href="StateMachine.Base.html#8107" class="Bound">tx</a>
    <a id="8186" href="StateMachine.Base.html#8096" class="Function">◆∈⇒𝕆∈</a> <a id="8192" class="Symbol">{</a><a id="8193" href="StateMachine.Base.html#8193" class="Bound">tx</a><a id="8195" class="Symbol">}</a> <a id="8197" class="Symbol">{</a><a id="8198" href="StateMachine.Base.html#8198" class="Bound">l</a><a id="8199" class="Symbol">}</a> <a id="8201" href="StateMachine.Base.html#8201" class="Bound">vtx</a> <a id="8205" href="StateMachine.Base.html#8205" class="Bound">◆∈frg</a> <a id="8211" class="Symbol">=</a> <a id="8213" href="UTxO.TxUtilities.html#6780" class="Function">outRef∈txi</a> <a id="8224" class="Symbol">{</a><a id="8225" href="StateMachine.Base.html#8193" class="Bound">tx</a><a id="8227" class="Symbol">}{</a><a id="8229" href="StateMachine.Base.html#8198" class="Bound">l</a><a id="8230" class="Symbol">}{</a><a id="8232" href="StateMachine.Base.html#6057" class="Function">𝕆</a><a id="8233" class="Symbol">}</a> <a id="8235" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="8237" href="StateMachine.Base.html#6123" class="Function">o∈</a> <a id="8240" class="Symbol">{</a><a id="8241" href="StateMachine.Base.html#8274" class="Function">txi</a><a id="8244" class="Symbol">}</a> <a id="8246" href="StateMachine.Base.html#8396" class="Function">Tspents</a>
      <a id="8260" class="Keyword">where</a>
        <a id="8274" href="StateMachine.Base.html#8274" class="Function">txi</a> <a id="8278" class="Symbol">=</a> <a id="8280" href="UTxO.TxUtilities.html#5851" class="Function">mkTxInfo</a> <a id="8289" href="StateMachine.Base.html#8198" class="Bound">l</a> <a id="8291" href="StateMachine.Base.html#8193" class="Bound">tx</a>

        <a id="8303" href="StateMachine.Base.html#8303" class="Function">Tpolicy</a> <a id="8311" class="Symbol">:</a> <a id="8313" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="8315" class="Symbol">(</a><a id="8316" href="StateMachine.Base.html#2384" class="Function">policyₛₘ</a> <a id="8325" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="8327" href="UTxO.TxUtilities.html#6316" class="Function">toPendingMPS</a> <a id="8340" href="StateMachine.Base.html#8198" class="Bound">l</a> <a id="8342" href="StateMachine.Base.html#8193" class="Bound">tx</a> <a id="8345" href="StateMachine.Base.html#2826" class="Function">ℂ</a><a id="8346" class="Symbol">)</a>
        <a id="8356" href="StateMachine.Base.html#8303" class="Function">Tpolicy</a> <a id="8364" class="Symbol">=</a> <a id="8366" href="StateMachine.Base.html#5682" class="Function">◆∈⇒Tpolicy</a> <a id="8377" href="StateMachine.Base.html#8201" class="Bound">vtx</a> <a id="8381" href="StateMachine.Base.html#8205" class="Bound">◆∈frg</a>

        <a id="8396" href="StateMachine.Base.html#8396" class="Function">Tspents</a> <a id="8404" class="Symbol">:</a> <a id="8406" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="8408" class="Symbol">(</a><a id="8409" href="StateMachine.Base.html#2237" class="Function">spentsOrigin</a> <a id="8422" href="StateMachine.Base.html#8274" class="Function">txi</a><a id="8425" class="Symbol">)</a>
        <a id="8435" href="StateMachine.Base.html#8396" class="Function">Tspents</a> <a id="8443" class="Symbol">=</a> <a id="8445" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="8451" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="8453" href="Prelude.General.html#703" class="Function">T-∧</a> <a id="8457" class="Symbol">{</a><a id="8458" class="Argument">l</a> <a id="8460" class="Symbol">=</a> <a id="8462" href="StateMachine.Base.html#2237" class="Function">spentsOrigin</a> <a id="8475" href="StateMachine.Base.html#8274" class="Function">txi</a><a id="8478" class="Symbol">}</a> <a id="8480" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="8482" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="8488" href="Function.Base.html#1538" class="Function Operator">$</a> <a id="8490" href="Prelude.General.html#703" class="Function">T-∧</a> <a id="8494" class="Symbol">{</a><a id="8495" class="Argument">l</a> <a id="8497" class="Symbol">=</a> <a id="8499" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="8501" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="8507" href="StateMachine.Base.html#8193" class="Bound">tx</a> <a id="8510" href="UTxO.Value.html#5805" class="Function Operator">◆</a> <a id="8512" href="Prelude.DecEq.html#590" class="Field Operator">≟</a> <a id="8514" class="Number">1</a> <a id="8516" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a><a id="8517" class="Symbol">}</a> <a id="8519" href="StateMachine.Base.html#8303" class="Function">Tpolicy</a>

    <a id="CEM.JustOrigin.nf"></a><a id="8532" href="StateMachine.Base.html#8532" class="Function">nf</a> <a id="8535" class="Symbol">:</a> <a id="8537" class="Symbol">∀</a> <a id="8539" href="StateMachine.Base.html#8539" class="Bound">L</a> <a id="8541" class="Symbol">→</a> <a id="8543" href="UTxO.Validity.html#10400" class="Function">NonFungible</a> <a id="8555" href="StateMachine.Base.html#8539" class="Bound">L</a> <a id="8557" href="StateMachine.Base.html#2917" class="Function">nftₛₘ</a>
    <a id="8567" href="StateMachine.Base.html#8532" class="Function">nf</a> <a id="8570" href="StateMachine.Base.html#8570" class="Bound">L</a><a id="8571" class="Symbol">@(</a><a id="8573" href="StateMachine.Base.html#8573" class="Bound">l</a> <a id="8575" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8577" href="StateMachine.Base.html#8577" class="Bound">vl</a><a id="8579" class="Symbol">)</a> <a id="8581" class="Symbol">=</a> <a id="8583" href="Prelude.General.html#1831" class="Postulate">¬&gt;⇒≤</a> <a id="8588" href="StateMachine.Base.html#8612" class="Function">nf′</a>
      <a id="8598" class="Keyword">where</a>
        <a id="8612" href="StateMachine.Base.html#8612" class="Function">nf′</a> <a id="8616" class="Symbol">:</a> <a id="8618" href="Relation.Nullary.html#653" class="Function Operator">¬</a> <a id="8620" class="Symbol">(</a><a id="8621" href="UTxO.Value.html#2415" class="Function">∑</a> <a id="8623" href="StateMachine.Base.html#8573" class="Bound">l</a> <a id="8625" href="UTxO.Types.html#7555" class="Field">forge</a> <a id="8631" href="UTxO.Value.html#5805" class="Function Operator">◆</a> <a id="8633" href="Data.Nat.Base.html#1111" class="Function Operator">&gt;</a> <a id="8635" class="Number">1</a><a id="8636" class="Symbol">)</a>
        <a id="8646" href="StateMachine.Base.html#8612" class="Function">nf′</a> <a id="8650" href="StateMachine.Base.html#8650" class="Bound">∑&gt;1</a>
          <a id="8664" class="Keyword">with</a> <a id="8669" href="StateMachine.Base.html#8669" class="Bound">tx₁</a> <a id="8673" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8675" href="StateMachine.Base.html#8675" class="Bound">l₁</a> <a id="8678" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8680" href="StateMachine.Base.html#8680" class="Bound">tx₂</a> <a id="8684" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8686" href="StateMachine.Base.html#8686" class="Bound">l₂</a>
             <a id="8702" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8704" href="StateMachine.Base.html#8704" class="Bound">vl₁</a> <a id="8708" href="UTxO.Validity.html#2167" class="InductiveConstructor Operator">⊕</a> <a id="8710" class="DottedPattern Symbol">.</a><a id="8711" href="StateMachine.Base.html#8669" class="DottedPattern Bound">tx₁</a> <a id="8715" href="UTxO.Validity.html#2167" class="InductiveConstructor Operator">∶-</a> <a id="8718" href="StateMachine.Base.html#8718" class="Bound">vtx₁</a> <a id="8723" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8725" href="StateMachine.Base.html#8725" class="Bound">vl₂</a> <a id="8729" href="UTxO.Validity.html#2167" class="InductiveConstructor Operator">⊕</a> <a id="8731" class="DottedPattern Symbol">.</a><a id="8732" href="StateMachine.Base.html#8680" class="DottedPattern Bound">tx₂</a> <a id="8736" href="UTxO.Validity.html#2167" class="InductiveConstructor Operator">∶-</a> <a id="8739" href="StateMachine.Base.html#8739" class="Bound">vtx₂</a>
             <a id="8757" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8759" href="StateMachine.Base.html#8759" class="Bound">l₁≺l₂</a> <a id="8765" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8767" href="StateMachine.Base.html#8767" class="Bound">◆∈₁</a> <a id="8771" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8773" href="StateMachine.Base.html#8773" class="Bound">◆∈₂</a>
             ← <a id="8792" href="StateMachine.Base.html#7388" class="Function">∃forging²</a> <a id="8802" href="StateMachine.Base.html#8577" class="Bound">vl</a> <a id="8805" href="StateMachine.Base.html#8650" class="Bound">∑&gt;1</a>
          <a id="8819" class="Symbol">=</a> <a id="8821" href="StateMachine.Base.html#9020" class="Function">o∉utxo₂</a> <a id="8829" href="StateMachine.Base.html#9184" class="Function">o∈utxo₂</a>
         <a id="8846" class="Keyword">where</a>
          <a id="8862" href="StateMachine.Base.html#8862" class="Function">o∈₁</a> <a id="8866" class="Symbol">:</a> <a id="8868" href="StateMachine.Base.html#6057" class="Function">𝕆</a> <a id="8870" href="Data.List.Membership.Setoid.html#882" class="Function Operator">∈</a> <a id="8872" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="8883" href="StateMachine.Base.html#8669" class="Bound">tx₁</a>
          <a id="8897" href="StateMachine.Base.html#8862" class="Function">o∈₁</a> <a id="8901" class="Symbol">=</a> <a id="8903" href="StateMachine.Base.html#8096" class="Function">◆∈⇒𝕆∈</a> <a id="8909" href="StateMachine.Base.html#8718" class="Bound">vtx₁</a> <a id="8914" href="StateMachine.Base.html#8767" class="Bound">◆∈₁</a>

          <a id="8929" href="StateMachine.Base.html#8929" class="Function">o∈utxo₁</a> <a id="8937" class="Symbol">:</a> <a id="8939" href="StateMachine.Base.html#6057" class="Function">𝕆</a> <a id="8941" href="Data.List.Membership.Setoid.html#882" class="Function Operator">∈</a> <a id="8943" href="Data.List.Base.html#1497" class="Function">map</a> <a id="8947" href="UTxO.TxUtilities.html#471" class="Field">outRef</a> <a id="8954" class="Symbol">(</a><a id="8955" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="8960" href="StateMachine.Base.html#8675" class="Bound">l₁</a><a id="8962" class="Symbol">)</a>
          <a id="8974" href="StateMachine.Base.html#8929" class="Function">o∈utxo₁</a> <a id="8982" class="Symbol">=</a> <a id="8984" href="UTxO.Validity.html#1320" class="Field">validOutputRefs</a> <a id="9000" href="StateMachine.Base.html#8718" class="Bound">vtx₁</a> <a id="9005" href="StateMachine.Base.html#8862" class="Function">o∈₁</a>

          <a id="9020" href="StateMachine.Base.html#9020" class="Function">o∉utxo₂</a> <a id="9028" class="Symbol">:</a> <a id="9030" href="StateMachine.Base.html#6057" class="Function">𝕆</a> <a id="9032" href="Data.List.Membership.Setoid.html#931" class="Function Operator">∉</a> <a id="9034" href="Data.List.Base.html#1497" class="Function">map</a> <a id="9038" href="UTxO.TxUtilities.html#471" class="Field">outRef</a> <a id="9045" class="Symbol">(</a><a id="9046" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="9051" href="StateMachine.Base.html#8686" class="Bound">l₂</a><a id="9053" class="Symbol">)</a>
          <a id="9065" href="StateMachine.Base.html#9020" class="Function">o∉utxo₂</a> <a id="9073" class="Symbol">=</a> <a id="9075" href="UTxO.Validity.html#5584" class="Postulate">suf-utxo</a> <a id="9084" href="StateMachine.Base.html#8725" class="Bound">vl₂</a> <a id="9088" href="StateMachine.Base.html#8759" class="Bound">l₁≺l₂</a> <a id="9094" href="StateMachine.Base.html#8929" class="Function">o∈utxo₁</a> <a id="9102" href="StateMachine.Base.html#8862" class="Function">o∈₁</a>

          <a id="9117" href="StateMachine.Base.html#9117" class="Function">o∈₂</a> <a id="9121" class="Symbol">:</a> <a id="9123" href="StateMachine.Base.html#6057" class="Function">𝕆</a> <a id="9125" href="Data.List.Membership.Setoid.html#882" class="Function Operator">∈</a> <a id="9127" href="UTxO.Types.html#7844" class="Function">outputRefs</a> <a id="9138" href="StateMachine.Base.html#8680" class="Bound">tx₂</a>
          <a id="9152" href="StateMachine.Base.html#9117" class="Function">o∈₂</a> <a id="9156" class="Symbol">=</a> <a id="9158" href="StateMachine.Base.html#8096" class="Function">◆∈⇒𝕆∈</a> <a id="9164" href="StateMachine.Base.html#8739" class="Bound">vtx₂</a> <a id="9169" href="StateMachine.Base.html#8773" class="Bound">◆∈₂</a>

          <a id="9184" href="StateMachine.Base.html#9184" class="Function">o∈utxo₂</a> <a id="9192" class="Symbol">:</a> <a id="9194" href="StateMachine.Base.html#6057" class="Function">𝕆</a> <a id="9196" href="Data.List.Membership.Setoid.html#882" class="Function Operator">∈</a> <a id="9198" href="Data.List.Base.html#1497" class="Function">map</a> <a id="9202" href="UTxO.TxUtilities.html#471" class="Field">outRef</a> <a id="9209" class="Symbol">(</a><a id="9210" href="UTxO.TxUtilities.html#736" class="Function">utxo</a> <a id="9215" href="StateMachine.Base.html#8686" class="Bound">l₂</a><a id="9217" class="Symbol">)</a>
          <a id="9229" href="StateMachine.Base.html#9184" class="Function">o∈utxo₂</a> <a id="9237" class="Symbol">=</a> <a id="9239" href="UTxO.Validity.html#1320" class="Field">validOutputRefs</a> <a id="9255" href="StateMachine.Base.html#8739" class="Bound">vtx₂</a> <a id="9260" href="StateMachine.Base.html#9117" class="Function">o∈₂</a>
</pre></body></html>